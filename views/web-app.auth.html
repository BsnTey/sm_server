<!DOCTYPE html>
<html>
<head>
    <title>Telegram Web App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
<button id="authButton">Авторизоваться</button>

<script>
    const authButton = document.getElementById('authButton');
    const tg = window.Telegram.WebApp;

    authButton.addEventListener('click', () => {
        const data = {
            telegramId: tg.initDataUnsafe.user.id,
        };

        fetch('/api/webapp/auth', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then((response) => response.json())
            .then((result) => {
                if (result.success) {
                    tg.close();
                } else {
                    alert('Ошибка авторизации: ' + result.message);
                }
            });
    });
</script>
</body>
</html>
