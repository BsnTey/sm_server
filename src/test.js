import {
    $ as V,
    _ as M,
    A as c,
    a_ as A,
    aF as p,
    aJ as m,
    aL as _,
    aN as h,
    aP as y,
    aQ as v,
    aR as E,
    at as P,
    aU as g,
    au as N,
    aw as e,
    b1 as L,
    bl as C,
    bm as w,
    c as k,
    e as t,
    E as n,
    f as s,
    F as S,
    g as o,
    G as l,
    h as D,
    I as r,
    i as T,
    j as d,
    k as I,
    l as b,
    m as R,
    O as u,
    p as f,
    q as O,
    v as i,
    x as a,
} from './vendor-C0woMcsU.js';
import {
    $ as Ne,
    _ as B,
    a4 as De,
    a_ as H,
    aB as fe,
    aC as te,
    ad as Y,
    ae as st,
    af as tt,
    ah as oe,
    ai as he,
    ak as at,
    al as ot,
    am as ke,
    an as et,
    ao as G,
    aq as q,
    at as rt,
    aT as ut,
    aw as Ue,
    az as pe,
    b as Ke,
    b0 as Pe,
    b_ as be,
    bC as x,
    bf as nt,
    bn as Ve,
    bp as xe,
    bY as W,
    bZ as Ge,
    bz as dt,
    C as ye,
    c7 as re,
    cw as Oe,
    d as $e,
    dK as Qe,
    dM as ze,
    dQ as z,
    dX as ae,
    E as me,
    e$ as Re,
    e9 as X,
    e_ as Ae,
    eP as Q,
    eQ as ee,
    eR as se,
    eS as ie,
    eT as de,
    eU as _e,
    eV as Ce,
    eW as ve,
    eX as Ee,
    eY as Ie,
    eZ as ge,
    f as Z,
    f0 as Le,
    f1 as we,
    f2 as Me,
    f3 as Be,
    f4 as Fe,
    f5 as He,
    f6 as je,
    f7 as qe,
    f8 as We,
    f9 as Xe,
    fa as it,
    fb as lt,
    fc as mt,
    fd as pt,
    G as $,
    g as U,
    j as Se,
    M as ne,
    m as le,
    o as ue,
    q as F,
    R as K,
    r as ce,
    s as ct,
    U as j,
    v as J,
    W as Ze,
    X as Je,
    y as Te,
    z as Ye,
} from './index-DJY3c9Ok.js';
import { S as ht } from './SmLayoutLoader-CCQ9aoqd.js';
import { p as _t, S as St } from './SmProductItemsGroup-Cx9DnXj2.js';
import { P as Ct, u as yt } from './composable-B-Bn02SG.js';
import { S as Tt } from './SmCartItemRemove-CumOpvXF.js';
import { e as vt } from './SmProductRecommendations-0-yyWgwO.js';
import { w as Et } from './ic-warning-small-lK9ext7O.js';
import { S as It } from './SmPositionDescription-e1wFU6Jx.js';
import { S as gt } from './SmPositionPrice-BrooZgYB.js';
import { S as At } from './SmPositionQuantity-CCjxOInW.js';
import { b as ft } from './constants-BM3EEyuN.js';
import { S as kt } from './SmProductRecommendationsGroup-BII0aWAv.js';
import { e as bt } from './ic-empty-basket-Clm2Xqg_.js';
import {
    a as Ot,
    b as Rt,
    c as Dt,
    d as Nt,
    f as Pt,
    j as Mt,
    k as Lt,
    s as wt,
} from './ic-payment-sberpay-Dlcu7p6B.js';
import { S as Vt } from './SmTimer-BAVx2uS4.js';
import { S as Bt } from './SmOrderPaymentTools-DYBojpcC.js';
import { a as xt } from './constants-BdVlfREi.js';
import { a as Gt, g as $t } from './index-BO7zItT-.js';
import { a as Yt, b as Ft, S as Ut } from './constants-92mBrMgX.js';
import { O as Ht } from './constants-rli9bi5V.js';
import { _ as jt, d as Wt, p as zt, u as qt } from './ic-pickup-xIV-5bKF.js';
import { S as Qt } from './SmShipmentVariantInfo-CHTx-MQ2.js';
import { s as Kt } from './smCost-eJv6tUyp.js';
import { S as Xt } from './SmAvailableGoodsText-DRE_9oIm.js';
import { S as Zt } from './SmDialogPopover-BgcrvCks.js';
import { a as Jt, b as ts, S as es } from './SmSwiperNewSlide-DpnHV4n1.js';
import { a as ss } from './arrow-left-24-9bB1SK7_.js';
import { T as is } from './constants-D0zX0Gdw.js';
import { S as as } from './SmShipmentTypeTabs-CzFLnp7l.js';
import { i as os } from './ic-my-card-BuJAYtSM.js';
import { S as ns } from './SmAccordion-CKeqjKiZ.js';
import { i as rs } from './ic-share-DuausJy6.js';
import { a as ls } from './arrow-left-16--wrtVy8p.js';
import { s as cs } from './ic-payment-sber-BE2DIIU5.js';
import { s as ms } from './ic-payment-sbp-DRi4MKba.js';
import './jsbarcode-BURi8tNl.js';
import './devtools-CFGE8QBr.js';
import './jwt-Dudb3GG9.js';
import './sentry-B_XvLg3L.js';
import './vkid-Dfzjioqr.js';
import './virtual-scroller-Co7Md_mA.js';
import './notification-DBOEqBTr.js';
import './floating-B5JpBeDD.js';
import './store-B8DkJuwH.js';
import './ic-delete-Bs3iCu1Y.js';
import './smBackgroundImage-DyoqRukH.js';
import './constants-CYngRuXA.js';
import './smProductSizesList-Bzf72LQ3.js';
import './SmProductPlates-CGAXKZWr.js';
import './SmPlate-C6QWdQyd.js';
import './constants-B1nZFGeP.js';
import './route-meta-C-hlBt6e.js';
import './plus-wRrmKz4P.js';
import './index-Byr22nZR.js';
import './SmMobileDialog-Cu5nu61Y.js';
import './swiper-wofYqc0q.js';
import './SmTabsNew-Ib8L-N8a.js';

const ds = "cartSnapshotId"
    , us = "availableForPickupOnly"
    , ps = "availableForDeliveryOnly"
    , hs = {
    name: "SmCartItemActions",
    components: {
        SmWishlistToggle: vt,
        SmCartItemRemove: Tt
    },
    props: {
        productId: {
            type: [Number, String],
            required: !0
        },
        selectedSize: {
            type: Object,
            require: !0
        },
        isBnpk: Boolean,
        blocked: Boolean
    },
    emits: ["delete"],
    computed: {
        showWishlistToggle() {
            return !this.isBnpk && !this.blocked
        }
    },
    methods: {
        onDelete(e) {
            return this.$emit("delete", e)
        }
    }
}
    , Ss = {
    class: "sm-cart-item-actions"
};
const _s = B(hs, [["render", function(n, r, l, c, m, d) {
    const u = e("SmWishlistToggle")
        , p = e("SmCartItemRemove");
    return t(),
        s("div", Ss, [d.showWishlistToggle ? (t(),
            i(u, {
                key: 0,
                class: "sm-cart-item-actions__wish-toggle",
                "product-id": l.productId,
                "selected-product-size": l.selectedSize,
                "data-selenium": "cart-item-wish",
                "icon-size": "24"
            }, null, 8, ["product-id", "selected-product-size"])) : a("", !0), o(p, {
            class: "sm-cart-item-actions__remove-button",
            "data-selenium": "cart-item-remove",
            onDelete: d.onDelete
        }, null, 8, ["onDelete"])])
}
]])
    , Cs = {
    class: "sm-cart-item-deleted__body"
}
    , ys = {
    key: 0,
    class: "sm-cart-item-deleted__name"
}
    , Ts = {
    class: "sm-cart-item-deleted__name"
};
const vs = B({
    name: "SmCartItemDeleted",
    consts: {
        crossIcon: x,
        restoreIcon: "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2032%2032'%3e%3cg%20fill='none'%20fill-rule='evenodd'%3e%3cpath%20fill='%23FFF'%20d='M25.344%2014.562h3.335V9.28A5.28%205.28%200%200%200%2023.4%204h-2.351v.199a3.208%203.208%200%201%201-6.416%200V4H13a6%206%200%200%200-6%206v4.562h3.335L10.212%2027.5h15l.132-12.938z'/%3e%3cpath%20fill='%23B5CAFF'%20d='M18%2011h4v5h-4z'/%3e%3cpath%20stroke='%231551E5'%20stroke-linejoin='round'%20stroke-width='1.5'%20d='M24.632%2014.562h3.335V9.28A5.28%205.28%200%200%200%2022.687%204h-2.352v.199a3.208%203.208%200%200%201-6.416%200V4h-1.631a6%206%200%200%200-6%206v4.562h3.335'/%3e%3cpath%20stroke='%231551E5'%20stroke-width='1.5'%20d='M9.622%2010.115V16m5.56%2011.347h9.45V10.115'/%3e%3cpath%20stroke='%23FF0016'%20stroke-width='1.5'%20d='M14.015%2022.891c0-2.701-2.123-4.891-4.741-4.891-1.848%200-3.449%201.09-4.231%202.683'/%3e%3cpath%20stroke='%23FF0016'%20stroke-width='1.5'%20d='m11.903%2021.804%202.274%201.649%201.674-2.29M4.433%2023.291c0%202.701%202.123%204.891%204.741%204.891%201.848%200%203.45-1.09%204.231-2.682'/%3e%3cpath%20stroke='%23FF0016'%20stroke-width='1.5'%20d='m6.566%2024.301-2.327-1.566-1.596%202.348'/%3e%3c/g%3e%3c/svg%3e",
        warningIcon: Et
    },
    components: {
        SmImage: G,
        SmSvgIcon: $
    },
    props: {
        name: String,
        errorMessage: {
            type: String,
            default: ""
        }
    },
    emits: ["restore", "close"],
    methods: {
        onRestore() {
            this.$emit("restore")
        },
        onClose() {
            this.$emit("close")
        }
    }
}, [["render", function(a, m, d, u, p, h) {
    const S = e("SmSvgIcon")
        , _ = e("SmImage");
    return t(),
        s("div", {
            class: c(["sm-cart-item-deleted", {
                "sm-cart-item-deleted--error": d.errorMessage
            }])
        }, [d.errorMessage ? (t(),
            i(S, {
                key: 0,
                class: "sm-cart-item-deleted__icon",
                icon: a.$options.consts.warningIcon,
                width: "32",
                height: "32"
            }, null, 8, ["icon"])) : (t(),
            i(_, {
                key: 1,
                class: "sm-cart-item-deleted__icon",
                src: a.$options.consts.restoreIcon,
                width: "32",
                height: "32"
            }, null, 8, ["src"])), n("div", Cs, [d.errorMessage ? (t(),
            s("span", ys, r(d.errorMessage), 1)) : (t(),
            s(l, {
                key: 1
            }, [n("span", Ts, r(d.name), 1), n("button", {
                type: "button",
                class: "sm-cart-item-deleted__restore",
                onClick: m[0] || (m[0] = (...e)=>h.onRestore && h.onRestore(...e))
            }, " Вернуть удаленный товар ")], 64))]), n("button", {
            type: "button",
            class: "sm-cart-item-deleted__close",
            onClick: m[1] || (m[1] = (...e)=>h.onClose && h.onClose(...e))
        }, [o(S, {
            icon: a.$options.consts.crossIcon,
            width: "24",
            height: "24"
        }, null, 8, ["icon"])])], 2)
}
]]);
m('<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="ic-courier"><path fill="currentColor" fill-rule="evenodd" d="M9.842 2c.32 0 .584.238.626.546l.006.086-.001 8.526h.417c.28-.398.727-.67 1.24-.714l.146-.006c.573 0 1.08.284 1.386.72h1.075l-.001-.505-.933-.014.02-1.263.913.014V7.791c0-.08-.024-.16-.07-.229l-.053-.065-1.877-1.892a.5.5 0 0 0-.276-.138l-.08-.006-1.404.004-.003-1.263 1.402-.004c.42-.001.826.146 1.143.412l.114.105 1.877 1.893c.28.281.45.648.485 1.036l.006.147v4c0 .32-.238.583-.546.625l-.086.006H13.94a1.69 1.69 0 0 1-1.663 1.384 1.69 1.69 0 0 1-1.664-1.385l-5.245.001v-1.263H9.21V3.263H1.263v5.698H8.22v1.095H1.263v1.103l.735-.001c.305-.436.812-.72 1.386-.72.933 0 1.69.753 1.69 1.684s-.757 1.684-1.69 1.684a1.69 1.69 0 0 1-1.664-1.385l-1.088.001a.63.63 0 0 1-.626-.546L0 11.79V2.632c0-.32.238-.584.546-.626L.632 2zm2.434 9.7a.424.424 0 0 0-.427.422c0 .232.19.42.427.42a.423.423 0 0 0 .427-.42.424.424 0 0 0-.427-.421zm-8.892 0a.424.424 0 0 0-.427.422c0 .232.19.42.427.42a.423.423 0 0 0 .427-.42.424.424 0 0 0-.427-.421z" /></symbol>', "ic-courier");
m('<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="ic-pick-up"><path fill="currentColor" fill-rule="evenodd" d="M7.776.443a.6.6 0 0 1 .448 0l6.5 2.614.02.008.046.023a.58.58 0 0 1 .25.26l.01.023.017.044.015.049.007.031a1 1 0 0 1 .011.118l-.004-.07.004.056v8.725a.6.6 0 0 1-.376.557l-6.5 2.613-.017.007q-.022.008-.045.015l-.035.008-.049.01q-.018 0-.035.003l-.042.001-.045-.001-.033-.004-.05-.008a1 1 0 0 1-.097-.03l.062.02-.045-.014-.017-.007-6.5-2.613a.6.6 0 0 1-.376-.557V3.598q0-.027.004-.054l.007-.05.007-.03.015-.05q.007-.021.017-.043l.011-.023a.6.6 0 0 1 .315-.291l-.066.03.047-.022.02-.008zM2.1 4.501v7.418l5.3 2.131V6.632l-2.268-.911.001 3.119h-1.2V5.238zm11.8 0L8.599 6.632 8.6 14.05l5.3-2.132zm-3.099-1.728.036.085L6.2 4.855l1.8.724 4.891-1.966zM8 1.646 3.108 3.613l1.521.611L9.352 2.19z" /></symbol>', "ic-pick-up");
const Es = {
    [us]: {
        icon: "ic-pick-up",
        short: "pickup",
        title: "Только самовывоз"
    },
    [ps]: {
        icon: "ic-courier",
        short: "delivery",
        title: "Только доставка"
    }
}
    , Is = ["data-selenium"];
const gs = {
    name: "SmCartItem",
    components: {
        SmText: U,
        SmPicture: Y,
        SmPositionPrice: gt,
        SmPositionQuantity: At,
        SmPositionDescription: It,
        SmCartItemActions: _s,
        SmCartItemDeleted: vs,
        SmCartItemShipmentPlate: B({
            name: "SmCartItemShipmentPlate",
            components: {
                SmSvgIcon: $,
                SmText: U
            },
            props: {
                type: {
                    type: String,
                    required: !0,
                    validator: e=>[us, ps].includes(e)
                }
            },
            computed: {
                matchedData() {
                    return Es[this.type] || {}
                }
            }
        }, [["render", function(i, a, n, l, m, p) {
            const h = e("SmSvgIcon")
                , S = e("SmText");
            return t(),
                s("div", {
                    class: c(["sm-cart-item-shipment-plate", `sm-cart-item-shipment-plate--${p.matchedData.short}`]),
                    "data-selenium": `cart-item-${p.matchedData.short}`
                }, [o(h, {
                    class: "sm-cart-item-shipment-plate__icon",
                    icon: p.matchedData.icon,
                    width: "16",
                    height: "16"
                }, null, 8, ["icon"]), o(S, {
                    class: "sm-cart-item-shipment-plate__message",
                    "data-selenium": "cart-item-remove",
                    variant: "text-12",
                    family: "medium"
                }, {
                    default: d((()=>[u(r(p.matchedData.title), 1)])),
                    _: 1
                })], 10, Is)
        }
        ]]),
        SmButton: F,
        SmCheckbox: H
    },
    props: {
        ...Ct
    },
    emits: ["onChange", "delete", "restore", "increase-quantity"],
    setup: e=>({
        ...yt(e)
    }),
    data: ()=>({
        pending: !1,
        restoreErrorMessage: ""
    }),
    computed: {
        ...p(["CART_SELECTED_SHIPMENT", "PAGE_TYPE", "CART_ITEMS_LAST_DELETED", "CART_ITEMS_RECOMMENDATIONS"]),
        ...p(j, ["SHOWCASE_PLATE"]),
        ...p(q, ["IS_ACTIVE"]),
        displayShowcaseItem() {
            return (this.CART_SELECTED_SHIPMENT === W || this.CART_SELECTED_SHIPMENT === z) && this.showcaseItem
        },
        platesCount() {
            return this.displayShowcaseItem ? 1 : void 0
        },
        availableShipmentType() {
            const {availableForDeliveryOnly: e, availableForPickupOnly: t} = this;
            return t === e ? null : t && us || e && ps
        },
        discount() {
            var e, t;
            return null == (t = null == (e = this.product) ? void 0 : e.price) ? void 0 : t.discountRate
        },
        bnpk() {
            var e;
            return (null == (e = this.product) ? void 0 : e.isBnpk) ? {
                nominal: this.retailPrice
            } : void 0
        },
        itemRecommendations() {
            return this.CART_ITEMS_RECOMMENDATIONS.find((e=>e.recNumber === this.index + 1))
        },
        isCheckboxShown() {
            return this.IS_ACTIVE("FT9114")
        },
        checkboxDisabled() {
            return this.availability.state === Q || this.blocked
        },
        checked() {
            return !this.checkboxDisabled && this.selected
        }
    },
    watch: {
        displayShowcaseItem: {
            handler(e) {
                e && !this.SHOWCASE_PLATE("cart") && this.FETCH_SHOWCASE_PLATE({
                    location: K.CART
                })
            },
            immediate: !0
        }
    },
    methods: {
        ...h(["SET_CART_ITEM_QUANTITY", "DELETE_CART_ITEM", "RESTORE_CART_ITEM", "RESET_DELETED_ITEM", "ADD_TO_CART", "SHOW_GLOBAL_DIALOG"]),
        ...h(j, ["FETCH_SHOWCASE_PLATE"]),
        async changeQuantity(e) {
            const {productId: t, wareId: s, quantity: i, cartList: a, PAGE_TYPE: o, bnpk: n} = this
                , r = Math.abs(i - e);
            try {
                await this.SET_CART_ITEM_QUANTITY({
                    productId: t,
                    wareId: s,
                    quantity: e,
                    bnpk: n
                }),
                    e > i ? (this.$analytics.sendIncreaseCartQuantityEvent({
                        product: {
                            productId: t,
                            wareId: s
                        },
                        quantity: r
                    }, o),
                        this.$emit("increase-quantity", {
                            wareId: s
                        })) : e < i && this.$analytics.sendDecreaseCartQuantityEvent({
                        product: {
                            productId: t,
                            wareId: s
                        },
                        quantity: r
                    }, {
                        from: o,
                        cartList: a
                    })
            } catch (l) {
                console.error(l)
            }
        },
        async onDelete() {
            var e, t;
            const {productId: s, wareId: i, quantity: a, cartList: o, index: n, PAGE_TYPE: r, bnpk: l} = this;
            try {
                this.pending = !0,
                    await this.DELETE_CART_ITEM({
                        productId: s,
                        wareId: i,
                        index: n,
                        bnpk: l
                    }),
                    this.$emit("delete", {
                        wareId: i
                    })
            } finally {
                this.pending = !1
            }
            null == (t = null == (e = this.$analytics) ? void 0 : e.sendRemoveFromCartEvent) || t.call(e, [{
                product: {
                    productId: s,
                    wareId: i
                },
                quantity: a
            }], {
                from: r,
                cartList: o
            })
        },
        async onRestore() {
            const {productId: e, wareId: t, quantity: s, CART_ITEMS_LAST_DELETED: i, bnpk: a} = this;
            try {
                this.pending = !0,
                    i ? await this.ADD_TO_CART({
                        productId: e,
                        wareId: t,
                        bnpk: a,
                        quantity: s,
                        cartFormat: X
                    }) : await this.RESTORE_CART_ITEM({
                        productId: e,
                        wareId: t,
                        quantity: s,
                        bnpk: a
                    }),
                    this.$emit("restore", {
                        wareId: t
                    })
            } catch (o) {
                this.restoreErrorMessage = "Невозможно восстановить товар."
            } finally {
                this.pending = !1
            }
        },
        async onClose() {
            this.restoreErrorMessage = "",
                await this.RESET_DELETED_ITEM()
        },
        showProductRecommendationsDialog() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmCartItemRecommendationsDialog",
                data: {
                    product: this.product,
                    size: this.size,
                    recommendations: this.itemRecommendations
                },
                woMobileNav: !0,
                options: {
                    restore: !0
                }
            })
        },
        changeCheckboxValue(e) {
            this.$emit("onChange", {
                wareId: this.wareId,
                selected: e
            })
        }
    }
}
    , As = {
    class: "sm-cart-item__left"
}
    , fs = ["href"]
    , ks = {
    class: "sm-cart-item__description"
}
    , bs = {
    class: "sm-cart-item__right"
};
const Rs = {
    name: "SmCartItemsList",
    components: {
        SmCartItemsGroup: B({
            name: "SmCartItemsGroup",
            components: {
                SmCartItem: B(gs, [["render", function(m, p, h, S, _, C) {
                    const y = e("SmCartItemDeleted")
                        , T = e("SmCheckbox")
                        , v = e("SmPicture")
                        , E = e("SmText")
                        , I = e("SmPositionDescription")
                        , g = e("SmCartItemShipmentPlate")
                        , A = e("SmButton")
                        , f = e("SmPositionQuantity")
                        , k = e("SmPositionPrice")
                        , b = e("SmCartItemActions");
                    return t(),
                        s("div", {
                            class: c(["sm-cart-item", {
                                "sm-cart-item--disabled": _.pending,
                                "sm-cart-item--unavailable": !m.available
                            }]),
                            "data-selenium": "basket-item"
                        }, [m.deleted ? (t(),
                            i(y, {
                                key: 0,
                                name: m.product.name,
                                "error-message": _.restoreErrorMessage,
                                class: "sm-cart-item__deleted",
                                onRestore: C.onRestore,
                                onClose: C.onClose
                            }, null, 8, ["name", "error-message", "onRestore", "onClose"])) : (t(),
                            s(l, {
                                key: 1
                            }, [n("div", As, [C.isCheckboxShown ? (t(),
                                i(T, {
                                    key: 0,
                                    class: "sm-cart-item__checkbox",
                                    "model-value": C.checked,
                                    "data-test-id": "checkbox",
                                    disabled: C.checkboxDisabled,
                                    onChange: C.changeCheckboxValue
                                }, null, 8, ["model-value", "disabled", "onChange"])) : a("", !0), n("a", {
                                href: m.url,
                                class: "sm-cart-item__image-wrapper"
                            }, [m.product.name ? (t(),
                                i(v, {
                                    key: 0,
                                    class: "sm-cart-item__image",
                                    src: m.image,
                                    width: 156,
                                    alt: m.product.name
                                }, null, 8, ["src", "alt"])) : a("", !0)], 8, fs)]), n("div", ks, [m.available ? a("", !0) : (t(),
                                i(E, {
                                    key: 0,
                                    class: "sm-cart-item__unavailable",
                                    variant: "text-12"
                                }, {
                                    default: d((()=>[m.blocked ? (t(),
                                        s(l, {
                                            key: 0
                                        }, [u("Временно недоступен")], 64)) : (t(),
                                        s(l, {
                                            key: 1
                                        }, [u("Нет в наличии")], 64))])),
                                    _: 1
                                })), o(I, {
                                class: "sm-cart-item__description-content",
                                url: m.url,
                                name: m.product.name,
                                color: m.product.color,
                                "promo-plates": m.product.promoPlates,
                                "promo-plates-ids": m.product.plateIds,
                                discount: C.discount,
                                size: m.size,
                                "showcase-item": C.displayShowcaseItem,
                                "plates-count": C.platesCount,
                                "has-associated-attributes": m.product.hasAssociatedAttributes,
                                "product-id": m.product.productId
                            }, null, 8, ["url", "name", "color", "promo-plates", "promo-plates-ids", "discount", "size", "showcase-item", "plates-count", "has-associated-attributes", "product-id"]), C.availableShipmentType ? (t(),
                                i(g, {
                                    key: 1,
                                    class: "sm-cart-item__shipment-plate",
                                    type: C.availableShipmentType
                                }, null, 8, ["type"])) : a("", !0), C.itemRecommendations ? (t(),
                                i(A, {
                                    key: 2,
                                    color: "inverse-blue",
                                    class: "sm-cart-item__recommendations-button",
                                    "data-test-id": "recommendations-button",
                                    onClick: C.showProductRecommendationsDialog
                                }, {
                                    default: d((()=>[u(r(C.itemRecommendations.slotCaption), 1)])),
                                    _: 1
                                }, 8, ["onClick"])) : a("", !0)]), n("div", bs, [m.available ? (t(),
                                i(f, {
                                    key: 0,
                                    class: "sm-cart-item__counter",
                                    "available-count": m.availableCount,
                                    quantity: m.quantity,
                                    "retail-price": m.retailPrice,
                                    "hide-error": "",
                                    onInput: C.changeQuantity
                                }, null, 8, ["available-count", "quantity", "retail-price", "onInput"])) : a("", !0), m.available ? (t(),
                                i(k, {
                                    key: 1,
                                    class: "sm-cart-item__total",
                                    "total-price": m.totalPrice,
                                    "original-price": m.originalPrice,
                                    "total-discount": m.totalDiscount
                                }, null, 8, ["total-price", "original-price", "total-discount"])) : a("", !0), o(b, {
                                class: "sm-cart-item__actions",
                                "product-id": m.productId,
                                "ware-id": m.wareId,
                                blocked: m.blocked,
                                "selected-size": m.size,
                                "is-bnpk": !!C.bnpk,
                                onDelete: C.onDelete
                            }, null, 8, ["product-id", "ware-id", "blocked", "selected-size", "is-bnpk", "onDelete"])])], 64))], 2)
                }
                ]]),
                SmLink: Z,
                SmMessage: J,
                SmProductItemsGroup: St
            },
            props: {
                items: {
                    type: Array,
                    default: ()=>[]
                },
                products: {
                    type: Object,
                    default: ()=>({})
                },
                deleteLabel: String,
                unavailableMessage: String,
                cartList: String,
                groupTitle: String
            },
            emits: ["onChange", "delete", "delete-single", "restore", "increase-quantity"],
            computed: {
                linkColor() {
                    return this.$root.isMediaLGMinus ? "darkblue" : "darkgray"
                }
            },
            methods: {
                onDelete() {
                    this.$emit("delete")
                },
                onChange(e) {
                    this.$emit("onChange", e)
                },
                onDeleteSingleItem(e) {
                    this.$emit("delete-single", e)
                },
                onRestore(e) {
                    this.$emit("restore", e)
                },
                onIncreaseQuantity(e) {
                    this.$emit("increase-quantity", e)
                }
            }
        }, [["render", function(s, n, l, c, m, p) {
            const h = e("SmLink")
                , _ = e("SmMessage")
                , C = e("SmCartItem")
                , y = e("SmProductItemsGroup");
            return t(),
                i(y, {
                    items: l.items,
                    class: "sm-cart-items-group",
                    "data-selenium": "cart-group"
                }, {
                    title: d((()=>[u(r(l.groupTitle), 1)])),
                    header: d((()=>[l.deleteLabel ? (t(),
                        i(h, {
                            key: 0,
                            color: p.linkColor,
                            tag: "button",
                            underline: "none",
                            class: "sm-cart-items-group__delete",
                            "data-selenium": "cart-group-delete",
                            onClick: S(p.onDelete, ["stop"])
                        }, {
                            default: d((()=>[u(r(l.deleteLabel), 1)])),
                            _: 1
                        }, 8, ["color", "onClick"])) : a("", !0)])),
                    warning: d((()=>[l.unavailableMessage ? (t(),
                        i(_, {
                            key: 0,
                            type: "error",
                            "icon-name": "ic-pick-up-disable",
                            class: "sm-cart-items-group__unavailable",
                            "data-selenium": "cart-group-unavailable-message"
                        }, {
                            default: d((()=>[u(r(l.unavailableMessage), 1)])),
                            _: 1
                        })) : a("", !0)])),
                    item: d((({item: {product: e, price: t, quantity: s, available: i, showcaseItem: a, blocked: n, deleted: r, availableForDeliveryOnly: c, availableForPickupOnly: m, selected: d}, index: u})=>{
                            var h, S;
                            return [o(C, {
                                "ware-id": e.wareId,
                                "product-id": e.productId,
                                product: {
                                    ...l.products[e.productId],
                                    price: {
                                        ...e.price,
                                        discountRate: null == (S = null == (h = l.products[e.productId]) ? void 0 : h.price) ? void 0 : S.discountRate
                                    }
                                },
                                price: t,
                                quantity: s,
                                availability: i,
                                "available-for-delivery-only": c,
                                "available-for-pickup-only": m,
                                "cart-list": l.cartList,
                                "showcase-item": a,
                                deleted: r,
                                blocked: n,
                                index: u,
                                selected: d,
                                "data-test-id": "cart-item",
                                onOnChange: p.onChange,
                                onDelete: p.onDeleteSingleItem,
                                onRestore: p.onRestore,
                                onIncreaseQuantity: p.onIncreaseQuantity
                            }, null, 8, ["ware-id", "product-id", "product", "price", "quantity", "availability", "available-for-delivery-only", "available-for-pickup-only", "cart-list", "showcase-item", "deleted", "blocked", "index", "selected", "onOnChange", "onDelete", "onRestore", "onIncreaseQuantity"])]
                        }
                    )),
                    _: 1
                }, 8, ["items"])
        }
        ]]),
        SmCheckbox: H,
        SmButton: F
    },
    props: {
        items: {
            type: Array,
            default: ()=>[]
        }
    },
    data: ()=>({
        itemsInStock: [],
        unallocatedItems: [],
        unavailableItems: [],
        oldItemsSelectedMap: {},
        newItemsSelectedMap: {}
    }),
    computed: {
        ...p(["BASE_URL", "PRODUCTS", "CART_SELECTED_SHIPMENT", "PAGE_TYPE", "ANONYMOUS", "UNIQUE_PLATE_IDS"]),
        ...p(q, ["IS_ACTIVE"]),
        availableTitle() {
            return `Товары, ${this.calculateCount(this.itemsInStock)} шт.`
        },
        unavailableTitle() {
            return `Недоступные товары, ${this.calculateCount(this.unavailableItems)} шт.`
        },
        unallocatedTitle() {
            return `Товары, ${this.calculateCount(this.unallocatedItems)} шт.`
        },
        cartList() {
            return ee(this.CART_SELECTED_SHIPMENT)
        },
        uniqueProductIds() {
            return new Set(this.items.map((({product: e})=>e.productId)))
        },
        isCheckboxesEnabled() {
            return this.IS_ACTIVE("FT9114")
        },
        isCheckboxShown() {
            return this.isCheckboxesEnabled && Object.keys(this.oldItemsSelectedMap).length
        },
        allItemsSelected: {
            get() {
                return Object.values(this.oldItemsSelectedMap).every((e=>!!e))
            },
            set(e) {
                this.onChangeAllItemsCheckboxes(e)
            }
        },
        someItemsSelected() {
            return Object.values(this.oldItemsSelectedMap).some((e=>!!e))
        },
        deleteLabel() {
            return this.isCheckboxesEnabled ? "" : "Удалить"
        }
    },
    watch: {
        items: {
            handler(e) {
                this.sortItems(e),
                    this.setCartItemsInfo()
            },
            immediate: !0,
            deep: !0
        }
    },
    methods: {
        ...h(["FETCH_CART_ITEMS_INFO", "SHOW_GLOBAL_DIALOG", "HIDE_GLOBAL_DIALOG", "DELETE_FROM_CART", "FETCH_CART_ITEMS_RECOMMENDATIONS", "CHANGE_CART_ITEMS_SELECTED_WITH_PENDING", "CHANGE_CART_TOTAL_PENDING"]),
        ...h(j, ["FETCH_PLATES"]),
        ...h(te, ["FETCH_WISHLIST_PRODUCTS_IDS"]),
        calculateCount: e=>_(e, (({quantity: e})=>e)),
        sortItems(e) {
            const {CART_SELECTED_SHIPMENT: t} = this
                , {itemsInStock: s=[], unavailableItems: i, unallocatedItems: a=[]} = t ? se(e) : ie(e);
            this.itemsInStock = s,
                this.unavailableItems = i,
                this.unallocatedItems = a,
                this.setCartItemsSelectedMap([...s, ...a])
        },
        showConfirmationDialog(e, t) {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmConfirm",
                data: {
                    title: "Удалить товары",
                    "buttons-data": {
                        [ft.cancel]: {
                            text: "Отмена",
                            emitTitle: "close"
                        },
                        [ft.confirm]: {
                            text: "Удалить"
                        }
                    }
                },
                woMobileNav: !0,
                onConfirm: ()=>{
                    this.deleteFromCart(e, t)
                }
            })
        },
        deleteFromCart(e, t) {
            const s = e.length === this.items.length;
            this.DELETE_FROM_CART(e),
            null == e || e.forEach((e=>{
                    delete this.newItemsSelectedMap[e.product.wareId]
                }
            )),
                this.$analytics.sendRemoveFromCartEvent(e, {
                    from: this.PAGE_TYPE,
                    cartList: t
                }),
            s && this.$analytics.sendClearCartEvent(e)
        },
        async setCartItemsInfo() {
            const e = Object.keys(this.PRODUCTS)
                , t = C(Array.from(this.uniqueProductIds), e);
            t.length > 0 && (await this.FETCH_CART_ITEMS_INFO(t),
                this.FETCH_CART_ITEMS_RECOMMENDATIONS(t),
            this.UNIQUE_PLATE_IDS && this.FETCH_PLATES({
                location: K.CART,
                ids: this.UNIQUE_PLATE_IDS,
                productIds: t
            }),
            this.ANONYMOUS || this.FETCH_WISHLIST_PRODUCTS_IDS())
        },
        setCartItemsSelectedMap(e) {
            this.oldItemsSelectedMap = e.reduce(((e,t)=>(t.deleted || (e[t.product.wareId] = t.selected),
                e)), {}),
            Object.keys(this.newItemsSelectedMap).length || (this.newItemsSelectedMap = {
                ...this.oldItemsSelectedMap
            }),
            !this.isCheckboxShown && this.items.some((e=>!e.selected)) && this.onChangeAllItemsCheckboxes(!0)
        },
        onChangeItemCheckbox(e) {
            this.CHANGE_CART_TOTAL_PENDING(!0),
                this.newItemsSelectedMap[e.wareId] = e.selected,
                this.debouncedChangeItemsCheckboxes(!1)
        },
        onChangeAllItemsCheckboxes(e) {
            Object.keys(this.newItemsSelectedMap).forEach((t=>{
                    this.newItemsSelectedMap[t] = e
                }
            )),
                this.debouncedChangeItemsCheckboxes()
        },
        debouncedChangeItemsCheckboxes: y((function(e=!0) {
                const {oldItemsSelectedMap: t, newItemsSelectedMap: s} = this;
                if (Object.keys(t).every((e=>t[e] === s[e])))
                    return void this.CHANGE_CART_TOTAL_PENDING(!1);
                const i = Object.entries(s).map((e=>({
                    wareId: e[0],
                    selected: e[1]
                })));
                this.CHANGE_CART_ITEMS_SELECTED_WITH_PENDING({
                    selectedItems: i,
                    pending: e
                })
            }
        ), 1e3),
        showDeleteSelectedDialog() {
            const e = [...this.itemsInStock, ...this.unallocatedItems].filter((e=>e.selected));
            this.SHOW_GLOBAL_DIALOG({
                template: "SmConfirm",
                data: {
                    title: "Удалить товары",
                    message: "Вы действительно хотите удалить выбранные товары?",
                    "buttons-data": {
                        [ft.cancel]: {
                            text: "Отменить",
                            emitTitle: "close"
                        },
                        [ft.confirm]: {
                            text: "Удалить"
                        }
                    }
                },
                woMobileNav: !0,
                onConfirm: ()=>{
                    this.deleteFromCart(e, this.cartList)
                }
            })
        },
        onDeleteSingleitem({wareId: e}) {
            delete this.newItemsSelectedMap[e]
        },
        onRestore({wareId: e}) {
            this.newItemsSelectedMap[e] = !0
        },
        onIncreaseQuantity({wareId: e}) {
            this.newItemsSelectedMap[e] = !0
        }
    }
}
    , Ls = {
    "data-selenium": "basket-items",
    class: "sm-cart-items-list"
}
    , Ds = {
    key: 0,
    class: "sm-cart-items-list__head"
};
const Os = B(Rs, [["render", function(n, r, l, c, m, p) {
    const h = e("SmCheckbox")
        , S = e("SmButton")
        , _ = e("SmCartItemsGroup");
    return t(),
        s("div", Ls, [p.isCheckboxShown ? (t(),
            s("div", Ds, [o(h, {
                modelValue: p.allItemsSelected,
                "onUpdate:modelValue": r[0] || (r[0] = e=>p.allItemsSelected = e),
                class: "sm-cart-items-list__head-all",
                "data-test-id": "checkbox"
            }, {
                default: d((()=>[u(" Выбрать все ")])),
                _: 1
            }, 8, ["modelValue"]), o(S, {
                class: "sm-cart-items-list__head-button",
                "data-test-id": "delete_selected",
                color: "transparent-black",
                type: "button",
                size: "xxs",
                disabled: !p.someItemsSelected,
                onClick: p.showDeleteSelectedDialog
            }, {
                default: d((()=>[u(" Удалить выбранное ")])),
                _: 1
            }, 8, ["disabled", "onClick"])])) : a("", !0), m.itemsInStock.length ? (t(),
            i(_, {
                key: 1,
                class: "sm-cart-items-list__group",
                items: m.itemsInStock,
                products: n.PRODUCTS,
                "delete-label": p.deleteLabel,
                "data-selenium": "cart-group-available",
                "data-test-id": "available-items",
                "cart-list": p.cartList.available,
                "group-title": p.availableTitle,
                onDelete: r[1] || (r[1] = e=>p.showConfirmationDialog(m.itemsInStock, p.cartList.available)),
                onOnChange: p.onChangeItemCheckbox,
                onDeleteSingle: p.onDeleteSingleitem,
                onRestore: p.onRestore,
                onIncreaseQuantity: p.onIncreaseQuantity
            }, null, 8, ["items", "products", "delete-label", "cart-list", "group-title", "onOnChange", "onDeleteSingle", "onRestore", "onIncreaseQuantity"])) : a("", !0), m.unallocatedItems.length ? (t(),
            i(_, {
                key: 2,
                ref: "unallocated",
                class: "sm-cart-items-list__group",
                items: m.unallocatedItems,
                products: n.PRODUCTS,
                "delete-label": p.deleteLabel,
                "data-selenium": "cart-group-unallocated",
                "data-test-id": "unallocated-items",
                "cart-list": p.cartList.unallocated,
                "group-title": p.unallocatedTitle,
                onDelete: r[2] || (r[2] = e=>p.showConfirmationDialog(m.unallocatedItems, p.cartList.unallocated)),
                onOnChange: p.onChangeItemCheckbox,
                onDeleteSingle: p.onDeleteSingleitem,
                onRestore: p.onRestore,
                onIncreaseQuantity: p.onIncreaseQuantity
            }, null, 8, ["items", "products", "delete-label", "cart-list", "group-title", "onOnChange", "onDeleteSingle", "onRestore", "onIncreaseQuantity"])) : a("", !0), m.unavailableItems.length ? (t(),
            i(_, {
                key: 3,
                class: "sm-cart-items-list__group",
                items: m.unavailableItems,
                products: n.PRODUCTS,
                "delete-label": "Удалить",
                "data-selenium": "cart-group-unavailable",
                "data-test-id": "unavailable-items",
                "cart-list": p.cartList.unavailable,
                "group-title": p.unavailableTitle,
                onDelete: r[3] || (r[3] = e=>p.showConfirmationDialog(m.unavailableItems, p.cartList.unavailable)),
                onDeleteSingle: p.onDeleteSingleitem,
                onRestore: p.onRestore,
                onIncreaseQuantity: p.onIncreaseQuantity
            }, null, 8, ["items", "products", "cart-list", "group-title", "onDeleteSingle", "onRestore", "onIncreaseQuantity"])) : a("", !0)])
}
]])
    , Ps = {
    name: "SmLegalEntity",
    components: {
        SmLink: Z,
        SmToggle: ae
    },
    props: {
        disabled: {
            type: Boolean,
            default: !1
        }
    },
    data: ()=>({
        loading: !1
    }),
    computed: {
        ...p(["CART_IS_LEGAL_ENTITY", "CART_LEGAL_ENTITY_INFO", "PHONE_MASK"]),
        info() {
            const {PHONE_MASK: e, CART_LEGAL_ENTITY_INFO: {phone: t, legalName: s}} = this;
            return [s, oe(t, e.format)].filter(Boolean)
        }
    },
    methods: {
        ...h(["SHOW_GLOBAL_DIALOG", "SET_CART_LEGAL_ENTITY_DATA"]),
        showLegalEntityInfoDialog() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmLegalEntityInfoDialog",
                blockOutsideClosing: !0,
                woMobileNav: !0,
                options: {
                    restore: !0
                }
            })
        },
        onChange() {
            this.CART_IS_LEGAL_ENTITY ? this.resetLegalEntityInfo() : this.showLegalEntityInfoDialog()
        },
        async resetLegalEntityInfo() {
            try {
                this.loading = !0,
                    await this.SET_CART_LEGAL_ENTITY_DATA({
                        isLegalEntity: !1
                    })
            } catch {
                this.SHOW_GLOBAL_DIALOG({
                    template: "SmAlert",
                    data: {
                        title: "Ошибка",
                        message: ne.errorCodes.default
                    }
                })
            } finally {
                this.loading = !1
            }
        }
    }
}
    , Ns = {
    class: "sm-legal-entity"
}
    , ws = {
    class: "sm-legal-entity__label"
}
    , Ms = {
    key: 0,
    class: "sm-legal-entity__profile"
}
    , Vs = {
    key: 0,
    class: "sm-legal-entity__info sm-legal-entity__info--bold"
};
const Bs = B(Ps, [["render", function(i, c, m, p, h, S) {
    const _ = e("SmToggle")
        , C = e("sm-link");
    return t(),
        s("section", Ns, [n("div", ws, [u(" Юридическое лицо "), o(_, {
            "data-test-id": "legal-entity-toggle",
            disabled: m.disabled || h.loading,
            "model-value": i.CART_IS_LEGAL_ENTITY,
            onChange: S.onChange
        }, null, 8, ["disabled", "model-value", "onChange"])]), i.CART_IS_LEGAL_ENTITY ? (t(),
            s("div", Ms, [i.CART_LEGAL_ENTITY_INFO.contactPerson ? (t(),
                s("span", Vs, r(i.CART_LEGAL_ENTITY_INFO.contactPerson), 1)) : a("", !0), (t(!0),
                s(l, null, T(S.info, ((e,i)=>(t(),
                    s("span", {
                        key: i,
                        class: "sm-legal-entity__info"
                    }, r(e), 1)))), 128)), o(C, {
                "data-test-id": "legal-entity-change-details",
                class: "sm-legal-entity__link",
                onClick: S.showLegalEntityInfoDialog
            }, {
                default: d((()=>[u(" Изменить реквизиты ")])),
                _: 1
            }, 8, ["onClick"])])) : a("", !0)])
}
]])
    , xs = {
    name: "CartEmpty",
    components: {
        SmImage: G,
        SmText: U,
        SmButton: F,
        SmProductRecommendationsGroup: kt
    },
    consts: {
        emptyBasketImage: bt,
        EMPTY_CART_RECOMMENDATIONS_SLOT_ID: "Recommendations_Basket_Slot_1"
    },
    computed: {
        ...p(["BASE_URL"]),
        catalogUrl() {
            return re(this.BASE_URL)
        }
    }
}
    , Gs = {
    class: "cart-empty"
}
    , $s = {
    "data-selenium": "emptyBlock",
    class: "cart-empty-info"
};
const Us = B(xs, [["render", function(i, a, r, l, c, m) {
    const p = e("SmImage")
        , h = e("SmText")
        , S = e("SmButton")
        , _ = e("SmProductRecommendationsGroup");
    return t(),
        s("div", Gs, [n("div", $s, [o(p, {
            class: "cart-empty-info__image",
            src: i.$options.consts.emptyBasketImage,
            width: "120",
            height: "120",
            alt: "empty cart"
        }, null, 8, ["src"]), o(h, {
            "data-selenium": "title",
            class: "cart-empty-info__title",
            variant: "inherit",
            family: "medium"
        }, {
            default: d((()=>[u(" В вашей корзине пусто ")])),
            _: 1
        }), o(h, {
            "data-selenium": "message",
            class: "cart-empty-info__message",
            variant: "text-12",
            tag: "p"
        }, {
            default: d((()=>[u(" Начните путь к спорту прямо сейчас. Перейдите в каталог и добавьте товар в корзину. ")])),
            _: 1
        }), o(S, {
            "data-selenium": "backButton",
            class: "cart-empty-info__back-button",
            href: m.catalogUrl,
            tag: "a",
            size: "s"
        }, {
            default: d((()=>[o(h, {
                variant: "button-s"
            }, {
                default: d((()=>[u("В каталог")])),
                _: 1
            })])),
            _: 1
        }, 8, ["href"])]), o(_, {
            class: "cart-empty__recommendations",
            "slot-ids": [i.$options.consts.EMPTY_CART_RECOMMENDATIONS_SLOT_ID],
            wide: ""
        }, null, 8, ["slot-ids"])])
}
]])
    , Ys = {
    fio: "",
    phone: "",
    email: "",
    verificationCode: ""
}
    , Fs = {
    name: "SmCartContactsAnonymous",
    components: {
        SmButton: F,
        SmFormField: le,
        SmFormVee: ce,
        SmTimer: Vt
    },
    consts: {
        EMAIL_TYPE: me,
        TEXT_TYPE: de,
        PHONE_TYPE: ue,
        CONTACT_NAME_TYPE: pe,
        phoneVerificationText: "Для оформления заказа подтвердите номер телефона"
    },
    props: {
        modelValue: {
            type: Object,
            default: ()=>({
                ...Ys
            })
        },
        codeError: Boolean,
        phoneVerificationRequired: {
            type: Boolean,
            default: !0
        }
    },
    emits: ["update:modelValue"],
    data() {
        return {
            model: {
                ...this.modelValue
            },
            hasEnterCode: !1,
            timer: 0,
            codeErrorMessage: "",
            phoneErrorMessage: "",
            isPhoneVerificationError: !1,
            formRef: {}
        }
    },
    computed: {
        ...p(["BASE_URL"]),
        isPhoneValid() {
            var e, t;
            return null == (t = (e = this.formRef).isFieldPassed) ? void 0 : t.call(e, "phone")
        },
        isValid() {
            const {$refs: e, codeErrorMessage: t, isPhoneVerificationError: s} = this
                , {valid: i} = e.form;
            return i && !t && !s
        },
        isTimerActive() {
            return this.timer > 0
        },
        showPhoneVerificationBlock() {
            return this.phoneVerificationRequired
        },
        validationSchema: ()=>({
            fio: {
                required: !0,
                format: !0,
                discord: !0,
                min: {
                    length: 2
                }
            },
            email: {
                required: !0
            },
            phone: {
                required: !0,
                phoneError: !0,
                phoneMask: he.ru.input
            },
            verificationCode: {
                required: !0,
                codeError: !0
            }
        }),
        isPhoneVerificationErrorShown() {
            const {hasEnterCode: e, isPhoneVerificationError: t} = this;
            return !e && t
        }
    },
    watch: {
        model: {
            handler(e) {
                v(e, this.modelValue) || this.$emit("update:modelValue", {
                    ...e,
                    phone: Se(e.phone)
                })
            },
            deep: !0
        },
        codeError(e) {
            this.codeErrorMessage = e ? "Неверный код" : ""
        },
        phoneVerificationRequired: {
            handler(e) {
                e && (this.hasEnterCode = !1),
                    this.resetVerificationCode()
            },
            immediate: !0
        },
        phoneErrorMessage() {
            this.formRef.validateField("phone")
        },
        codeErrorMessage() {
            this.formRef.validateField("code")
        }
    },
    mounted() {
        this.formRef = this.$refs.form,
            E("codeError", this.getCodeErrorMessage),
            E("phoneError", this.getPhoneErrorMessage)
    },
    methods: {
        async validate() {
            const {formRef: e, codeError: t, model: {verificationCode: s}, showPhoneVerificationBlock: i} = this;
            await e.validate(),
            !i || s || t || (this.isPhoneVerificationError = !0)
        },
        async getCode() {
            const {model: e, BASE_URL: t} = this;
            this.clearPhoneVerificationError();
            try {
                const s = await _e(t, Se(null == e ? void 0 : e.phone));
                this.timer = Ce(null == s ? void 0 : s.expired),
                    this.hasEnterCode = !0
            } catch (s) {
                s.status && 400 === s.status && (this.phoneErrorMessage = "Неверный формат"),
                    console.error(s)
            }
        },
        onEndTimer() {
            this.timer = 0
        },
        refreshCode() {
            this.getCode()
        },
        clearPhoneVerificationError() {
            this.isPhoneVerificationError = !1
        },
        onPhoneEdit() {
            this.phoneErrorMessage = ""
        },
        onCodeEdit() {
            this.codeErrorMessage = "",
                this.clearPhoneVerificationError()
        },
        getCodeErrorMessage() {
            return this.codeErrorMessage || !0
        },
        getPhoneErrorMessage() {
            return this.phoneErrorMessage || !0
        },
        resetVerificationCode() {
            this.model.verificationCode = ""
        },
        getInvalidFieldErrors() {
            const {errors: e} = this.formRef;
            return e ? (e.verificationCode && !this.hasEnterCode && delete e.verificationCode,
            this.isPhoneVerificationErrorShown && (e.phoneVerificationError = this.$options.consts.phoneVerificationText),
                Object.values(e)) : []
        }
    }
}
    , Hs = {
    key: 0,
    "data-test-id": "phone-verification-block"
}
    , js = {
    class: "sm-cart-contacts-anonymous-form__code"
}
    , qs = {
    class: "sm-cart-contacts-anonymous-form__code-side"
}
    , Ws = {
    key: 0,
    class: "sm-cart-contacts-anonymous-form__code-text"
}
    , zs = {
    key: 0,
    class: "sm-cart-contacts-anonymous-form__error",
    "data-selenium": "error-message"
};
const Qs = B(Fs, [["render", function(m, p, h, S, _, C) {
    const y = e("SmFormField")
        , T = e("SmTimer")
        , v = e("SmButton")
        , E = e("SmFormVee");
    return t(),
        i(E, {
            ref: "form",
            class: "sm-cart-contacts-anonymous-form",
            "data-selenium": "cartContactsForm",
            "validation-schema": C.validationSchema
        }, {
            default: d((()=>[o(y, {
                modelValue: _.model.fio,
                "onUpdate:modelValue": p[0] || (p[0] = e=>_.model.fio = e),
                type: m.$options.consts.CONTACT_NAME_TYPE,
                name: "fio",
                "data-selenium": "fio",
                "data-test-id": "fullName",
                autocomplete: "name"
            }, null, 8, ["modelValue", "type"]), o(y, {
                modelValue: _.model.email,
                "onUpdate:modelValue": p[1] || (p[1] = e=>_.model.email = e),
                name: "email",
                "data-selenium": "email",
                "data-test-id": "email",
                type: m.$options.consts.EMAIL_TYPE
            }, null, 8, ["modelValue", "type"]), o(y, {
                ref: "phone",
                modelValue: _.model.phone,
                "onUpdate:modelValue": [p[2] || (p[2] = e=>_.model.phone = e), C.onPhoneEdit],
                name: "phone",
                type: m.$options.consts.PHONE_TYPE,
                "data-selenium": "phone",
                "data-test-id": "phone"
            }, null, 8, ["modelValue", "type", "onUpdate:modelValue"]), C.showPhoneVerificationBlock ? (t(),
                s("div", Hs, [n("div", js, [_.hasEnterCode ? (t(),
                    s(l, {
                        key: 0
                    }, [n("div", {
                        class: c(["sm-cart-contacts-anonymous-form__code-input", {
                            "sm-cart-contacts-anonymous-form__code-input--error": _.isPhoneVerificationError
                        }])
                    }, [o(y, {
                        ref: "code",
                        modelValue: _.model.verificationCode,
                        "onUpdate:modelValue": [p[3] || (p[3] = e=>_.model.verificationCode = e), C.onCodeEdit],
                        mask: "##########",
                        type: m.$options.consts.TEXT_TYPE,
                        name: "verificationCode",
                        label: "Код из SMS",
                        placeholder: "Введите код",
                        "data-selenium": "code",
                        "data-test-id": "code"
                    }, null, 8, ["modelValue", "type", "onUpdate:modelValue"])], 2), n("div", qs, [C.isTimerActive ? (t(),
                        s("span", Ws, [u(" Получить новый код можно через "), o(T, {
                            class: "sm-cart-contacts-anonymous-form__timer",
                            start: _.timer,
                            "data-selenium": "timer",
                            onEnd: C.onEndTimer
                        }, null, 8, ["start", "onEnd"])])) : (t(),
                        s("button", {
                            key: 1,
                            class: "sm-cart-contacts-anonymous-form__refresh",
                            type: "button",
                            "data-selenium": "refreshCode",
                            onClick: p[4] || (p[4] = (...e)=>C.refreshCode && C.refreshCode(...e))
                        }, " Получить код повторно "))])], 64)) : (t(),
                    i(v, {
                        key: 1,
                        ref: "button",
                        class: "sm-cart-contacts-anonymous-form__button",
                        type: "button",
                        size: "s",
                        color: "white-blue",
                        disabled: !C.isPhoneValid,
                        "data-selenium": "getCode",
                        onClick: C.getCode
                    }, {
                        default: d((()=>[u(" Получить код ")])),
                        _: 1
                    }, 8, ["disabled", "onClick"]))]), C.isPhoneVerificationErrorShown ? (t(),
                    s("div", zs, r(m.$options.consts.phoneVerificationText), 1)) : a("", !0)])) : a("", !0)])),
            _: 1
        }, 8, ["validation-schema"])
}
]])
    , Ks = {
    class: "sm-checkout-selected-blank"
}
    , Xs = {
    key: 0,
    class: "sm-checkout-selected-blank__icon"
}
    , Zs = {
    class: "sm-checkout-selected-blank__content"
}
    , Js = {
    class: "sm-checkout-selected-blank__title"
}
    , ei = {
    key: 0,
    class: "sm-checkout-selected-blank__info"
};
const ti = B({
    name: "SmCheckoutSelectedBlank",
    components: {
        SmImage: G
    },
    props: {
        image: String,
        imageAlt: String,
        title: {
            type: String,
            required: !0
        },
        info: {
            type: String,
            default: ""
        }
    },
    computed: {
        imageAltText() {
            return this.imageAlt || "Иконка шага оформления"
        }
    }
}, [["render", function(i, l, c, m, d, u) {
    const p = e("SmImage");
    return t(),
        s("div", Ks, [c.image ? (t(),
            s("div", Xs, [o(p, {
                class: "sm-checkout-selected-blank__image",
                src: c.image,
                loading: "eager",
                alt: u.imageAltText
            }, null, 8, ["src", "alt"])])) : a("", !0), n("div", Zs, [n("span", Js, r(c.title), 1), I(i.$slots, "default", {}, (()=>[c.info ? (t(),
            s("p", ei, r(c.info), 1)) : a("", !0)]))])])
}
]])
    , si = {
    name: "SmCartContactsOwnerCard",
    components: {
        ClientOnly: ye,
        SmCheckoutSelectedBlank: ti
    },
    consts: {
        profileImage: _t
    },
    props: {
        fio: {
            type: String
        },
        phone: {
            type: String
        },
        phoneMask: {
            type: String
        },
        email: {
            type: String
        }
    },
    computed: {
        ...p(["PHONE_MASK"]),
        contacts() {
            const {PHONE_MASK: e, phone: t, email: s, phoneMask: i} = this
                , a = i || e.format;
            return [oe(t, a), s].filter(Boolean)
        },
        adaptedContacts() {
            return this.contacts.map(((e,t)=>t && this.$root.isMediaSMPlus ? `&nbsp;| ${e}` : e))
        }
    }
}
    , ii = {
    class: "sm-cart-contacts-owner-card__contacts"
}
    , ai = ["innerHTML"];
const oi = {
    fio: "",
    phone: "",
    email: ""
}
    , ni = {
    key: 0,
    class: "sm-cart-contacts-owner-form__custom-fields",
    "data-test-id": "custom-fields"
};
const ri = {
    fio: "",
    phone: "",
    email: ""
};
const li = {
    name: "SmCartContactsUser",
    components: {
        SmCartContactsOwner: B({
            name: "SmCartContactsOwner",
            components: {
                SmFormVee: ce,
                SmFormField: le,
                SmCartContactsOwnerCard: B(si, [["render", function(a, r, c, m, u, p) {
                    const h = e("ClientOnly")
                        , S = e("SmCheckoutSelectedBlank");
                    return t(),
                        i(S, {
                            image: a.$options.consts.profileImage,
                            title: c.fio,
                            class: "sm-cart-contacts-owner-card"
                        }, {
                            default: d((()=>[n("div", ii, [o(h, null, {
                                default: d((()=>[(t(!0),
                                    s(l, null, T(p.adaptedContacts, ((e,i)=>(t(),
                                        s("span", {
                                            key: i,
                                            class: "sm-cart-contacts-owner-card__contact",
                                            "data-selenium": "contacts",
                                            innerHTML: e
                                        }, null, 8, ai)))), 128))])),
                                _: 1
                            })])])),
                            _: 1
                        }, 8, ["image", "title"])
                }
                ]])
            },
            consts: {
                EMAIL_TYPE: me,
                CONTACT_NAME_TYPE: pe
            },
            props: {
                contacts: {
                    type: Object,
                    default: ()=>({
                        ...oi
                    })
                }
            },
            emits: ["update:model-value"],
            data: ()=>({
                customContacts: {
                    fio: "",
                    email: ""
                },
                formRef: {}
            }),
            computed: {
                isValid() {
                    return this.formRef.valid
                },
                customContactsStorageKey() {
                    const {contacts: e} = this;
                    return `customContacts:${e.phone}`
                },
                validationSchema() {
                    const e = {};
                    return this.contacts.fio || (e.contact = {
                        required: !0,
                        format: !0,
                        discord: !0,
                        min: {
                            length: 2
                        }
                    }),
                    this.contacts.email || (e.email = {
                        required: !0
                    }),
                        e
                }
            },
            mounted() {
                this.formRef = this.$refs.form,
                    this.initCustomContacts()
            },
            methods: {
                validate() {
                    return this.formRef.validate()
                },
                initCustomContacts() {
                    this.customContacts = Te.getItem(this.customContactsStorageKey) || {},
                        this.inputCustomContacts(this.customContacts)
                },
                saveCustomContacts(e) {
                    Te.setItem(this.customContactsStorageKey, e)
                },
                changeCustomContacts(e, t) {
                    this.customContacts[e] !== t && (this.customContacts[e] = t,
                        this.saveCustomContacts(this.customContacts),
                        this.inputCustomContacts(this.customContacts))
                },
                inputCustomContacts(e) {
                    this.$emit("update:model-value", e)
                }
            }
        }, [["render", function(n, r, l, c, m, u) {
            const p = e("SmCartContactsOwnerCard")
                , h = e("SmFormField")
                , S = e("SmFormVee");
            return t(),
                i(S, {
                    ref: "form",
                    "interaction-mode": "lazy",
                    class: "sm-cart-contacts-owner-form",
                    "validation-schema": u.validationSchema
                }, {
                    default: d((()=>[o(p, {
                        phone: l.contacts.phone,
                        email: l.contacts.email,
                        fio: l.contacts.fio
                    }, null, 8, ["phone", "email", "fio"]), l.contacts.email && l.contacts.fio ? a("", !0) : (t(),
                        s("div", ni, [l.contacts.email ? a("", !0) : (t(),
                            i(h, {
                                key: 0,
                                "model-value": m.customContacts.email,
                                type: n.$options.consts.EMAIL_TYPE,
                                name: "email",
                                "data-selenium": "field-email",
                                "data-test-id": "email",
                                "onUpdate:modelValue": r[0] || (r[0] = e=>u.changeCustomContacts("email", e))
                            }, null, 8, ["model-value", "type"])), l.contacts.fio ? a("", !0) : (t(),
                            i(h, {
                                key: 1,
                                type: n.$options.consts.CONTACT_NAME_TYPE,
                                "model-value": m.customContacts.fio,
                                name: "contact",
                                "data-test-id": "fio",
                                autocomplete: "name",
                                "onUpdate:modelValue": r[1] || (r[1] = e=>u.changeCustomContacts("fio", e))
                            }, null, 8, ["type", "model-value"]))]))])),
                    _: 1
                }, 8, ["validation-schema"])
        }
        ]]),
        SmCartContactsReceiver: B({
            name: "SmCartContactsReceiver",
            components: {
                SmFormVee: ce,
                SmFormField: le
            },
            consts: {
                EMAIL_TYPE: me,
                PHONE_TYPE: ue,
                CONTACT_NAME_TYPE: pe,
                validationSchema: {
                    contact: {
                        required: !0,
                        format: !0,
                        discord: !0,
                        min: {
                            length: 2
                        }
                    },
                    email: {
                        required: !0
                    },
                    phone: {
                        required: !0,
                        phoneMask: he.ru.input
                    }
                }
            },
            props: {
                contacts: {
                    type: Object,
                    default: ()=>({
                        ...ri
                    })
                }
            },
            data() {
                return {
                    model: {
                        ...this.contacts
                    },
                    formRef: {}
                }
            },
            mounted() {
                this.formRef = this.$refs.form
            },
            methods: {
                ...h(["SAVE_RECEIVER"]),
                getInvalidFieldErrors() {
                    var e;
                    return (null == (e = this.formRef) ? void 0 : e.errors) ? Object.values(this.formRef.errors) : []
                },
                async validate() {
                    return this.formRef.validate()
                },
                emitInput() {
                    const e = {
                        ...this.model,
                        phone: Se(this.model.phone)
                    };
                    if (v(e, this.contacts) || !this.formRef.valid)
                        return;
                    const t = {
                        contactUserType: ve,
                        receiver: e
                    };
                    this.SAVE_RECEIVER(t)
                }
            }
        }, [["render", function(s, a, n, r, l, c) {
            const m = e("SmFormField")
                , u = e("SmFormVee");
            return t(),
                i(u, {
                    ref: "form",
                    class: "sm-cart-contacts-receiver-form",
                    "data-selenium": "cartContactsReceiver",
                    "validation-schema": s.$options.consts.validationSchema
                }, {
                    default: d((()=>[o(m, {
                        modelValue: l.model.fio,
                        "onUpdate:modelValue": a[0] || (a[0] = e=>l.model.fio = e),
                        type: s.$options.consts.CONTACT_NAME_TYPE,
                        name: "contact",
                        "data-selenium": "fio",
                        "data-test-id": "fullName",
                        autocomplete: "name",
                        "ext-required": "",
                        onBlur: c.emitInput
                    }, null, 8, ["modelValue", "type", "onBlur"]), o(m, {
                        modelValue: l.model.email,
                        "onUpdate:modelValue": a[1] || (a[1] = e=>l.model.email = e),
                        type: s.$options.consts.EMAIL_TYPE,
                        name: "email",
                        "data-selenium": "field-email",
                        "data-test-id": "email",
                        "ext-required": "",
                        onBlur: c.emitInput
                    }, null, 8, ["modelValue", "type", "onBlur"]), o(m, {
                        modelValue: l.model.phone,
                        "onUpdate:modelValue": a[2] || (a[2] = e=>l.model.phone = e),
                        type: s.$options.consts.PHONE_TYPE,
                        name: "phone",
                        "data-selenium": "phone",
                        "data-test-id": "phone",
                        "ext-required": "",
                        onBlur: c.emitInput
                    }, null, 8, ["modelValue", "type", "onBlur"])])),
                    _: 1
                }, 8, ["validation-schema"])
        }
        ]]),
        SmText: U,
        SmToggle: ae
    },
    props: {
        owner: {
            type: Object,
            default: ()=>({})
        },
        receiver: {
            type: Object,
            default: ()=>({})
        },
        userType: {
            type: String,
            required: !0
        },
        modelValue: {
            type: Object,
            default: null
        }
    },
    emits: ["input", "update:modelValue"],
    data() {
        return {
            pending: !1,
            ownerData: null,
            typeIsReceiver: this.userType.toUpperCase() === ve
        }
    },
    computed: {
        isValid() {
            const {$refs: e, typeIsReceiver: t} = this;
            return (t ? e.receiver : e.owner).isValid
        }
    },
    watch: {
        typeIsReceiver: {
            handler: "toggleReceiver"
        },
        ownerData: {
            handler: "emitModel"
        },
        userType(e) {
            var t;
            this.typeIsReceiver = (null == (t = null == e ? void 0 : e.toUpperCase) ? void 0 : t.call(e)) === ve
        }
    },
    methods: {
        ...h(["SAVE_RECEIVER"]),
        getReceiverFieldErrors() {
            var e, t, s;
            return null == (s = null == (t = null == (e = this.$refs) ? void 0 : e.receiver) ? void 0 : t.getInvalidFieldErrors) ? void 0 : s.call(t)
        },
        validate() {
            const {$refs: e, typeIsReceiver: t} = this;
            return (t ? e.receiver : e.owner).validate()
        },
        async toggleReceiver() {
            const {receiver: e, typeIsReceiver: t} = this
                , s = {
                contactUserType: t ? ve : Ee
            };
            g(e) && t || (t && (s.receiver = e),
                this.pending = !0,
                await this.SAVE_RECEIVER(s),
                this.pending = !1)
        },
        emitModel() {
            const {typeIsReceiver: e, ownerData: t} = this;
            e || (this.$emit("input", t),
                this.$emit("update:modelValue", t))
        }
    }
}
    , ci = {
    class: "sm-cart-contacts-user"
}
    , mi = n("label", {
    class: "sm-cart-contacts-user__label",
    for: "receiver-toggle"
}, " Получать буду не я ", -1);
const di = B(li, [["render", function(a, n, r, l, c, m) {
    const u = e("SmToggle")
        , p = e("SmText")
        , h = e("SmCartContactsReceiver")
        , S = e("SmCartContactsOwner");
    return t(),
        s("div", ci, [o(p, {
            variant: "text-14",
            class: "sm-cart-contacts-user__toggle-wrp"
        }, {
            default: d((()=>[mi, o(u, {
                id: "receiver-toggle",
                modelValue: c.typeIsReceiver,
                "onUpdate:modelValue": n[0] || (n[0] = e=>c.typeIsReceiver = e),
                disabled: c.pending,
                size: "s",
                class: "sm-cart-contacts-user__toggle",
                "data-selenium": "receiverToggle"
            }, null, 8, ["modelValue", "disabled"])])),
            _: 1
        }), c.typeIsReceiver ? (t(),
            i(h, {
                key: 0,
                ref: "receiver",
                contacts: r.receiver,
                "data-selenium": "receiverForm"
            }, null, 8, ["contacts"])) : (t(),
            i(S, {
                key: 1,
                ref: "owner",
                modelValue: c.ownerData,
                "onUpdate:modelValue": n[1] || (n[1] = e=>c.ownerData = e),
                contacts: r.owner,
                "data-selenium": "ownerForm"
            }, null, 8, ["modelValue", "contacts"]))])
}
]])
    , ui = [Ae, ge, Ie]
    , pi = {
    name: "SmCartStep",
    components: {
        SmText: U
    },
    consts: {
        TEXTS: {
            [Ie]: {
                title: "Способ получения",
                description: "",
                error: "Выберите способ получения для перехода к следующим шагам оформления заказа",
                reset: "Изменился состав заказа. Пожалуйста, выберите способ получения"
            },
            [ge]: {
                title: "Способ оплаты",
                description: "Выберите способ получения и вы сможете выбрать способ оплаты",
                error: "Для оформления заказа выберите способ оплаты"
            },
            [Ae]: {
                title: "Данные получателя",
                description: "Выберите способ получения и вы сможете ввести контактные данные",
                error: "Для оформления заказа введите контактные данные"
            }
        }
    },
    props: {
        name: {
            type: String,
            validator: e=>ui.includes(e)
        },
        disabled: {
            type: Boolean,
            default: !1
        },
        error: {
            type: Boolean,
            default: !1
        },
        reset: {
            type: Boolean,
            default: !1
        },
        title: {
            type: String
        }
    },
    computed: {
        messages() {
            return this.$options.consts.TEXTS[this.name]
        },
        stepTitle() {
            return this.title || this.messages.title
        },
        isMainStep() {
            return this.name === Ie
        },
        isError() {
            const {disabled: e, error: t} = this;
            return !e && t
        },
        isReset() {
            const {disabled: e, error: t, reset: s} = this;
            return !e && !t && s
        }
    }
}
    , hi = {
    class: "sm-cart-step__header"
}
    , Si = {
    key: 0,
    class: "sm-cart-step__title-block"
}
    , _i = {
    class: "sm-cart-step__title"
}
    , Ci = {
    key: 2,
    class: "sm-cart-step__content"
};
const yi = B(pi, [["render", function(o, l, m, p, h, S) {
    const _ = e("SmText");
    return t(),
        s("div", {
            class: c(["sm-cart-step", {
                "sm-cart-step--main": S.isMainStep
            }])
        }, [n("div", hi, [S.messages ? (t(),
            s("div", Si, [n("div", _i, r(S.stepTitle), 1), m.disabled ? (t(),
                i(_, {
                    key: 0,
                    class: "sm-cart-step__description",
                    variant: "text-14"
                }, {
                    default: d((()=>[u(r(S.messages.description), 1)])),
                    _: 1
                })) : a("", !0)])) : a("", !0), I(o.$slots, "headerContent")]), S.messages && S.isError ? (t(),
            i(_, {
                key: 0,
                class: "sm-cart-step__error",
                variant: "text-14"
            }, {
                default: d((()=>[u(r(S.messages.error), 1)])),
                _: 1
            })) : a("", !0), S.messages && S.isReset ? (t(),
            i(_, {
                key: 1,
                class: "sm-cart-step__error",
                variant: "text-14"
            }, {
                default: d((()=>[u(r(S.messages.reset), 1)])),
                _: 1
            })) : a("", !0), m.disabled ? a("", !0) : (t(),
            s("div", Ci, [I(o.$slots, "default")]))], 2)
}
]])
    , Ti = {
    name: "SmCertificateAttention",
    components: {
        SmImage: G,
        SmLink: Z
    },
    consts: {
        safetyCertIcon: "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2060%2060'%3e%3cpath%20fill='%23fff'%20d='M20.928%2010a8%208%200%200%201-8%208v2c0%201.403.061%202.772.18%204.1l.537%203.91C15.669%2038.823%2021.81%2046.377%2029.928%2048c10-2%2017-13%2017-28v-2a8%208%200%200%201-8-8h-18z'/%3e%3cpath%20fill='%23B5CAFF'%20d='m11.48%2039.596%204.699-3.32%203.305%205.316-2.638%201.421%201.014%202.131-7.357%204.211v-4.21l-1.81-1.102%203.884-2.45-1.096-1.997zm37.23%200-4.697-3.32-3.306%205.317%202.639%201.42-1.015%202.131%207.357%204.212v-4.212l1.81-1.1-3.884-2.451%201.097-1.997z'/%3e%3cellipse%20cx='30'%20cy='49'%20fill='%23B5CAFF'%20rx='11'%20ry='2'/%3e%3cpath%20stroke='%231551E5'%20stroke-linecap='round'%20stroke-width='1.5'%20d='M13.108%2024.1a45.967%2045.967%200%200%201-.18-4.1v-2a8%208%200%200%200%208-8h18a8%208%200%200%200%208%208v2c0%2015-7%2026-17%2028-8.118-1.624-14.26-9.178-16.283-19.99'/%3e%3cpath%20stroke='%231551E5'%20stroke-linecap='round'%20stroke-width='1.5'%20d='M23.956%2042.13c1.744%201.384%203.71%202.331%205.845%202.768%205.942-1.216%2010.595-6.394%2012.71-13.94m-21.578%208.04c-3.184-4.226-5.089-10.367-5.089-17.623v-.885a10.907%2010.907%200%200%200%207.558-7.516h13.01a10.949%2010.949%200%200%200%207.345%207.484v.917c0%201.973-.14%203.864-.41%205.657'/%3e%3cpath%20stroke='%23FF0016'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.5'%20d='m24.928%2028%204.5%203.5%206-6.5'/%3e%3cpath%20stroke='%231551E5'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.5'%20d='M14.919%2034.798c-1.099.615-3.472%202.198-4.352%203.033.704%201.45%202.286%204.351%203.649%206.813%201.01-.923%204.088-2.725%205.318-3.077'/%3e%3cpath%20stroke='%231551E5'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.5'%20d='M11.447%2039.72%206.61%2043.019l4%202.11v4.395l7.21-4.176-.968-2.33m.925%202.329-3.575-.705m30.879-9.844c1.1.615%203.473%202.198%204.352%203.033-.703%201.45-2.286%204.351-3.648%206.813-1.011-.923-4.088-2.725-5.319-3.077'/%3e%3cpath%20stroke='%231551E5'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.5'%20d='m48.554%2039.72%204.835%203.298-4%202.11v4.395l-7.209-4.176.967-2.33m-.923%202.33%203.574-.705'/%3e%3c/svg%3e"
    }
}
    , vi = {
    class: "sm-certificate-attention"
}
    , Ei = {
    class: "sm-certificate-attention__content"
}
    , Ii = n("p", {
    class: "sm-certificate-attention__text"
}, " Для стабильной работы вам потребуются сертификаты Минцифры ", -1);
const gi = B(Ti, [["render", function(i, a, r, l, c, m) {
    const p = e("SmImage")
        , h = e("SmLink");
    return t(),
        s("div", vi, [o(p, {
            class: "sm-certificate-attention__icon",
            width: "60",
            height: "60",
            src: i.$options.consts.safetyCertIcon
        }, null, 8, ["src"]), n("div", Ei, [Ii, o(h, {
            class: "sm-certificate-attention__link",
            href: "https://www.gosuslugi.ru/crt",
            target: "_blank",
            color: "darkblue",
            underline: "none"
        }, {
            default: d((()=>[u(" Установить сертификат сейчас ")])),
            _: 1
        })])])
}
]])
    , Ai = {
    CASH_TO_COURIER: {
        title: "При получении",
        description: "Только наличными",
        note: "По вашему заказу требуется предоплата на сайте"
    },
    TO_COURIER: {
        title: "При получении",
        description: "Наличными или картой",
        note: "По вашему заказу требуется предоплата на сайте"
    },
    IN_STORE: {
        title: "При получении",
        description: "Наличными или картой",
        note: "По вашему заказу требуется предоплата на сайте"
    },
    CASHLESS: {
        title: "Безналичный расчёт",
        description: "Только для юридических лиц"
    },
    CREDIT: {
        title: "В кредит от СберБанка",
        description: "От партнера ПАО «Сбербанк»"
    },
    INSTALLMENT: {
        title: "Беспроцентная рассрочка",
        description: "От партнера ПАО «Сбербанк»"
    },
    CARD_ONLINE: {
        title: "Онлайн на сайте",
        description: "Быстро и удобно"
    },
    EGC_ONLINE: {
        title: "Онлайн на сайте",
        description: "Быстро и удобно"
    },
    ONLINE: {
        title: "Онлайн на сайте",
        description: "Быстро и удобно"
    },
    CASH_TO_EXT_STORE: {
        title: "При получении",
        description: "Только наличными",
        note: "По вашему заказу требуется предоплата на сайте"
    },
    TO_EXT_STORE: {
        title: "При получении",
        description: "Наличными или картой",
        note: "По вашему заказу требуется предоплата на сайте"
    },
    BNPL_SOVCOMBANK: {
        title: "Оплатить ПЛАЙТ",
        description: "Покупай сейчас, плати потом"
    },
    CREDIT_DIRECT_CREDIT: {
        title: "Оплатить в кредит"
    },
    INSTALLMENT_DIRECT_CREDIT: {
        title: "Оплатить в рассрочку"
    },
    BNPL_TINKOFF: {
        title: "Долями",
        description: "Оплата покупок частями"
    }
}
    , fi = {
    name: "SmPaymentType",
    components: {
        SmText: U,
        SmImage: G,
        SmButton: F
    },
    props: {
        type: {
            type: String,
            require: !0,
            validator: e=>xt[e]
        },
        modelValue: {
            type: String,
            default: ""
        },
        disabled: {
            type: Boolean,
            default: !1
        },
        details: {
            type: String
        }
    },
    emits: ["change", "update:modelValue"],
    computed: {
        checked() {
            const {type: e, modelValue: t} = this;
            return e === t
        },
        messages() {
            const {type: e} = this;
            return Ai[e]
        },
        icon() {
            var e;
            const {type: t} = this;
            return null == (e = xt[t]) ? void 0 : e.icon
        }
    },
    methods: {
        ...h(["SHOW_GLOBAL_DIALOG"]),
        onChange() {
            const {type: e} = this;
            this.$emit("change", e),
                this.$emit("update:modelValue", e)
        },
        showDetailsDialog() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmStaticContentDialog",
                data: {
                    staticContent: this.details
                },
                woMobileNav: !0
            })
        }
    }
}
    , ki = ["checked", "disabled"]
    , bi = {
    key: 0,
    class: "sm-payment-type__content"
}
    , Ri = {
    class: "sm-payment-type__content-info"
};
const Li = B(fi, [["render", function(l, m, p, h, S, _) {
    const C = e("SmImage")
        , y = e("SmText")
        , T = e("SmButton");
    return t(),
        s("label", {
            class: c(["sm-payment-type", {
                "sm-payment-type--checked": _.checked,
                "sm-payment-type--disabled": p.disabled
            }])
        }, [n("input", {
            class: "sm-payment-type__input",
            type: "radio",
            checked: _.checked,
            disabled: p.disabled,
            onChange: m[0] || (m[0] = (...e)=>_.onChange && _.onChange(...e))
        }, null, 40, ki), _.messages ? (t(),
            s("span", bi, [_.icon ? (t(),
                i(C, {
                    key: 0,
                    class: "sm-payment-type__content-icon",
                    src: _.icon,
                    alt: _.messages.title
                }, null, 8, ["src", "alt"])) : a("", !0), n("span", Ri, [o(y, {
                class: "sm-payment-type__content-title",
                variant: "text-14",
                family: "medium"
            }, {
                default: d((()=>[u(r(_.messages.title), 1)])),
                _: 1
            }), _.messages.note ? (t(),
                i(y, {
                    key: 0,
                    class: "sm-payment-type__content-note",
                    variant: "text-12"
                }, {
                    default: d((()=>[u(r(_.messages.note), 1)])),
                    _: 1
                })) : a("", !0), o(y, {
                class: "sm-payment-type__content-description",
                variant: "text-12"
            }, {
                default: d((()=>[u(r(_.messages.description), 1)])),
                _: 1
            }), p.details ? (t(),
                i(T, {
                    key: 1,
                    class: "sm-payment-type__content-details-button",
                    color: "transparent-blue",
                    size: "xxs",
                    onClick: _.showDetailsDialog
                }, {
                    default: d((()=>[u(" Подробнее ")])),
                    _: 1
                }, 8, ["onClick"])) : a("", !0)])])) : a("", !0)], 2)
}
], ["__scopeId", "data-v-e0159519"]])
    , Di = {
    [xt.CASH_TO_COURIER.name]: !0,
    [xt.TO_COURIER.name]: !0,
    [xt.IN_STORE.name]: !0,
    [xt.CASHLESS.name]: !0,
    [xt.CARD_ONLINE.name]: !0,
    [xt.EGC_ONLINE.name]: !0,
    [xt.ONLINE.name]: !0,
    [xt.CASH_TO_EXT_STORE.name]: !0,
    [xt.TO_EXT_STORE.name]: !0,
    [xt.INSTALLMENT.name]: !0,
    [xt.CREDIT.name]: !0,
    [xt.BNPL_SOVCOMBANK.name]: !0,
    [xt.CREDIT_DIRECT_CREDIT.name]: !0,
    [xt.INSTALLMENT_DIRECT_CREDIT.name]: !0,
    [xt.BNPL_TINKOFF.name]: !0
}
    , Oi = {
    class: "sm-cart-payment-types-list"
};
const Pi = B({
    name: "SmCartPaymentTypesList",
    components: {
        SmPaymentType: Li
    },
    props: {
        modelValue: {
            type: String,
            default: null
        },
        values: {
            type: Array,
            default: ()=>[]
        }
    },
    emits: ["change", "update:modelValue"],
    data() {
        return {
            value: this.modelValue
        }
    },
    computed: {
        availableValues() {
            return this.values.filter((e=>!!Di[e.paymentMethod]))
        },
        list() {
            return this.availableValues.map((e=>(e.disabled = !e.isAvailable,
                e.online = (e=>{
                        switch (e) {
                            case xt.ONLINE.name:
                            case xt.CARD_ONLINE.name:
                            case xt.EGC_ONLINE.name:
                                return !0;
                            default:
                                return !1
                        }
                    }
                )(e.paymentMethod),
                e))).sort(((e,t)=>Number(e.disabled) - Number(t.disabled) || Number(t.online) - Number(e.online)))
        }
    },
    watch: {
        modelValue(e) {
            this.value = e
        }
    },
    methods: {
        onChange(e) {
            this.$emit("change", e),
                this.$emit("update:modelValue", e)
        }
    }
}, [["render", function(a, o, n, r, c, m) {
    const d = e("SmPaymentType");
    return t(),
        s("div", Oi, [(t(!0),
            s(l, null, T(m.list, (e=>(t(),
                i(d, {
                    key: e.paymentMethod,
                    modelValue: c.value,
                    "onUpdate:modelValue": o[0] || (o[0] = e=>c.value = e),
                    "data-selenium": e.paymentMethod,
                    class: "payment-method",
                    type: e.paymentMethod,
                    details: e.description,
                    disabled: e.disabled,
                    onChange: m.onChange
                }, null, 8, ["modelValue", "data-selenium", "type", "details", "disabled", "onChange"])))), 128))])
}
], ["__scopeId", "data-v-5f35836a"]]);
m('<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="ic-profile-personal-afforts"><path fill="currentColor" d="M16.874 4.269a2.75 2.75 0 0 1 .112 2.982L19 7.25a.75.75 0 0 1 .743.648L19.75 8v4a.75.75 0 0 1-.648.743L19 12.75h-.25V19a.75.75 0 0 1-.648.743L18 19.75H6a.75.75 0 0 1-.743-.648L5.25 19v-6.25H5a.75.75 0 0 1-.743-.648L4.25 12V8a.75.75 0 0 1 .648-.743L5 7.25h2.452a2.75 2.75 0 0 1 3.942-3.657c.323.226.595.559.826 1 .229-.441.501-.774.824-1a2.75 2.75 0 0 1 3.83.676M18.25 8.75H5.75v2.5H12v1.5H6.75v5.5h10.5v-5.5H15v-1.5h3.25zM8.793 5.129a1.25 1.25 0 0 0 .307 1.74c.314.22 1.07.276 2.226.105l.082-.014-.067-.32c-.21-.926-.472-1.518-.74-1.764l-.067-.054a1.25 1.25 0 0 0-1.741.307m5.111-.307-.067.054c-.269.246-.53.838-.74 1.764l-.067.32.082.014c1.157.17 1.912.116 2.226-.104a1.25 1.25 0 1 0-1.434-2.048" /></symbol>', "ic-profile-personal-afforts");
const Ni = {
    name: "SmCheckoutGiftCardList",
    components: {
        SmSvgIcon: $
    },
    consts: {
        successIcon: fe,
        spinnerIcon: ke
    },
    props: {
        cards: {
            type: Array,
            required: !0
        }
    },
    data: ()=>({
        pending: !1,
        error: !1
    }),
    methods: {
        ...h(["DELETE_GIFTCARD"]),
        nominal: e=>be(e),
        async deleteGiftCard(e) {
            this.error = !1,
                this.pending = !0;
            try {
                await this.DELETE_GIFTCARD(e)
            } catch (t) {
                this.error = !0,
                    console.error(t)
            } finally {
                this.pending = !1
            }
        }
    }
}
    , wi = {
    class: "sm-checkout-gift-card-list__item-wrap"
}
    , Mi = {
    class: "sm-checkout-gift-card-list__text"
}
    , Vi = ["disabled", "onClick"]
    , Bi = {
    key: 1,
    class: "sm-checkout-gift-card-list__error"
};
const xi = {
    name: "SmCheckoutGiftCard",
    components: {
        SmCheckoutGiftCardList: B(Ni, [["render", function(m, d, u, p, h, S) {
            const _ = e("SmSvgIcon");
            return t(),
                s("div", {
                    class: c(["sm-checkout-gift-card-list", {
                        "sm-checkout-gift-card-list--disabled": h.pending
                    }])
                }, [h.pending ? (t(),
                    i(_, {
                        key: 0,
                        class: "sm-checkout-gift-card-list__pending",
                        icon: m.$options.consts.spinnerIcon,
                        width: "20",
                        height: "20"
                    }, null, 8, ["icon"])) : a("", !0), (t(!0),
                    s(l, null, T(u.cards, (e=>(t(),
                        s("div", {
                            key: e.id,
                            class: "sm-checkout-gift-card-list__item"
                        }, [o(_, {
                            class: "sm-checkout-gift-card-list__icon",
                            icon: m.$options.consts.successIcon,
                            width: "20",
                            height: "20"
                        }, null, 8, ["icon"]), n("div", wi, [n("span", Mi, " Подарочная карта " + r(e.number) + " применена (" + r(S.nominal(e.nominal)) + ") ", 1), n("button", {
                            class: "sm-checkout-gift-card-list__button",
                            type: "button",
                            disabled: h.pending,
                            onClick: t=>S.deleteGiftCard(e.id)
                        }, " Удалить карту ", 8, Vi)])])))), 128)), h.error ? (t(),
                    s("span", Bi, " Непредвиденная ошибка. Обновите страницу и попробуйте еще раз. ")) : a("", !0)], 2)
        }
        ]]),
        SmButton: F,
        SmSvgIcon: $,
        SmMessage: J
    },
    consts: {
        giftboxIcon: "ic-profile-personal-afforts"
    },
    computed: {
        ...p(["CART_GIFTCARDS", "CART_GIFTCARDS_EXCESS", "CART_TOTAL"]),
        giftCardPluralText() {
            var e;
            return (null == (e = this.CART_GIFTCARDS) ? void 0 : e.length) ? Gt("ofGiftCard", this.CART_GIFTCARDS.length) : ""
        },
        excessStatusText() {
            const {CART_GIFTCARDS_EXCESS: e, CART_TOTAL: t} = this;
            switch (!0) {
                case e && 0 === (null == t ? void 0 : t.totalCost):
                    return `Номинал ${this.giftCardPluralText} превышает стоимость заказа и будет израсходован полностью. Вы можете добавить еще товары в корзину.`;
                case !e && 0 === (null == t ? void 0 : t.totalCost):
                    return "";
                case !e && 0 !== (null == t ? void 0 : t.totalCost):
                    return `Номинал ${this.giftCardPluralText} покрывает не всю стоимость заказа. Разницу необходимо будет доплатить банковской картой.`;
                default:
                    return ""
            }
        },
        excessStatusShown() {
            const {CART_GIFTCARDS: e, excessStatusText: t} = this;
            return (null == e ? void 0 : e.length) && t
        }
    },
    methods: {
        ...h(["SHOW_GLOBAL_DIALOG"]),
        showGiftCardDialog() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmGiftCardNumberDialog",
                mobileTitle: "ПОДАРОЧНАЯ КАРТА",
                woMobileNav: !0,
                options: {
                    theme: "inverted"
                }
            })
        }
    }
}
    , Gi = {
    class: "sm-checkout-gift-card"
};
const $i = {
    name: "SmCartStepPayment",
    components: {
        SmText: U,
        SmMessage: J,
        SmCartStep: yi,
        SmCertificateAttention: gi,
        SmCheckoutGiftCard: B(xi, [["render", function(n, l, c, m, p, h) {
            const S = e("SmCheckoutGiftCardList")
                , _ = e("SmSvgIcon")
                , C = e("SmButton")
                , y = e("SmMessage");
            return t(),
                s("div", Gi, [n.CART_GIFTCARDS && n.CART_GIFTCARDS.length ? (t(),
                    i(S, {
                        key: 0,
                        class: "sm-checkout-gift-card__applied",
                        cards: n.CART_GIFTCARDS
                    }, null, 8, ["cards"])) : a("", !0), o(C, {
                    color: "inverse-blue",
                    class: "sm-checkout-gift-card__button",
                    onClick: h.showGiftCardDialog
                }, {
                    default: d((()=>[o(_, {
                        icon: n.$options.consts.giftboxIcon,
                        width: "24",
                        height: "24",
                        class: "sm-checkout-gift-card__button-icon"
                    }, null, 8, ["icon"]), u(" Добавить подарочную карту ")])),
                    _: 1
                }, 8, ["onClick"]), h.excessStatusShown ? (t(),
                    i(y, {
                        key: 1
                    }, {
                        default: d((()=>[u(r(h.excessStatusText), 1)])),
                        _: 1
                    })) : a("", !0)])
        }
        ]]),
        SmCartPaymentTypesList: Pi,
        SmCartPaymentToolsList: Bt
    },
    props: {
        name: {
            type: String
        },
        error: {
            type: Boolean,
            default: !1
        },
        disabled: {
            type: Boolean,
            default: !1
        }
    },
    emits: ["payment-changed"],
    data: ()=>({
        isCertificateChecked: !1,
        selectedTab: ""
    }),
    computed: {
        ...p(["CART_IS_LEGAL_ENTITY", "CART_PAYMENT_VARIANTS", "CART_PAYMENT_TOOL_VARIANTS", "CART_SELECTED_PAYMENT", "CART_SELECTED_PAYMENT_TOOL", "CART_SELECTED_PAYMENT_EGC_COMPATIBILITY"]),
        ...p(Re, ["IS_CERTIFICATE_AVAILABLE"]),
        ...p(q, ["IS_ACTIVE"]),
        isPaymentOnline() {
            return Rt(this.CART_SELECTED_PAYMENT)
        },
        isNeedCheckCertificate() {
            return this.IS_ACTIVE("FT7251") && (Rt(this.CART_SELECTED_PAYMENT) && Lt(this.CART_SELECTED_PAYMENT_TOOL) || Dt(this.CART_SELECTED_PAYMENT))
        },
        isGiftCardShown() {
            const {CART_IS_LEGAL_ENTITY: e, CART_SELECTED_PAYMENT_EGC_COMPATIBILITY: t} = this;
            return !e && t
        }
    },
    watch: {
        isNeedCheckCertificate: {
            handler(e) {
                e && !this.isCertificateChecked && (this.CHECK_CERTIFICATE(),
                    this.isCertificateChecked = !0)
            },
            immediate: !0
        }
    },
    methods: {
        ...h(["CHANGE_PAYMENT_TYPE", "CHANGE_CART_PENDING", "CHANGE_PAYMENT_TOOL"]),
        ...h(Re, ["CHECK_CERTIFICATE"]),
        async onPaymentTypeChange(e) {
            this.CHANGE_CART_PENDING(!0);
            try {
                await this.CHANGE_PAYMENT_TYPE(e),
                    this.$emit("payment-changed", e)
            } finally {
                this.CHANGE_CART_PENDING(!1)
            }
        },
        async onPaymentToolChange(e) {
            this.CHANGE_CART_PENDING(!0);
            try {
                await this.CHANGE_PAYMENT_TOOL(e)
            } finally {
                this.CHANGE_CART_PENDING(!1)
            }
        }
    }
}
    , Ui = {
    class: "sm-cart-step-payment__content"
};
const Yi = B($i, [["render", function(r, c, m, p, h, S) {
    const _ = e("SmCartPaymentTypesList")
        , C = e("SmText")
        , y = e("SmCartPaymentToolsList")
        , T = e("SmCertificateAttention")
        , v = e("SmMessage")
        , E = e("SmCheckoutGiftCard")
        , I = e("SmCartStep");
    return t(),
        i(I, {
            class: "sm-cart-step-payment",
            title: "Способ оплаты",
            name: m.name,
            disabled: m.disabled
        }, {
            default: d((()=>[n("div", Ui, [o(_, {
                values: r.CART_PAYMENT_VARIANTS,
                "model-value": r.CART_SELECTED_PAYMENT,
                onChange: S.onPaymentTypeChange
            }, null, 8, ["values", "model-value", "onChange"]), S.isPaymentOnline ? (t(),
                s(l, {
                    key: 0
                }, [o(C, {
                    class: "sm-cart-step-payment__title",
                    variant: "text-16",
                    tag: "div",
                    family: "medium"
                }, {
                    default: d((()=>[u(" Мы принимаем ")])),
                    _: 1
                }), o(y, {
                    values: r.CART_PAYMENT_TOOL_VARIANTS,
                    "model-value": r.CART_SELECTED_PAYMENT_TOOL,
                    onChange: S.onPaymentToolChange
                }, null, 8, ["values", "model-value", "onChange"])], 64)) : a("", !0), !r.IS_CERTIFICATE_AVAILABLE && S.isNeedCheckCertificate ? (t(),
                i(T, {
                    key: 1,
                    "data-test-id": "certificate-attention"
                })) : a("", !0), m.error ? (t(),
                i(v, {
                    key: 2,
                    type: "warning",
                    class: "sm-cart-step-payment__error"
                }, {
                    default: d((()=>[u(" Пожалуйста, выберите способ оплаты ")])),
                    _: 1
                })) : a("", !0)]), S.isGiftCardShown ? (t(),
                i(E, {
                    key: 0,
                    class: "sm-cart-step-payment__gift-card"
                })) : a("", !0)])),
            _: 1
        }, 8, ["name", "disabled"])
}
]]);
m('<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="ic-express-delivery-copy"><path fill="currentColor" fill-rule="evenodd" d="M2.004 10.805c.9-.74 2.286-.753 3.153.163.825.87.842 2.155.088 3.074-.248.303-.663.538-1.095.738q-.698.322-1.843.7l-.016.006c-.36.12-.637.212-.831.245a1 1 0 0 1-.493-.025.95.95 0 0 1-.387-.242c-.044-.044-.174-.174-.242-.386a1 1 0 0 1-.025-.495c.034-.193.126-.469.246-.828l.007-.022c.254-.76.485-1.373.701-1.837.2-.43.434-.843.737-1.09zM14.55.25a5 5 0 0 1 .367.02c.024.003.114.014.21.05a.98.98 0 0 1 .576.575c.08.21.09.43.09.598 0 1.925-.735 4.145-1.936 5.948-.474.716-.842 1.163-1.48 1.813l-.205.208-.002.044c-.067 1.324-.553 2.775-1.31 3.92a9 9 0 0 1-.673.898 4 4 0 0 1-.32.34 2 2 0 0 1-.174.144 1 1 0 0 1-.284.15c-.408.134-.922.008-1.195-.401a.9.9 0 0 1-.104-.221 2 2 0 0 1-.033-.123 5 5 0 0 1-.052-.265 36 36 0 0 1-.14-.916l-.023-.158a1 1 0 0 1-.264-.061.8.8 0 0 1-.234-.137 8 8 0 0 1-.216-.196c-.117-.11-.275-.264-.46-.444a184 184 0 0 1-3.105-3.118 8 8 0 0 1-.199-.218l-.036-.045c-.008-.012-.044-.06-.076-.126l-.005-.01a1 1 0 0 1-.096-.341l-.184-.027-.027-.004-.038-.007a33 33 0 0 1-.557-.097c-.154-.028-.318-.06-.452-.09a3 3 0 0 1-.196-.049 1 1 0 0 1-.111-.037c-.024-.009-.134-.05-.24-.139a.94.94 0 0 1-.3-.443 1 1 0 0 1-.043-.327v-.042a.92.92 0 0 1 .166-.519c.079-.113.195-.226.281-.308l.021-.02C2.812 4.799 4.73 3.962 6.538 3.87l.042-.002.207-.204c.481-.473.742-.705 1.17-1.027 1.81-1.365 3.92-2.2 6.054-2.37.162-.014.37-.018.539-.017M2.858 12.094c-.063.098-.14.24-.23.434-.162.348-.37.846-.584 1.472a15 15 0 0 0 1.475-.581c.195-.09.338-.168.437-.232.397-.255.432-.85.113-1.187-.323-.34-.951-.309-1.21.094zm11.43-10.341-.152.008c-1.831.147-3.676.867-5.276 2.074-.36.271-.57.455-1.02.897l-.613.606-.614.03c-1.194.06-2.48.54-3.49 1.285l.044.008.042.007 2.531.367-.902 1.025.266.273c.24.244.53.539.84.85l.473.473a184 184 0 0 0 1.568 1.549l1.023-.901.362 2.514.014.102a8 8 0 0 0 .224-.32c.615-.93 1.01-2.124 1.064-3.17l.03-.614.605-.613c.577-.587.883-.962 1.3-1.592 1.008-1.512 1.618-3.325 1.682-4.858zM11.045 3.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3" /></symbol>', "ic-express-delivery-copy");
const Fi = {
    class: "sm-cart-delivery-types"
}
    , Hi = ["data-test-id", "onClick"]
    , ji = {
    class: "sm-cart-delivery-types__item-title"
}
    , qi = {
    class: "sm-cart-delivery-types__item-info"
};
const Wi = B({
    name: "SmCartDeliveryTypes",
    components: {
        SmCost: Kt,
        SmSvgIcon: $,
        SmAvailableGoodsText: Xt
    },
    props: {
        deliveryTypes: {
            type: Array,
            default: ()=>[]
        },
        selectedTypeCode: {
            type: String
        }
    },
    emits: ["select"],
    consts: {
        expressDeliveryIcon: "ic-express-delivery-copy",
        DELIVERY_TYPES: Le
    },
    methods: {
        isExpressDeliveryType: ({deliveryServiceLevelCode: e})=>e === Le.EXPRESS,
        isSelected({deliveryServiceLevelCode: e}) {
            return this.selectedTypeCode === e
        },
        selectDeliveryType(e) {
            this.isSelected(e) || this.$emit("select", e)
        }
    }
}, [["render", function(m, d, u, p, h, S) {
    const _ = e("SmSvgIcon")
        , C = e("SmAvailableGoodsText")
        , y = e("SmCost");
    return t(),
        s("div", Fi, [(t(!0),
            s(l, null, T(u.deliveryTypes, (e=>(t(),
                s("button", {
                    key: e.deliveryServiceLevelCode,
                    "data-test-id": e.deliveryServiceLevelCode,
                    class: c(["sm-cart-delivery-types__item", {
                        "sm-cart-delivery-types__item--selected": S.isSelected(e)
                    }]),
                    onClick: t=>S.selectDeliveryType(e)
                }, [n("span", ji, [n("span", null, r(e.title), 1), S.isExpressDeliveryType(e) ? (t(),
                    i(_, {
                        key: 0,
                        class: "sm-cart-delivery-types__item-icon",
                        icon: m.$options.consts.expressDeliveryIcon,
                        width: 16,
                        height: 16
                    }, null, 8, ["icon"])) : a("", !0)]), n("span", qi, [e.available ? (t(),
                    i(C, {
                        key: 0,
                        class: "sm-cart-delivery-types__item-total",
                        total: e.total,
                        available: e.available,
                        "is-colorless": ""
                    }, null, 8, ["total", "available"])) : a("", !0), o(y, {
                    class: "sm-cart-delivery-types__item-delivery-cost",
                    value: e.cost,
                    exact: e.exact,
                    family: "regular"
                }, null, 8, ["value", "exact"])])], 10, Hi)))), 128))])
}
]])
    , zi = {
    name: "SmCartServicesItem",
    components: {
        SmCheckbox: H,
        SmDialogPopover: Zt,
        SmSvgIcon: $
    },
    props: {
        disabled: {
            type: Boolean,
            default: !1
        },
        name: {
            type: String
        },
        description: {
            type: String
        },
        shortDescription: {
            type: String
        },
        price: {
            type: Number
        },
        modelValue: {
            type: Boolean,
            required: !0
        },
        items: {
            type: Array,
            default: ()=>[]
        },
        linkedInOtherService: {
            type: Boolean,
            default: !1
        }
    },
    consts: {
        icAttentionIcon: De
    },
    emits: ["update:modelValue"],
    computed: {
        priceWithCurrency() {
            return be(Math.abs(this.price))
        },
        isSelected: {
            get() {
                return this.modelValue
            },
            set(e) {
                this.$emit("update:modelValue", e)
            }
        },
        showShortDescription() {
            return this.items.length ? !!this.shortDescription : this.linkedInOtherService
        }
    }
}
    , Qi = {
    class: "sm-cart-services-item"
}
    , Ki = {
    class: "sm-cart-services-item__wrapper"
}
    , Xi = {
    class: "sm-cart-services-item__name-wrapper"
}
    , Zi = {
    key: 0,
    class: "sm-cart-services-item__name"
}
    , Ji = {
    class: "sm-cart-services-item__popover-hint"
}
    , ea = {
    class: "sm-cart-services-item__popover-hint-name"
}
    , ta = {
    class: "sm-cart-services-item__popover-hint-description"
}
    , sa = {
    key: 1,
    class: "sm-cart-services-item__short-description"
}
    , ia = {
    key: 0,
    class: "sm-cart-services-item__price"
};
const aa = {
    name: "SmCartServices",
    components: {
        SmCartServicesItem: B(zi, [["render", function(l, c, m, u, p, h) {
            const S = e("SmCheckbox")
                , _ = e("SmSvgIcon")
                , C = e("SmDialogPopover");
            return t(),
                s("li", Qi, [o(S, {
                    modelValue: h.isSelected,
                    "onUpdate:modelValue": c[0] || (c[0] = e=>h.isSelected = e),
                    disabled: m.disabled
                }, null, 8, ["modelValue", "disabled"]), n("div", Ki, [n("div", Xi, [m.name ? (t(),
                    s("span", Zi, [n("span", null, r(m.name), 1), m.description ? (t(),
                        i(C, {
                            key: 0,
                            class: "sm-cart-services-item__popover",
                            color: "black",
                            "wo-close-btn-laptop": "",
                            "wo-mobile-nav": ""
                        }, {
                            target: d((()=>[o(_, {
                                class: "sm-cart-services-item__popover-target",
                                icon: l.$options.consts.icAttentionIcon,
                                width: "16",
                                height: "16"
                            }, null, 8, ["icon"])])),
                            popper: d((()=>[n("div", Ji, [n("span", ea, r(m.name), 1), n("span", ta, r(m.description), 1)])])),
                            _: 1
                        })) : a("", !0)])) : a("", !0), h.showShortDescription ? (t(),
                    s("span", sa, r(m.shortDescription), 1)) : a("", !0)]), m.price ? (t(),
                    s("span", ia, r(h.priceWithCurrency), 1)) : a("", !0)])])
        }
        ]])
    },
    emits: ["input"],
    data: ()=>({
        modelServices: []
    }),
    computed: {
        ...p(["CART_DELIVERY_SERVICES"]),
        selectedCount() {
            return this.modelServices.reduce(((e,t)=>{
                    if (t.isOrderService)
                        return t.isSelected ? e + 1 : e;
                    return e + t.items.filter((e=>e.isSelected)).length
                }
            ), 0)
        },
        servicesByLinkedIdInOtherServices() {
            return this.modelServices.reduce(((e,t)=>(e[t.id] = !!this.modelServices.find((e=>e.linkedServiceIds.includes(t.id))),
                e)), {})
        }
    },
    watch: {
        CART_DELIVERY_SERVICES: {
            handler(e) {
                this.modelServices = this.adaptedServices(A(e))
            },
            immediate: !0,
            deep: !0
        }
    },
    methods: {
        adaptedServices(e=[]) {
            let t = 0;
            return e.map((e=>{
                    var s;
                    return null == (s = e.items) || s.forEach(((s,i)=>{
                            s.uniqId = `${e.id}-${s.wareId}-${t}`,
                                s.uniqWareIdService = `${s.wareId}-${i}`,
                                t += 1
                        }
                    )),
                        e
                }
            ))
        },
        getSelectedItemsLinkedWithCurrentService: (e,t)=>t.reduce(((t,s)=>{
                const i = s.items.filter((e=>e.isSelected));
                return i.length && s.linkedServiceIds.includes(e) ? (t.push(...i),
                    t) : t
            }
        ), []),
        onChange(e, t, s) {
            const i = this.modelServices.filter((e=>!e.isOrderService))
                , a = (e,s,i,a)=>{
                    if (e.isOrderService)
                        this.$nextTick((()=>{
                                0 === this.getSelectedItemsLinkedWithCurrentService(e.id, i).length && (e.disabled = !1,
                                e.programmaticallySet && (e.isSelected = !1,
                                    e.programmaticallySet = !1))
                            }
                        ));
                    else {
                        const s = e.items.find((e=>e.uniqWareIdService === t.uniqWareIdService && e.isSelected));
                        s && a && (s.disabled = !1,
                        s.programmaticallySet && (s.isSelected = !1,
                            s.programmaticallySet = !1))
                    }
                }
            ;
            this.modelServices.forEach((o=>{
                    const n = e.linkedServiceIds.includes(o.id);
                    t && (s ? n && ((e,t)=>{
                            e.isOrderService ? (e.isSelected || (e.isSelected = !0,
                                e.programmaticallySet = !0),
                                e.disabled = !0) : e.items.forEach((e=>{
                                    e.uniqWareIdService === t.uniqWareIdService && (e.isSelected || (e.isSelected = !0,
                                        e.programmaticallySet = !0),
                                        e.disabled = !0)
                                }
                            ))
                        }
                    )(o, t) : a(o, 0, i, n))
                }
            )),
                this.setServices()
        },
        setServices() {
            this.$emit("input", this.modelServices)
        }
    }
}
    , oa = {
    class: "sm-cart-services"
}
    , na = {
    class: "sm-cart-services__title"
}
    , ra = {
    key: 0,
    class: "sm-cart-services__title-count"
}
    , la = {
    class: "sm-cart-services__items"
};
const ca = B(aa, [["render", function(o, c, m, d, p, h) {
    const S = e("SmCartServicesItem");
    return t(),
        s("section", oa, [n("span", na, [u(" Услуги "), h.selectedCount > 0 ? (t(),
            s("span", ra, r(h.selectedCount), 1)) : a("", !0)]), n("ul", la, [(t(!0),
            s(l, null, T(p.modelServices, (e=>(t(),
                s(l, {
                    key: e.id
                }, [e.isOrderService ? (t(),
                    i(S, {
                        key: 0,
                        modelValue: e.isSelected,
                        "onUpdate:modelValue": [t=>e.isSelected = t, t=>h.onChange(e, null, t)],
                        name: e.name,
                        disabled: e.disabled,
                        description: e.description,
                        "short-description": e.shortDescription,
                        price: e.price,
                        items: e.items,
                        "linked-in-other-service": h.servicesByLinkedIdInOtherServices[e.id]
                    }, null, 8, ["modelValue", "onUpdate:modelValue", "name", "disabled", "description", "short-description", "price", "items", "linked-in-other-service"])) : (t(!0),
                    s(l, {
                        key: 1
                    }, T(e.items, (s=>(t(),
                        i(S, {
                            key: s.uniqId,
                            modelValue: s.isSelected,
                            "onUpdate:modelValue": [e=>s.isSelected = e, t=>h.onChange(e, s, t)],
                            name: e.name,
                            description: e.description,
                            "short-description": s.name,
                            price: e.price,
                            items: e.items,
                            disabled: s.disabled
                        }, null, 8, ["modelValue", "onUpdate:modelValue", "name", "description", "short-description", "price", "items", "disabled"])))), 128))], 64)))), 128))])])
}
]])
    , ma = ["FAILED_TO_ADD_SERVICES", "FAILED_TO_REMOVE_SERVICES"]
    , da = {
    name: "SmCheckoutDeliveryDate",
    props: {
        value: {
            type: Object,
            required: !0
        }
    },
    computed: {
        ...p(["LANG", "NOW"]),
        formattedDate() {
            const {date: e, isMoreThanDay: t} = Oe({
                availabilityDate: this.value.receivingDateFrom,
                availabilityDateTo: this.value.receivingDateTo,
                lang: this.LANG,
                currentTime: this.NOW,
                formatToDateTime: !1
            });
            return {
                date: e,
                isMoreThanDay: t
            }
        },
        weekDay() {
            return Pe({
                value: this.value.receivingDateFrom,
                token: "EEEEEE",
                base: this.NOW
            })
        },
        date() {
            return this.formattedDate.isMoreThanDay ? new Date(this.value.receivingDateFrom).getMonth() !== new Date(this.value.receivingDateTo).getMonth() ? {
                date: [Pe({
                    value: this.value.receivingDateFrom,
                    token: "d MMMM",
                    base: this.NOW
                }).toLowerCase(), Pe({
                    value: this.value.receivingDateTo,
                    token: "d MMMM",
                    base: this.NOW
                }).toLowerCase()],
                type: "month_diff"
            } : {
                date: [[Pe({
                    value: this.value.receivingDateFrom,
                    token: "d",
                    base: this.NOW
                }), Pe({
                    value: this.value.receivingDateTo,
                    token: "d",
                    base: this.NOW
                })].join(" - "), Pe({
                    value: this.value.receivingDateFrom,
                    token: "MMMM",
                    base: this.NOW
                }).toLowerCase()],
                type: "diff_day"
            } : {
                date: this.formattedDate.date,
                type: "single"
            }
        }
    }
}
    , ua = {
    class: "sm-checkout-delivery-date"
}
    , pa = {
    class: "sm-checkout-delivery-date__value"
}
    , ha = {
    key: 1
}
    , Sa = {
    key: 0,
    class: "sm-checkout-delivery-date__value"
}
    , _a = {
    key: 1,
    class: "sm-checkout-delivery-date__sub"
};
const Ca = B(da, [["render", function(e, i, o, c, m, d) {
    return t(),
        s("button", ua, [n("span", pa, ["single" === d.date.type ? (t(),
            s(l, {
                key: 0
            }, [u(r(d.formattedDate.date), 1)], 64)) : (t(),
            s("span", ha, r(d.date.date[0]) + " " + r("month_diff" === d.date.type ? "-" : ""), 1))]), "single" !== d.date.type && 2 === d.date.date.length ? (t(),
            s("span", Sa, r(d.date.date[1]), 1)) : a("", !0), d.formattedDate.isMoreThanDay || "single" !== d.date.type ? a("", !0) : (t(),
            s("span", _a, r(d.weekDay), 1))])
}
]])
    , ya = {
    __name: "SmCheckoutDeliveryClickTooltip",
    props: {
        hints: {
            type: Object,
            default: ()=>({})
        }
    },
    setup: e=>(s,a)=>(t(),
        i(f(jt), {
            "wo-mobile-nav": "",
            skidding: -12,
            hints: e.hints,
            placement: "bottom-start",
            container: "body",
            "tooltip-class": "sm-checkout-delivery-click-tooltip__tooltip-popper"
        }, null, 8, ["hints"]))
}
    , Ta = {
    class: "sm-checkout-delivery-time__value"
}
    , va = {
    __name: "SmCheckoutDeliveryTime",
    props: {
        value: {
            type: String,
            default: null
        },
        serviceLevelCode: {
            type: String,
            default: null
        },
        hints: {
            type: Object,
            default: ()=>({})
        },
        cost: {
            type: Number,
            default: -1
        }
    },
    setup(e) {
        const o = e
            , l = k((()=>o.serviceLevelCode === Le.CLICK))
            , m = k((()=>l.value ? "По клику" : o.value))
            , d = k((()=>{
                if (!l.value)
                    return {};
                const {checkRequiredHints: e, getFormattedHints: t} = qt();
                return e({
                    hints: o.hints
                }) ? t({
                    hints: o.hints
                }) : {}
            }
        ))
            , p = k((()=>l.value && Object.keys(d.value).length > 0));
        return (o,h)=>(t(),
            s("button", {
                class: c(["sm-checkout-delivery-time", [l.value && "sm-checkout-delivery-time--by-click"]])
            }, [n("span", Ta, [u(r(m.value) + " ", 1), p.value ? (t(),
                i(f(ya), {
                    key: 0,
                    class: "sm-checkout-delivery-time__tooltip",
                    hints: d.value
                }, null, 8, ["hints"])) : a("", !0)]), e.cost >= 0 ? (t(),
                i(f(Kt), {
                    key: 0,
                    class: "sm-checkout-delivery-time__sub",
                    value: e.cost,
                    family: "regular",
                    exact: ""
                }, null, 8, ["value"])) : a("", !0)], 2))
    }
}
    , Ea = {
    name: "SmCheckoutPickers",
    components: {
        SmSwiperNew: Jt,
        SmSwiperNewSlide: es,
        SmSvgIcon: $
    },
    consts: {
        arrowLeftIcon: ss,
        arrowRightIcon: ts
    },
    props: {
        name: {
            type: String,
            required: !0
        },
        options: {
            type: Array,
            default: ()=>[]
        },
        selectedOption: {
            type: Object,
            default: ()=>({})
        },
        long: Boolean
    },
    emits: ["change"],
    data() {
        return {
            parameters: {
                spaceBetween: 8,
                slidesPerView: "auto",
                slideToClickedSlide: !0,
                watchSlidesProgress: !0,
                threshold: 10,
                on: {
                    init: this.onSwiperMounted,
                    click: this.selectPicker
                }
            }
        }
    },
    watch: {
        options: {
            handler() {
                this.init(),
                    this.$nextTick((()=>{
                            var e;
                            (null == (e = this.$refs.swiper) ? void 0 : e.swiper) && this.$refs.swiper.swiper.update()
                        }
                    ))
            },
            deep: !0
        },
        selectedOption() {
            this.init()
        }
    },
    methods: {
        isSelected(e) {
            return v(e, this.selectedOption)
        },
        selectPicker(e) {
            const {clickedIndex: t} = e;
            void 0 !== t && this.$emit("change", this.options[t])
        },
        init() {
            if (this.options.length) {
                const e = this.options.findIndex((e=>this.isSelected(e)));
                -1 !== e && this.slideToActive(e, 0)
            }
        },
        onSwiperMounted() {
            this.init()
        },
        slideToActive(e, t) {
            var s;
            (null == (s = this.$refs.swiper) ? void 0 : s.swiper) && this.$refs.swiper.swiper.slideTo(e, t)
        }
    }
}
    , Ia = {
    class: "sm-checkout-pickers__icon"
}
    , ga = {
    class: "sm-checkout-pickers__icon"
};
const Aa = B(Ea, [["render", function(a, r, m, u, p, h) {
    const S = e("SmSvgIcon")
        , _ = e("SmSwiperNewSlide")
        , C = e("SmSwiperNew");
    return t(),
        i(C, {
            ref: "swiper",
            class: "sm-checkout-pickers",
            name: m.name,
            parameters: p.parameters,
            "has-navigation": "",
            "visible-nav": ""
        }, {
            prev: d((({activatorClass: e})=>[n("button", {
                type: "button",
                class: c(["sm-checkout-pickers__prev", e])
            }, [n("span", Ia, [o(S, {
                icon: a.$options.consts.arrowLeftIcon,
                width: "24",
                height: "24"
            }, null, 8, ["icon"])])], 2)])),
            next: d((({activatorClass: e})=>[n("button", {
                type: "button",
                class: c(["sm-checkout-pickers__next", e])
            }, [n("span", ga, [o(S, {
                icon: a.$options.consts.arrowRightIcon,
                width: "24",
                height: "24"
            }, null, 8, ["icon"])])], 2)])),
            default: d((()=>[(t(!0),
                s(l, null, T(m.options, ((e,s)=>(t(),
                    i(_, {
                        key: s,
                        class: c(["sm-checkout-pickers__item", {
                            "sm-checkout-pickers__item--long": m.long
                        }, {
                            "swiper-slide--selected": h.isSelected(e)
                        }, {
                            "swiper-slide--disabled": e.disabled
                        }])
                    }, {
                        default: d((()=>[I(a.$slots, "option", b(R(e)))])),
                        _: 2
                    }, 1032, ["class"])))), 128))])),
            _: 3
        }, 8, ["name", "parameters"])
}
]])
    , fa = {
    class: "sm-shipment-type-delivery-click-promo"
}
    , ka = {
    class: "sm-shipment-type-delivery-click-promo__content"
}
    , ba = n("span", {
    class: "sm-shipment-type-delivery-click-promo__highlight"
}, " доставка по клику ", -1)
    , Ra = {
    key: 0,
    class: "sm-shipment-type-delivery-click-promo__tooltip-wrapper"
}
    , La = e=>{
    const t = ["deliveryServiceLevelCode", "receivingTimeSlot"];
    return (null == e ? void 0 : e.deliveryServiceLevelCode) !== Le.EXPRESS && t.push("receivingDateFrom"),
        L(e, t)
}
    , Da = {
    name: "SmShipmentTypeDelivery",
    components: {
        SmSkeleton: Ne,
        SmCartServices: ca,
        SmMessage: J,
        SmServicesList: Ut,
        SmShipmentGoodsList: Yt,
        SmShipmentVariantInfo: Qt,
        SmCheckoutSelectedBlank: ti,
        SmCartDeliveryTypes: Wi,
        SmCheckoutPickers: Aa,
        SmCheckoutDeliveryDate: Ca,
        SmCheckoutDeliveryTime: va,
        SmShipmentTypeDeliveryClickPromo: {
            __name: "SmShipmentTypeDeliveryClickPromo",
            props: {
                date: {
                    type: String,
                    required: !0
                },
                hints: {
                    type: Object,
                    default: ()=>({})
                }
            },
            setup(e) {
                const i = e
                    , l = k((()=>Object.keys(i.hints).length > 0))
                    , c = k((()=>["Сегодня", "Завтра"].includes(i.date) ? i.date : `С ${i.date}`));
                return (i,m)=>(t(),
                    s("div", fa, [n("span", ka, [u(r(c.value) + " возможна ", 1), ba]), l.value ? (t(),
                        s("div", Ra, [o(f(ya), {
                            hints: e.hints
                        }, null, 8, ["hints"])])) : a("", !0)]))
            }
        }
    },
    consts: {
        deliveryImage: Wt,
        TITLES: {
            ordinary_delivery: "Дата и время доставки",
            delivery_click: "Дата и время доставки",
            express_delivery: "Время доставки"
        },
        ADDRESS_PREFIXES: {
            street: "",
            house: "д. ",
            houseBlock: "к. ",
            building: "ст. ",
            apartment: "кв. "
        }
    },
    props: {
        data: {
            type: Object,
            default: ()=>({
                deliveryVariants: [],
                deliveryVariant: {}
            })
        },
        value: {
            type: Object,
            default: ()=>({})
        }
    },
    data() {
        return {
            selectedVariant: this.findSelectedVariant(this.data.deliveryVariant, this.data.deliveryVariants),
            selectedTypeCode: this.data.deliveryVariant.deliveryServiceLevelCode,
            loadingServices: !0
        }
    },
    computed: {
        ...p(["LANG", "NOW", "CART_ITEMS", "CART_TOTAL", "CART_DELIVERY_SERVICES"]),
        ...p(q, ["IS_ACTIVE"]),
        showDeliveryByClickPromo() {
            return this.isDeliveryClickActive && this.deliveryClickPromo && !this.isDeliveryByClickAvailableInCurrentDay
        },
        isDeliveryByClickAvailableInCurrentDay() {
            return -1 !== this.ordinaryTimes.findIndex((e=>e.deliveryServiceLevelCode === Le.CLICK))
        },
        deliveryClickMessage() {
            if (!this.isDeliveryClickActive || this.selectedVariant.deliveryServiceLevelCode !== Le.CLICK)
                return null;
            const e = this.selectedVariant.hints.find((({name: e})=>"delivery_time" === e));
            return e ? `Вызовите курьера, когда будете готовы принять заказ. Он приедет за ${e.value}` : null
        },
        deliveryClickPromo() {
            if (!this.isDeliveryClickActive)
                return null;
            const e = this.getFirstAvailableClickDeliveryVariant();
            if (!e || !e.hints)
                return null;
            const {hints: t} = e
                , {checkRequiredHints: s, getFormattedHints: i} = qt()
                , a = s({
                hints: t
            }) ? i({
                hints: t
            }) : {};
            return {
                date: this.promoDate,
                hints: a
            }
        },
        promoDate() {
            if (!this.isDeliveryClickActive)
                return null;
            const e = this.getFirstAvailableClickDeliveryVariant();
            return e ? we(e.receivingDateFrom, this.NOW) ? "Сегодня" : Me(e.receivingDateFrom, this.NOW) ? "Завтра" : e.receivingDateTo ? Ve({
                from: e.receivingDateFrom,
                to: e.receivingDateTo,
                base: this.NOW
            }).toLowerCase() : Pe({
                value: e.receivingDateFrom,
                token: "d MMM",
                base: this.NOW
            }).toLowerCase() : null
        },
        isDeliveryClickActive() {
            return this.IS_ACTIVE("FT5185")
        },
        variants() {
            return this.data.deliveryVariants
        },
        variant() {
            return this.data.deliveryVariant
        },
        enabledGeoFences() {
            return this.IS_ACTIVE("FT7481")
        },
        addressText() {
            var e;
            if (this.enabledGeoFences) {
                const t = (null == (e = this.data) ? void 0 : e.deliveryAddress) || {}
                    , {locationName: s=""} = t
                    , {apartment: i=""} = t;
                return i ? `${s}, кв. ${i}` : s
            }
            const {streetTypeShort: t, ...s} = this.data.address || {}
                , i = Object.entries(s).map((([e,t])=>{
                    const s = this.$options.consts.ADDRESS_PREFIXES;
                    return Object.keys(s).includes(e) ? `${s[e]}${t}` : null
                }
            )).filter(Boolean).join(", ");
            return t ? `${t} ${i}` : i
        },
        deliveryTypes() {
            const e = []
                , t = Be(this.CART_ITEMS);
            if (this.value.ordinaryDelivery) {
                const s = xe({
                    from: this.value.ordinaryDelivery.availabilityDate,
                    base: this.NOW,
                    lang: this.LANG
                })
                    , i = this.value.ordinaryDelivery.availabilityDateMax && this.value.ordinaryDelivery.availabilityDateMax !== this.value.ordinaryDelivery.availabilityDate ? `${s} или позже` : s;
                e.push({
                    deliveryServiceLevelCode: Le.ORDINARY,
                    title: i,
                    total: t,
                    available: this.value.ordinaryDelivery.itemsCountAvailable,
                    ...this.getTypeCost(this.value.ordinaryDelivery)
                })
            }
            return this.value.expressDelivery && e.push({
                deliveryServiceLevelCode: Le.EXPRESS,
                title: "Экспресс-доставка",
                total: t,
                available: this.value.expressDelivery.itemsCountAvailable,
                ...this.getTypeCost(this.value.expressDelivery)
            }),
                e
        },
        isExpress() {
            return this.selectedTypeCode === Le.EXPRESS
        },
        isOrdinary() {
            const e = [Le.ORDINARY];
            return this.isDeliveryClickActive && e.push(Le.CLICK),
                e.includes(this.selectedTypeCode)
        },
        hours() {
            const {deliveryHours: e} = this.variant;
            return e && `в течение ${e} ч.`
        },
        expressVariants() {
            return this.variants.filter((({deliveryServiceLevelCode: e, receivingTimeSlot: t})=>e === Le.EXPRESS && !!t))
        },
        ordinaryVariants() {
            const e = [Le.ORDINARY];
            return this.isDeliveryClickActive && e.push(Le.CLICK),
                this.variants.filter((({deliveryServiceLevelCode: t})=>e.includes(t)))
        },
        ordinaryDates() {
            const e = this.ordinaryVariants.reduce(((e,t)=>{
                    const s = this.getVariantKey(t);
                    return e[s] || (e[s] = []),
                        e[s].push(t),
                        e
                }
            ), {});
            return Object.values(e).map((e=>e.find((e=>e.receivingTimeSlot === this.variant.receivingTimeSlot)) || e[0]))
        },
        ordinaryTimes() {
            return this.ordinaryVariants.filter((e=>this.getVariantKey(e) === this.getVariantKey(this.selectedVariant)))
        },
        services() {
            return this.variant.specificServices || []
        }
    },
    watch: {
        variant: {
            handler(e) {
                this.selectedVariant = this.findSelectedVariant(e)
            }
        },
        selectedTypeCode: {
            handler(e, t) {
                e !== t && (this.selectedVariant = this.variants.find((t=>t.deliveryServiceLevelCode === e)) || {})
            }
        },
        selectedVariant: {
            async handler(e, t) {
                v(La(e), La(t)) || (this.CHANGE_CART_PENDING(!0),
                    await this.SET_DELIVERY_VARIANT(e),
                    this.CHANGE_CART_PENDING(!1))
            },
            deep: !0
        },
        addressText() {
            this.selectedTypeCode = Le.ORDINARY
        }
    },
    methods: {
        ...h(["SET_DELIVERY_VARIANT", "CHANGE_CART_PENDING", "FETCH_CART_DELIVERY_SERVICES", "CHANGE_CART"]),
        onVariantChange(e) {
            this.selectedVariant = e
        },
        getFirstAvailableClickDeliveryVariant() {
            return this.ordinaryVariants.find((e=>e.deliveryServiceLevelCode === Le.CLICK))
        },
        findSelectedVariant(e, t) {
            return (t || this.variants || []).find((t=>v(La(t), La(e)))) || {}
        },
        getTypeCost(e) {
            const {obtainCost: t, obtainCostMax: s, freeDeliveryLimit: i} = e
                , a = i < this.CART_TOTAL.totalCost;
            return {
                cost: a ? 0 : t,
                exact: a || t >= s
            }
        },
        getVariantCost(e) {
            const {totalCost: t} = this.CART_TOTAL
                , {deliveryCost: s, freeDeliveryLimit: i} = e;
            return i < t ? 0 : s
        },
        getVariantKey(e) {
            const {receivingDateFrom: t, receivingDateTo: s} = e;
            return s ? `${t}-${s}` : t
        },
        async fetchServices() {
            this.loadingServices = !0;
            try {
                this.enabledGeoFences && await this.FETCH_CART_DELIVERY_SERVICES()
            } finally {
                this.loadingServices = !1
            }
        },
        changeServices: y((async function(e) {
                var t;
                const s = (e ?? []).filter((e=>e.isSelected || e.items.some((e=>e.isSelected)))).map((e=>{
                        const t = e.items.filter((({isSelected: e})=>e)).map((({wareId: e})=>({
                            wareId: e
                        })));
                        return {
                            id: e.id,
                            items: t
                        }
                    }
                ));
                try {
                    const {data: e} = await this.$api.web.setCartServices(s);
                    this.CHANGE_CART(e)
                } catch (i) {
                    const {status: e, data: s} = i
                        , a = null == (t = null == s ? void 0 : s.reason) ? void 0 : t.toUpperCase();
                    let o = ne.errorCodes.default;
                    500 === e && ma.includes(a) && (o = "Произошла ошибка при выборе услуг. Пожалуйста, повторите попытку позже"),
                        this.$notify({
                            text: o
                        })
                }
            }
        ), 500)
    },
    mounted() {
        this.fetchServices()
    }
}
    , Oa = {
    class: "sm-shipment-type-delivery"
}
    , Pa = (e=>(P("data-v-e10c9e05"),
    e = e(),
    N(),
    e))((()=>n("div", {
    class: "sm-shipment-type-delivery__title"
}, "Условия доставки", -1)))
    , Na = {
    class: "sm-shipment-type-delivery__hours"
}
    , wa = {
    class: "sm-shipment-type-delivery__title"
}
    , Ma = {
    class: "sm-shipment-type-delivery__title"
};
const Va = B(Da, [["render", function(c, m, p, h, S, _) {
    const C = e("SmCheckoutSelectedBlank")
        , y = e("SmCartDeliveryTypes")
        , T = e("SmShipmentGoodsList")
        , v = e("SmShipmentVariantInfo")
        , E = e("SmCartServices")
        , I = e("SmSkeleton")
        , g = e("SmCheckoutDeliveryTime")
        , A = e("SmCheckoutPickers")
        , f = e("SmShipmentTypeDeliveryClickPromo")
        , k = e("SmCheckoutDeliveryDate")
        , R = e("SmMessage")
        , L = e("SmServicesList");
    return t(),
        s("div", Oa, [o(C, {
            "data-test-id": "selectedBlank",
            image: c.$options.consts.deliveryImage,
            "image-alt": "Иконка доставки курьером",
            title: "Доставим курьером",
            info: _.addressText
        }, null, 8, ["image", "info"]), _.deliveryTypes.length > 1 ? (t(),
            s(l, {
                key: 0
            }, [Pa, o(y, {
                class: "sm-shipment-type-delivery__types",
                "selected-type-code": S.selectedTypeCode,
                "delivery-types": _.deliveryTypes,
                onSelect: m[0] || (m[0] = e=>S.selectedTypeCode = e.deliveryServiceLevelCode)
            }, null, 8, ["selected-type-code", "delivery-types"])], 64)) : a("", !0), o(v, {
            class: "sm-shipment-type-delivery__info",
            "is-delivery": !0,
            "need-prepay": _.variant.needPrepay,
            "availability-date": _.variant.receivingDateFrom,
            "availability-date-to": _.variant.receivingDateTo,
            "shipment-cost": _.variant.displayedDeliveryCost
        }, D({
            "goods-list": d((()=>[o(T, {
                class: "sm-shipment-variant-info__goods",
                "need-tooltip": !1,
                "need-to-toggle-visibility": !1,
                "need-to-hide-items": !0,
                "image-width": 60,
                "image-height": 80
            })])),
            _: 2
        }, [_.isExpress && _.hours ? {
            name: "sub",
            fn: d((()=>[n("div", Na, r(_.hours), 1)])),
            key: "0"
        } : void 0]), 1032, ["need-prepay", "availability-date", "availability-date-to", "shipment-cost"]), _.enabledGeoFences && !_.isExpress && c.CART_DELIVERY_SERVICES.length ? (t(),
            i(I, {
                key: 1,
                tag: "div",
                height: "100px",
                class: "sm-shipment-type-delivery__skeleton-services",
                loading: S.loadingServices
            }, {
                default: d((()=>[o(E, {
                    onInput: _.changeServices
                }, null, 8, ["onInput"])])),
                _: 1
            }, 8, ["loading"])) : a("", !0), _.isExpress && _.expressVariants.length ? (t(),
            s(l, {
                key: 2
            }, [n("div", wa, r(c.$options.consts.TITLES[S.selectedTypeCode]), 1), o(A, {
                key: "time",
                class: "sm-shipment-type-delivery__pickers",
                name: "time",
                long: "",
                options: _.expressVariants,
                "selected-option": S.selectedVariant,
                onChange: _.onVariantChange
            }, {
                option: d((e=>[o(g, {
                    value: e.receivingTimeSlot,
                    cost: _.getVariantCost(e)
                }, null, 8, ["value", "cost"])])),
                _: 1
            }, 8, ["options", "selected-option", "onChange"])], 64)) : a("", !0), _.isOrdinary ? (t(),
            s(l, {
                key: 3
            }, [n("div", Ma, r(c.$options.consts.TITLES[S.selectedTypeCode]), 1), _.showDeliveryByClickPromo ? (t(),
                i(f, b(O({
                    key: 0
                }, _.deliveryClickPromo)), null, 16)) : a("", !0), o(A, {
                key: "date",
                class: "sm-shipment-type-delivery__pickers",
                name: "date",
                options: _.ordinaryDates,
                "selected-option": S.selectedVariant,
                onChange: m[1] || (m[1] = e=>S.selectedVariant = e)
            }, {
                option: d((e=>[o(k, {
                    value: e
                }, null, 8, ["value"])])),
                _: 1
            }, 8, ["options", "selected-option"]), (t(),
                i(A, {
                    key: `time_${S.selectedVariant.receivingDateFrom}`,
                    long: "",
                    class: "sm-shipment-type-delivery__pickers",
                    name: "time",
                    options: _.ordinaryTimes,
                    "selected-option": S.selectedVariant,
                    onChange: _.onVariantChange
                }, {
                    option: d((e=>[o(g, {
                        "service-level-code": e.deliveryServiceLevelCode,
                        hints: e.hints,
                        value: e.receivingTimeSlot,
                        cost: _.getVariantCost(e)
                    }, null, 8, ["service-level-code", "hints", "value", "cost"])])),
                    _: 1
                }, 8, ["options", "selected-option", "onChange"])), _.deliveryClickMessage ? (t(),
                i(R, {
                    key: 1,
                    class: "sm-shipment-type-delivery__selected-interval-notification",
                    type: "info"
                }, {
                    default: d((()=>[u(r(_.deliveryClickMessage), 1)])),
                    _: 1
                })) : a("", !0)], 64)) : a("", !0), _.services.length ? (t(),
            i(L, {
                key: 4,
                class: "sm-shipment-type-delivery__services",
                services: _.services
            }, null, 8, ["services"])) : a("", !0), o(T, {
            class: "sm-shipment-variant-info__goods",
            "is-unavailable": ""
        })])
}
], ["__scopeId", "data-v-e10c9e05"]])
    , Ba = {
    key: 0,
    class: "sm-shipment-type-pickup"
};
const xa = B({
    name: "SmShipmentTypePickup",
    components: {
        SmCheckoutSelectedBlank: ti,
        SmShipmentVariantInfo: Qt,
        SmShipmentGoodsList: Yt,
        SmServicesList: Ut
    },
    consts: {
        types: {
            shop: {
                image: "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2028%2032'%3e%3cmask%20id='a'%3e%3cpath%20d='M11.25%2028.5c7.5-7.48%2011.25-13.27%2011.25-17.37A11.2%2011.2%200%200%200%2011.25%200%2011.2%2011.2%200%200%200%200%2011.13c0%204.1%203.75%209.89%2011.25%2017.37z'/%3e%3c/mask%3e%3cg%20fill='%23b5caff'%3e%3cpath%20d='M7.5%2030c7.5-7.48%2011.25-13.27%2011.25-17.37A11.2%2011.2%200%200%200%207.5%201.5%2011.2%2011.2%200%200%200-3.75%2012.63C-3.75%2016.73%200%2022.52%207.5%2030z'%20mask='url(%23a)'/%3e%3cpath%20d='M11.25%2031.5c7.5-7.48%2011.25-13.27%2011.25-17.37A11.2%2011.2%200%200%200%2011.25%203%2011.2%2011.2%200%200%200%200%2014.13c0%204.1%203.75%209.89%2011.25%2017.37z'/%3e%3c/g%3e%3cg%20fill='none'%20stroke='%231551e5'%20stroke-width='1.5'%3e%3ccircle%20cx='15'%20cy='12'%20r='7'%20fill='%23fff'/%3e%3cpath%20d='M15.15.75a12.02%2012.02%200%200%201%208.48%203.48%2011.79%2011.79%200%200%201%203.52%208.4c0%204.2-3.74%2010.2-11.47%2017.9l-.53.52a86.14%2086.14%200%200%201-.53-.52c-7.73-7.7-11.47-13.69-11.47-17.9%200-3.28%201.34-6.25%203.52-8.4A12.02%2012.02%200%200%201%2015.15.75z'/%3e%3cg%20stroke-linecap='round'%20stroke-width='1.3'%3e%3cpath%20d='m18.95%2014.64-6.05-2.42-1.49%201.8'/%3e%3cpath%20stroke='%23ff0016'%20d='m11.44%209.8%204.23%201.77%201.8-1.8'/%3e%3c/g%3e%3c/g%3e%3ccircle%20cx='15'%20cy='9'%20r='1'%20fill='%231551e5'/%3e%3c/svg%3e"
            },
            pickuppoint: {
                image: "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2030%2032'%3e%3cpath%20fill='%23b5caff'%20d='M15.76%2032H0V4.65h23.4V32h-3.05z'/%3e%3cg%20fill='none'%20stroke='%231551e5'%20stroke-width='1.8'%3e%3cpath%20fill='%23fff'%20stroke-linecap='round'%20stroke-linejoin='round'%20d='M25.6%2028.25H2.8V14.22h26.21v14.03'/%3e%3cpath%20stroke-linejoin='round'%20d='M2.8.9h26.21v6.85H2.81zm0%2013.39h26.21V7.75H2.81z'/%3e%3cpath%20stroke='%23ff0016'%20d='M2.8%2021.41h23.36'/%3e%3cpath%20d='M25.02%2010.59v1.14m0-7.98V4.9'/%3e%3c/g%3e%3c/svg%3e"
            }
        }
    },
    props: {
        data: {
            type: Object
        },
        shipmentCost: Number
    },
    computed: {
        type() {
            var e, t;
            return null == (t = null == (e = this.data) ? void 0 : e.store) ? void 0 : t.type
        },
        availableServices() {
            return this.data.specificServices || []
        },
        pickupType() {
            var e, t;
            return null == (t = null == (e = this.type) ? void 0 : e.toLowerCase) ? void 0 : t.call(e)
        },
        imagePath() {
            var e, t;
            return null == (t = null == (e = this.$options.consts.types) ? void 0 : e[this.pickupType]) ? void 0 : t.image
        },
        title() {
            const e = {
                shop: "магазине",
                pickuppoint: "пункта выдачи"
            }
                , t = {
                shop: "Забрать в",
                pickuppoint: "Забрать из"
            }
                , s = e[this.pickupType]
                , i = t[this.pickupType];
            return s && i ? `${i} ${s}` : `${t.pickuppoint} ${e.pickuppoint}`
        },
        isShop() {
            return this.type === is.SHOP
        }
    }
}, [["render", function(n, r, l, c, m, u) {
    const p = e("SmCheckoutSelectedBlank")
        , h = e("SmShipmentGoodsList")
        , S = e("SmShipmentVariantInfo")
        , _ = e("SmServicesList");
    return l.data.store ? (t(),
        s("section", Ba, [o(p, {
            class: "sm-shipment-type-pickup__selected-blank",
            image: u.imagePath,
            "image-alt": "Способ получения",
            title: u.title,
            info: l.data.store.address
        }, null, 8, ["image", "title", "info"]), o(S, {
            "is-shop": u.isShop,
            "ware-storage-period": l.data.store.wareStoragePeriod,
            "need-prepay": l.data.store.needPrepay,
            "resupplied-pickup": l.data.resuppliedPickup,
            "availability-date": l.data.availabilityDateFrom || l.data.totalAvailabilityDate,
            "availability-date-to": l.data.availabilityDateTo,
            "shipment-cost": l.shipmentCost
        }, {
            "goods-list": d((()=>[o(h, {
                class: "sm-shipment-type-pickup__goods",
                "need-tooltip": !1,
                "need-to-toggle-visibility": !1,
                "need-to-hide-items": !0,
                "image-width": 60,
                "image-height": 80
            })])),
            _: 1
        }, 8, ["is-shop", "ware-storage-period", "need-prepay", "resupplied-pickup", "availability-date", "availability-date-to", "shipment-cost"]), u.availableServices.length ? (t(),
            i(_, {
                key: 0,
                class: "sm-shipment-type-pickup__services",
                services: u.availableServices
            }, null, 8, ["services"])) : a("", !0), o(h, {
            "is-unavailable": ""
        })])) : a("", !0)
}
], ["__scopeId", "data-v-c6f6eaf4"]])
    , Ga = {
    key: 0,
    class: "sm-shipment-type-base__icon"
}
    , $a = {
    class: "sm-shipment-type-base__content"
};
const Ua = B({
    name: "SmShipmentTypeBase",
    components: {
        SmImage: G
    },
    props: {
        image: String
    },
    emits: ["click"],
    methods: {
        onClick() {
            this.$emit("click")
        }
    }
}, [["render", function(i, r, l, c, m, d) {
    const u = e("SmImage");
    return t(),
        s("div", {
            class: "sm-shipment-type-base",
            tabindex: "0",
            onClick: r[0] || (r[0] = (...e)=>d.onClick && d.onClick(...e))
        }, [l.image ? (t(),
            s("div", Ga, [o(u, {
                class: "sm-shipment-type-base__image",
                src: l.image,
                loading: "eager",
                alt: "Способ получения"
            }, null, 8, ["src"])])) : a("", !0), n("div", $a, [I(i.$slots, "default", {}, void 0, !0)])])
}
], ["__scopeId", "data-v-0fa1a2ed"]])
    , Ya = {
    name: "SmShipmentTypeCondition",
    components: {
        SmText: U
    },
    props: {
        type: {
            type: String,
            required: !0,
            validator: e=>["pickup", "delivery"].includes(e)
        },
        subtypes: {
            type: Object,
            default: ()=>({})
        }
    },
    consts: {
        DELIVERY_TYPE: "delivery",
        PICKUP_TYPE: "pickup",
        SHOP_SUBTYPE: "shop",
        PICKUP_POINT_SUBTYPE: "pickupPoint",
        DELIVERY_SUBTYPE: "delivery",
        EXPRESS_DELIVERY_SUBTYPE: "expressDelivery"
    },
    computed: {
        ...p(["CART_TOTAL", "NOW", "LANG"])
    },
    methods: {
        getDate(e) {
            const {subtypes: t, LANG: s, NOW: i} = this
                , a = t[e]
                , {availabilityDate: o} = a;
            return xe({
                from: o,
                base: i,
                lang: s
            })
        },
        getCost(e) {
            const {subtypes: t} = this
                , {totalCost: s} = this.CART_TOTAL
                , i = t[e]
                , {obtainCost: a, freeDeliveryLimit: o} = i;
            return 0 !== a && (void 0 === o || o > s) ? a : 0
        }
    }
}
    , Fa = {
    class: "sm-shipment-type-condition"
}
    , Ha = {
    key: 0
}
    , ja = {
    key: 0,
    class: "sm-shipment-type-condition__item-value"
}
    , qa = {
    key: 1,
    class: "sm-shipment-type-condition__item-value"
}
    , Wa = {
    key: 0,
    class: "sm-shipment-type-condition__item-value"
}
    , za = {
    key: 1,
    class: "sm-shipment-type-condition__item-value"
}
    , Qa = {
    key: 1
}
    , Ka = {
    key: 0,
    class: "sm-shipment-type-condition__item-value"
}
    , Xa = {
    key: 1,
    class: "sm-shipment-type-condition__item-value"
}
    , Za = {
    key: 0,
    class: "sm-shipment-type-condition__item-value"
}
    , Ja = {
    key: 1,
    class: "sm-shipment-type-condition__item-value"
};
const eo = {
    delivery: {
        image: Wt
    },
    pickup: {
        image: zt
    }
}
    , to = {
    name: "SmShipmentTypePreview",
    components: {
        SmText: U,
        SmShipmentTypeBase: Ua,
        SmShipmentTypeCondition: B(Ya, [["render", function(o, n, l, c, m, p) {
            const h = e("SmText");
            return t(),
                s("div", Fa, [l.type === o.$options.consts.PICKUP_TYPE ? (t(),
                    s("div", Ha, [void 0 !== l.subtypes[o.$options.consts.SHOP_SUBTYPE] ? (t(),
                        i(h, {
                            key: 0,
                            variant: "text-12",
                            class: "sm-shipment-type-condition__item",
                            "data-selenium": "shipment-condition-shop"
                        }, {
                            default: d((()=>[u(" В магазине " + r(p.getDate(o.$options.consts.SHOP_SUBTYPE)) + ", ", 1), p.getCost(o.$options.consts.SHOP_SUBTYPE) ? (t(),
                                s("span", ja, " от " + r(p.getCost(o.$options.consts.SHOP_SUBTYPE)) + "₽ ", 1)) : (t(),
                                s("span", qa, " бесплатно "))])),
                            _: 1
                        })) : a("", !0), void 0 !== l.subtypes[o.$options.consts.PICKUP_POINT_SUBTYPE] ? (t(),
                        i(h, {
                            key: 1,
                            variant: "text-12",
                            class: "sm-shipment-type-condition__item",
                            "data-selenium": "shipment-condition-pickpoint"
                        }, {
                            default: d((()=>[u(" В пунктах выдачи " + r(p.getDate(o.$options.consts.PICKUP_POINT_SUBTYPE)) + ", ", 1), p.getCost(o.$options.consts.PICKUP_POINT_SUBTYPE) ? (t(),
                                s("span", Wa, " от " + r(p.getCost(o.$options.consts.PICKUP_POINT_SUBTYPE)) + "₽ ", 1)) : (t(),
                                s("span", za, " бесплатно "))])),
                            _: 1
                        })) : a("", !0)])) : a("", !0), l.type === o.$options.consts.DELIVERY_TYPE ? (t(),
                    s("div", Qa, [void 0 !== l.subtypes[o.$options.consts.DELIVERY_SUBTYPE] ? (t(),
                        i(h, {
                            key: 0,
                            variant: "text-12",
                            class: "sm-shipment-type-condition__item",
                            "data-selenium": "shipment-condition-delivery"
                        }, {
                            default: d((()=>[u(" Доставка " + r(p.getDate(o.$options.consts.DELIVERY_SUBTYPE)) + ", ", 1), p.getCost(o.$options.consts.DELIVERY_SUBTYPE) ? (t(),
                                s("span", Ka, " от " + r(p.getCost(o.$options.consts.DELIVERY_SUBTYPE)) + "₽ ", 1)) : (t(),
                                s("span", Xa, " бесплатно "))])),
                            _: 1
                        })) : a("", !0), void 0 !== l.subtypes[o.$options.consts.EXPRESS_DELIVERY_SUBTYPE] ? (t(),
                        i(h, {
                            key: 1,
                            variant: "text-12",
                            class: "sm-shipment-type-condition__item",
                            "data-selenium": "shipment-condition-express-delivery"
                        }, {
                            default: d((()=>[u(" Экспресс-доставка " + r(p.getDate(o.$options.consts.EXPRESS_DELIVERY_SUBTYPE)) + ", ", 1), p.getCost(o.$options.consts.EXPRESS_DELIVERY_SUBTYPE) ? (t(),
                                s("span", Za, " от " + r(p.getCost(o.$options.consts.EXPRESS_DELIVERY_SUBTYPE)) + "₽ ", 1)) : (t(),
                                s("span", Ja, " бесплатно "))])),
                            _: 1
                        })) : a("", !0)])) : a("", !0)])
        }
        ], ["__scopeId", "data-v-edf4a637"]])
    },
    consts: {
        types: eo,
        TEXTS: {
            delivery: {
                title: "Доставка",
                description: "Курьером до вашей двери",
                disabled: "Доставка недоступна"
            },
            pickup: {
                title: "Самовывоз",
                description: "Из магазина, пункта выдачи или постамата",
                disabled: "Самовывоз недоступен"
            }
        }
    },
    props: {
        type: {
            type: String,
            required: !0,
            validator: e=>Object.keys(eo).includes(e)
        },
        subtypes: {
            type: Object,
            default: ()=>({})
        },
        disabled: {
            type: Boolean
        }
    },
    emits: ["select"],
    computed: {
        imagePath() {
            return this.$options.consts.types[this.type].image
        }
    },
    methods: {
        onSelect() {
            this.$emit("select")
        }
    }
}
    , so = {
    class: "sm-shipment-type-preview__information"
}
    , io = {
    class: "sm-shipment-type-preview__title-description"
};
const ao = {
    name: "SmCartShipmentTypesList",
    components: {
        SmShipmentTypePreview: B(to, [["render", function(s, a, l, c, m, p) {
            const h = e("SmText")
                , S = e("SmShipmentTypeCondition")
                , _ = e("SmShipmentTypeBase");
            return t(),
                i(_, {
                    class: "sm-shipment-type-preview",
                    image: p.imagePath,
                    onClick: p.onSelect
                }, {
                    default: d((()=>[n("div", so, [n("div", io, [o(h, {
                        class: "sm-shipment-type-preview__title",
                        variant: "text-14",
                        family: "medium"
                    }, {
                        default: d((()=>[u(r(s.$options.consts.TEXTS[l.type].title), 1)])),
                        _: 1
                    }), o(h, {
                        ref: "des",
                        class: "sm-shipment-type-preview__description",
                        variant: "text-12"
                    }, {
                        default: d((()=>[u(r(s.$options.consts.TEXTS[l.type].description), 1)])),
                        _: 1
                    }, 512)]), l.disabled ? (t(),
                        i(h, {
                            key: 0,
                            class: "sm-shipment-type-preview__disabled",
                            variant: "text-12",
                            family: "medium"
                        }, {
                            default: d((()=>[u(r(s.$options.consts.TEXTS[l.type].disabled), 1)])),
                            _: 1
                        })) : (t(),
                        i(S, {
                            key: 1,
                            class: "sm-shipment-type-preview__condition",
                            type: l.type,
                            subtypes: l.subtypes
                        }, null, 8, ["type", "subtypes"]))])])),
                    _: 1
                }, 8, ["image", "onClick"])
        }
        ], ["__scopeId", "data-v-eb73510b"]]),
        SmShipmentTypeDelivery: Va,
        SmShipmentTypePickup: xa,
        SmShipmentTypeTabs: as,
        SmMessage: J
    },
    consts: {
        DELIVERY: W,
        PICKUP: z
    },
    props: {
        selectedType: {
            type: String
        },
        variants: {
            type: Array,
            default: ()=>[]
        },
        pickup: {
            type: Object,
            default: ()=>{}
        },
        delivery: {
            type: Object,
            default: ()=>null
        },
        total: Object
    },
    emits: ["previewClick", "tabsChange"],
    data() {
        var e, t;
        return {
            selectedTab: this.selectedType ? this.selectedType : null == (t = null == (e = this.variants) ? void 0 : e.find((({enabled: e})=>e))) ? void 0 : t.name
        }
    },
    computed: {
        ...p(["BASE_URL"]),
        deliveryVariant() {
            return this.variants.find((({name: e})=>e === W))
        },
        pickupVariant() {
            return this.variants.find((({name: e})=>e === z))
        },
        isShowMessageServicesAvailable() {
            const {selectedType: e, deliveryVariant: t} = this;
            return !(!(t && t.enabled && t.servicesAvailable) || e !== z && !1 !== Boolean(e))
        }
    },
    mounted() {
        var e, t, s, i, a, o, n;
        const {BASE_URL: r} = this;
        (null == (e = null == this ? void 0 : this.deliveryVariant) ? void 0 : e.enabled) ? (null == (i = null == this ? void 0 : this.deliveryVariant) ? void 0 : i.enabled) || (null == (a = null == this ? void 0 : this.pickupVariant) ? void 0 : a.enabled) || (null == (n = null == (o = null == window ? void 0 : window.history) ? void 0 : o.replaceState) || n.call(o, "", document.title, $e(r)),
            window.location.reload()) : (null == (s = null == (t = null == window ? void 0 : window.history) ? void 0 : t.replaceState) || s.call(t, "", document.title, Ge(r)),
            Te.removeItem(Ht))
    },
    methods: {
        getSubtypes(e) {
            const {shop: t, pickupPoint: s, ordinaryDelivery: i, expressDelivery: a} = e;
            return e.name === z ? {
                shop: t,
                pickupPoint: s
            } : {
                delivery: i,
                expressDelivery: a
            }
        },
        onPreviewClick(e) {
            this.$emit("previewClick"),
                this.tabsChange(e),
                this.$analytics.sendUserPickShippingMethodEvent(e)
        },
        tabsChange(e) {
            this.selectedTab = e,
                this.$emit("tabsChange", e)
        }
    }
}
    , oo = {
    class: "sm-cart-shipment-types-list"
}
    , no = {
    class: "sm-cart-shipment-types-list__wrapper"
}
    , ro = {
    key: 1,
    class: "sm-cart-shipment-types-list__variants"
};
const lo = {
    name: "SmCartStepShipment",
    components: {
        SmCartStep: yi,
        SmLink: Z,
        SmCartShipmentTypesList: B(ao, [["render", function(o, r, m, p, h, S) {
            const _ = e("SmMessage")
                , C = e("SmShipmentTypeTabs")
                , y = e("SmShipmentTypePreview")
                , v = e("SmShipmentTypePickup")
                , E = e("SmShipmentTypeDelivery");
            return t(),
                s("div", oo, [S.isShowMessageServicesAvailable ? (t(),
                    i(_, {
                        key: 0,
                        class: "sm-cart-shipment-types-list__info-message",
                        "data-test-id": "info-message",
                        type: "info"
                    }, {
                        default: d((()=>[u(" Чтобы заказать услуги сборки, выберите доставку курьером ")])),
                        _: 1
                    })) : a("", !0), n("div", no, [m.selectedType ? (t(),
                    i(C, {
                        key: 0,
                        class: "sm-cart-shipment-types-list__tabs",
                        "selected-tab": m.selectedType,
                        "data-test-id": "shipment-types-list-tabs",
                        onChange: S.tabsChange
                    }, null, 8, ["selected-tab", "onChange"])) : (t(),
                    s("div", ro, [(t(!0),
                        s(l, null, T(m.variants, (e=>(t(),
                            s("div", {
                                key: e.name,
                                class: c(["sm-cart-shipment-types-list__variant", {
                                    "sm-cart-shipment-types-list__variant--disabled": !e.enabled
                                }])
                            }, [e.name === o.$options.consts.PICKUP ? (t(),
                                s(l, {
                                    key: 0
                                }, [m.pickup ? a("", !0) : (t(),
                                    i(y, {
                                        key: 0,
                                        ref_for: !0,
                                        ref: "pickupPreview",
                                        "data-selenium": "pickup",
                                        "data-test-id": "type-preview-pickup",
                                        type: e.name.toLowerCase(),
                                        subtypes: S.getSubtypes(e),
                                        disabled: !e.enabled,
                                        onSelect: t=>S.onPreviewClick(e.name)
                                    }, null, 8, ["type", "subtypes", "disabled", "onSelect"]))], 64)) : a("", !0), e.name === o.$options.consts.DELIVERY ? (t(),
                                s(l, {
                                    key: 1
                                }, [m.delivery ? a("", !0) : (t(),
                                    i(y, {
                                        key: 0,
                                        ref_for: !0,
                                        ref: "deliveryPreview",
                                        "data-selenium": "delivery",
                                        "data-test-id": "type-preview-delivery",
                                        type: e.name.toLowerCase(),
                                        subtypes: S.getSubtypes(e),
                                        disabled: !e.enabled,
                                        onSelect: t=>S.onPreviewClick(e.name)
                                    }, null, 8, ["type", "subtypes", "disabled", "onSelect"]))], 64)) : a("", !0)], 2)))), 128))])), m.selectedType ? (t(),
                    s(l, {
                        key: 2
                    }, [m.pickup ? (t(),
                        i(v, {
                            key: 0,
                            class: "sm-cart-shipment-types-list__selected-blank",
                            "data-selenium": "pickup",
                            data: m.pickup,
                            "shipment-cost": m.total.deliveryCost
                        }, null, 8, ["data", "shipment-cost"])) : a("", !0), m.delivery ? (t(),
                        i(E, {
                            key: 1,
                            class: "sm-cart-shipment-types-list__selected-blank",
                            "data-selenium": "delivery",
                            data: m.delivery,
                            value: S.deliveryVariant
                        }, null, 8, ["data", "value"])) : a("", !0)], 64)) : a("", !0)])])
        }
        ], ["__scopeId", "data-v-9bc4c9f6"]]),
        SmShipmentGoodsList: Yt,
        SmMessage: J
    },
    props: {
        name: {
            type: String,
            required: !0
        },
        error: {
            type: Boolean
        },
        isValid: {
            type: Boolean
        }
    },
    emits: ["clickShipmentTypesList", "onPreviewClick"],
    data: ()=>({
        isShipmentTypeReseted: !1
    }),
    computed: {
        ...p(["CART_TOTAL", "CART_ITEMS_QUANTITY", "COUNTRY", "CART_ITEMS", "CART_SELECTED_SHIPMENT", "CART_SHIPMENT_VARIANTS", "CART_SHIPMENT_PICKUP", "CART_SHIPMENT_DELIVERY", "IS_SHOW_SHIPMENT_TABS", "SHIPMENT_VARIANT_AVAILABLE_ITEMS", "CART_PROMOCODE_CODE", "ANONYMOUS"]),
        ...p(q, ["IS_ACTIVE"]),
        shipmentStepTitle() {
            return this.CART_SELECTED_SHIPMENT ? "Способ получения" : "Выберите способ получения"
        },
        enabledGeoFences() {
            return this.IS_ACTIVE("FT7481")
        },
        showDeliveryAddressesFTEnabled() {
            return this.IS_ACTIVE("FT10294")
        },
        hasDisabledDelivery() {
            return this.CART_SHIPMENT_VARIANTS.some((e=>e.name === W && !e.enabled))
        },
        addressAlertShown() {
            return this.enabledGeoFences && !this.CART_SELECTED_SHIPMENT && this.hasDisabledDelivery
        }
    },
    watch: {
        CART_SELECTED_SHIPMENT: {
            handler(e, t) {
                this.isShipmentTypeReseted = !e && !!t
            },
            immediate: !0
        }
    },
    mounted() {
        var e, t;
        const {location: {hash: s}} = window;
        if (null == (e = null == s ? void 0 : s.includes) ? void 0 : e.call(s, W.toLowerCase()))
            this.showDeliveryDialog();
        else if (null == (t = null == s ? void 0 : s.includes) ? void 0 : t.call(s, z.toLowerCase())) {
            Te.getItem(Ft) && this.showPickupPointsDialog()
        }
        Te.removeItem(Ft)
    },
    methods: {
        ...h(["SHOW_GLOBAL_DIALOG"]),
        sendCheckoutSetShipmentInfoEvent() {
            const {CART_SELECTED_SHIPMENT: e, CART_PROMOCODE_CODE: t, COUNTRY: s, CART_TOTAL: i, CART_ITEMS_QUANTITY: a, CART_ITEMS: o} = this;
            this.$analytics.sendCheckoutSetShipmentInfoEvent({
                CART_ITEMS: o,
                COUNTRY: s,
                CART_TOTAL: i,
                CART_ITEMS_QUANTITY: a,
                CART_SELECTED_SHIPMENT: e,
                CART_PROMOCODE_CODE: t
            })
        },
        onClickShipmentTypeList() {
            this.$emit("clickShipmentTypesList")
        },
        changeShipmentVariant() {
            this.changeShipmentTypeDialog(this.CART_SELECTED_SHIPMENT)
        },
        showPickupPointsDialog() {
            this.isEnabledVariant(z) && this.SHOW_GLOBAL_DIALOG({
                template: "SmPickupDialog",
                options: {
                    hideClose: this.$root.isMediaSMPlus
                },
                mobileTitle: this.deliveryDialogTitle("pickup"),
                woMobileNav: !0,
                onConfirm: this.onDialogChangeShipmentType,
                isNotCacheable: !0
            })
        },
        showDeliveryDialog() {
            this.isEnabledVariant(W) && (this.enabledGeoFences ? this.showDeliveryAddressesFTEnabled && !this.ANONYMOUS ? this.SHOW_GLOBAL_DIALOG({
                template: "SmAddressDialog",
                mobileTitle: this.deliveryDialogTitle("delivery"),
                woMobileNav: !0,
                onConfirm: this.onDialogChangeShipmentType,
                isNotCacheable: !0,
                options: {
                    restore: !0,
                    hideClose: this.$root.isMediaSMPlus
                }
            }) : this.SHOW_GLOBAL_DIALOG({
                template: "SmDeliveryGeoLocationDialog",
                mobileTitle: this.deliveryDialogTitle("delivery"),
                data: {
                    isCallFetchServices: this.isValid
                },
                woMobileNav: !0,
                onConfirm: this.onDialogChangeShipmentType,
                isNotCacheable: !0,
                options: {
                    hideClose: this.$root.isMediaSMPlus
                }
            }) : this.SHOW_GLOBAL_DIALOG({
                template: "SmDeliveryDialog",
                options: {
                    hideClose: this.$root.isMediaSMPlus
                },
                mobileTitle: this.deliveryDialogTitle("delivery"),
                woMobileNav: !0,
                onConfirm: this.onDialogChangeShipmentType,
                isNotCacheable: !0
            }))
        },
        async onDialogChangeShipmentType({newShipmentType: e, isChangedShipment: t}) {
            e && (await this.$nextTick(),
                this.changeShipmentTypeDialog(e)),
            t && this.sendCheckoutSetShipmentInfoEvent()
        },
        changeShipmentTypeDialog(e) {
            e === z ? this.showPickupPointsDialog() : e === W && this.showDeliveryDialog()
        },
        isEnabledVariant(e) {
            return this.CART_SHIPMENT_VARIANTS.find((({name: t, enabled: s})=>t === e && s))
        },
        deliveryDialogTitle(e) {
            if (!this.IS_SHOW_SHIPMENT_TABS) {
                return {
                    pickup: "Самовывоз",
                    delivery: "Доставка"
                }[e]
            }
            return "Способ получения"
        },
        onPreviewClick() {
            this.$emit("onPreviewClick")
        },
        showGeoLocationEditorDialog() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmGeoLocationEditorDialog",
                mobileTitle: "Где хотите получить заказ?",
                woMobileNav: !0
            })
        }
    }
}
    , co = n("span", null, "Товары из корзины недоступны по выбранному адресу", -1)
    , mo = {
    key: 2,
    "data-test-id": "cart-items",
    class: "sm-cart-step-shipment__items"
}
    , uo = {
    class: "sm-cart-step-shipment__heading"
};
const po = {
    offset: -80
}
    , ho = {
    name: "SmCartCheckout",
    components: {
        SmCartStepShipment: B(lo, [["render", function(l, c, m, p, h, S) {
            const _ = e("SmLink")
                , C = e("SmMessage")
                , y = e("SmCartShipmentTypesList")
                , T = e("SmShipmentGoodsList")
                , v = e("SmCartStep");
            return t(),
                i(v, {
                    class: "sm-cart-step-shipment",
                    "data-selenium": "shipment",
                    title: S.shipmentStepTitle,
                    name: m.name,
                    error: m.error,
                    reset: h.isShipmentTypeReseted
                }, {
                    headerContent: d((()=>[l.CART_SELECTED_SHIPMENT ? (t(),
                        i(_, {
                            key: 0,
                            class: "sm-cart-step-shipment__link",
                            "data-test-id": "change-shipment-link",
                            tag: "button",
                            underline: "none",
                            onClick: S.changeShipmentVariant
                        }, {
                            default: d((()=>[u(" Изменить ")])),
                            _: 1
                        }, 8, ["onClick"])) : a("", !0)])),
                    default: d((()=>{
                            var e;
                            return [S.addressAlertShown ? (t(),
                                i(C, {
                                    key: 0,
                                    type: "alert",
                                    class: "sm-cart-step-shipment__alert"
                                }, {
                                    default: d((()=>[co, o(_, {
                                        tag: "button",
                                        "data-test-id": "address-link",
                                        onClick: S.showGeoLocationEditorDialog
                                    }, {
                                        default: d((()=>[u(" Указать другой адрес ")])),
                                        _: 1
                                    }, 8, ["onClick"])])),
                                    _: 1
                                })) : a("", !0), l.CART_SHIPMENT_VARIANTS && l.CART_SHIPMENT_VARIANTS.length ? (t(),
                                i(y, {
                                    key: 1,
                                    "data-selenium": "shipment",
                                    "data-test-id": "shipment-types-list",
                                    class: "sm-cart-step-shipment__variants",
                                    "selected-type": l.CART_SELECTED_SHIPMENT,
                                    variants: l.CART_SHIPMENT_VARIANTS,
                                    pickup: l.CART_SHIPMENT_PICKUP,
                                    delivery: l.CART_SHIPMENT_DELIVERY,
                                    total: l.CART_TOTAL,
                                    onClickOnce: S.onClickShipmentTypeList,
                                    onChange: S.sendCheckoutSetShipmentInfoEvent,
                                    onTabsChange: S.changeShipmentTypeDialog,
                                    onPreviewClickOnce: S.onPreviewClick
                                }, null, 8, ["selected-type", "variants", "pickup", "delivery", "total", "onClickOnce", "onChange", "onTabsChange", "onPreviewClickOnce"])) : a("", !0), l.SHIPMENT_VARIANT_AVAILABLE_ITEMS.length && !l.CART_SELECTED_SHIPMENT ? (t(),
                                s("div", mo, [n("span", uo, " Товары, " + r(null == (e = l.CART_TOTAL) ? void 0 : e.productsQuantity) + " шт. ", 1), o(T)])) : a("", !0)]
                        }
                    )),
                    _: 1
                }, 8, ["title", "name", "error", "reset"])
        }
        ]]),
        SmCartStep: yi,
        SmCartContactsUser: di,
        SmCartContactsAnonymous: Qs,
        SmCartStepPayment: Yi
    },
    props: {
        initLoading: {
            type: Boolean,
            required: !0
        },
        steps: {
            type: Object,
            required: !0,
            default: ()=>({})
        },
        subscriptionConsent: {
            type: Object,
            required: !0,
            default: ()=>({})
        }
    },
    consts: {
        subscription: {
            EMAIL: Ue
        }
    },
    data: ()=>({
        indeterminate: !0,
        userContacts: {
            fio: "",
            phone: "",
            email: "",
            verificationCode: ""
        },
        codeError: !1,
        isShipmentItemClicked: !1
    }),
    computed: {
        ...p(["BASE_URL", "TERRITORY", "COUNTRY", "WEBSITE_TYPE", "CART_ITEMS", "CART_TOTAL", "CART_ITEMS_QUANTITY", "CART_SELECTED_SHIPMENT", "CART_SHIPMENT_PICKUP", "CART_SHIPMENT_DELIVERY", "CART_SELECTED_PAYMENT", "CART_CONTACTS_USER_TYPE", "CART_CONTACTS_USER_OWNER", "CART_CONTACTS_USER_RECEIVER", "CART_IS_BONUSES_APPLY", "CART_BONUSES_TO_APPLY", "CART_PROMOCODE_CODE", "PRODUCTS", "ANONYMOUS", "CART_PHONE_VERIFICATION_REQUIRED", "CART_PENDING", "CART_ORDER_ITEMS_BY_AVAILABILITY"]),
        needPrepay() {
            var e, t;
            const {CART_SELECTED_SHIPMENT: s, CART_SHIPMENT_PICKUP: i, CART_SHIPMENT_DELIVERY: a} = this;
            switch (s) {
                case W:
                    return null == (e = null == a ? void 0 : a.deliveryVariant) ? void 0 : e.needPrepay;
                case z:
                    return null == (t = null == i ? void 0 : i.store) ? void 0 : t.needPrepay;
                default:
                    return !1
            }
        },
        isPaymentOnline() {
            return Rt(this.CART_SELECTED_PAYMENT)
        },
        isUserContactsOwner() {
            var e;
            return (null == (e = this.CART_CONTACTS_USER_TYPE) ? void 0 : e.toUpperCase()) === Ee
        },
        isUserContactsReceiver() {
            var e;
            return (null == (e = this.CART_CONTACTS_USER_TYPE) ? void 0 : e.toUpperCase()) === ve
        },
        isSelectedShipmentOrPayment() {
            return this.CART_SELECTED_SHIPMENT || this.CART_SELECTED_PAYMENT
        }
    },
    mounted() {
        var e, t;
        const {isSelectedShipmentOrPayment: s, initLoading: i} = this;
        if (i) {
            const e = this.$watch("initLoading", (()=>{
                    e(),
                    s && this.sendCheckoutBeginEvent()
                }
            ))
        } else
            s && this.sendCheckoutBeginEvent();
        this.$scrollTo(null == (t = this.$refs[null == (e = this.steps.shipment) ? void 0 : e.name]) ? void 0 : t.$el, po),
            Te.removeItem(Ye)
    },
    methods: {
        ...h(["SHOW_GLOBAL_DIALOG", "CHANGE_CART", "CHANGE_CART_PENDING"]),
        showAuthDialog() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmAuthDialog",
                mobileTitle: "Вход или регистрация",
                woMobileNav: !0
            })
        },
        showErrorDialog(e, t=!0) {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmAlert",
                data: {
                    title: "Ошибка",
                    message: e || "Произошла непредвиденная ошибка. Попробуйте повторить позднее.",
                    hideOkButton: t
                },
                woMobileNav: !0,
                onClose: y((()=>{
                        this.init()
                    }
                ), 100)
            })
        },
        handleSubmitError(e) {
            var t, s, i, a;
            (null == (t = e.data) ? void 0 : t.reason) === Fe.INVALID_GIFTCARD ? this.showErrorDialog("Невозможно использовать указанную подарочную карту. Некорректная подарочная карта будет удалена. Повторите попытку.", !1) : (null == (s = e.data) ? void 0 : s.reason) === Fe.WRONG_CART_STATE ? this.showErrorDialog("Ваша корзина была изменена. Повторите попытку.", !1) : (null == (i = e.data) ? void 0 : i.reason) === Fe.PHONE_VERIFICATION_CODE_REQUIRED ? this.showErrorDialog("Необходимо подтвердить номер телефона через смс.", !1) : (null == (a = e.data) ? void 0 : a.reason) || 400 !== e.status ? this.showErrorDialog() : this.codeError = !0,
                console.error(e)
        },
        isValidStep({isValid: e}={}) {
            const {indeterminate: t} = this;
            return t || e
        },
        async isValidAsyncStep({isValid: e}={}) {
            const t = await e();
            return this.isValidStep({
                isValid: t
            })
        },
        async validateSteps() {
            const {steps: e, isValidStep: t, isValidAsyncStep: s} = this;
            let i;
            this.indeterminate = !1;
            for await(const a of w(Object.keys(e), ["value"])) {
                const o = e[a];
                let n = !1;
                if (n = "function" == typeof o.isValid ? !(await s(o)) : !t(o),
                    n) {
                    i = o;
                    break
                }
            }
            return i
        },
        sendAllTransactionsEvent(e) {
            const {COUNTRY: t, WEBSITE_TYPE: s, CART_TOTAL: {totalCost: i, deliveryCost: a}, CART_IS_BONUSES_APPLY: o, CART_BONUSES_TO_APPLY: n, CART_PROMOCODE_CODE: r, CART_SELECTED_SHIPMENT: l, CART_SELECTED_PAYMENT: c, PRODUCTS: m, CART_ORDER_ITEMS_BY_AVAILABILITY: d} = this
                , {availableForOrderItems: u} = d;
            this.$analytics.sendAllTransactionsEvent([{
                transactionId: e,
                transactionAffiliation: s,
                transactionTotal: i,
                transactionCurrencyCode: He(t),
                transactionTax: 0,
                transactionShipping: a,
                transactionBonusesUsed: o ? n : 0,
                transactionPromocode: r,
                transactionShippingType: l,
                transactionPaymentType: c,
                transactionProducts: u
            }], m)
        },
        sendErrorEvents() {
            var e, t, s, i;
            const a = this.ANONYMOUS ? null == (t = null == (e = this.$refs.contactsAnonymous) ? void 0 : e.getInvalidFieldErrors) ? void 0 : t.call(e) : null == (i = null == (s = this.$refs.contactsUser) ? void 0 : s.getReceiverFieldErrors) ? void 0 : i.call(s);
            (null == a ? void 0 : a.length) && a.forEach((e=>{
                    this.$analytics.sendErrorAppear({
                        text: e
                    })
                }
            ))
        },
        async submit() {
            var e, t, s, i, a;
            const {validateSteps: o, userContacts: n, BASE_URL: r, ANONYMOUS: l, CART_CONTACTS_USER_OWNER: c, sendAllTransactionsEvent: m, isUserContactsOwner: d, isUserContactsReceiver: u, CART_CONTACTS_USER_RECEIVER: p, steps: h, subscriptionConsent: S, CART_PENDING: _, TERRITORY: C} = this;
            if (_)
                return;
            const y = await o();
            if (y)
                return this.sendErrorEvents(),
                    void this.$scrollTo(this.$refs[y.name].$el, po);
            this.CHANGE_CART_PENDING(!0),
                this.codeError = !1;
            try {
                const {adaptation: o, screen: _, page: y, osVersion: v, deviceModel: E, bonuses: I} = (null == (a = null == (i = null == (s = null == (t = null == (e = this.$analytics) ? void 0 : e._services) ? void 0 : t.pers) ? void 0 : s._builders) ? void 0 : i.header) ? void 0 : a.build()) || {}
                    , {id: g, name: A, macrocityId: f} = C
                    , k = {
                    adaptation: o,
                    screen: _,
                    page: y,
                    osVersion: v,
                    deviceModel: E,
                    bonuses: I,
                    location: {
                        id: g,
                        name: A,
                        macroCityId: f
                    }
                };
                let b;
                switch (!0) {
                    case l:
                        b = {
                            ...n
                        };
                        break;
                    case d:
                        b = {
                            ...c,
                            fio: c.fio || n.fio,
                            email: c.email || n.email
                        };
                        break;
                    case u:
                        b = {
                            ...p
                        }
                }
                let R = {
                    ...b,
                    eventPayload: k
                };
                h.subscription && (R = {
                    ...R,
                    subscriptionConsent: S
                });
                const {data: L, orderCreated: D, orderNumber: O} = await je(r, R);
                if (D) {
                    try {
                        m(O)
                    } catch (T) {
                        console.error(T)
                    }
                    qe.addOrder(O),
                        await this.redirectAfterCartSubmission(O, L)
                } else
                    this.CHANGE_CART(L),
                        this.showErrorDialog(),
                        this.CHANGE_CART_PENDING(!1)
            } catch (v) {
                this.CHANGE_CART_PENDING(!1),
                    this.handleSubmitError(v)
            }
        },
        sendCheckoutBeginEvent() {
            const {CART_TOTAL: e, CART_ITEMS_QUANTITY: t, COUNTRY: s, isShipmentItemClicked: i, CART_ITEMS: a, CART_SELECTED_SHIPMENT: o} = this;
            i || (this.isShipmentItemClicked = !0,
                this.$analytics.sendCheckoutBeginEvent({
                    CART_ITEMS: a,
                    COUNTRY: s,
                    CART_TOTAL: e,
                    CART_ITEMS_QUANTITY: t,
                    CART_SELECTED_SHIPMENT: o
                }))
        },
        sendCheckoutSetPaymentInfoEvent(e) {
            const {CART_PROMOCODE_CODE: t, COUNTRY: s, CART_ITEMS: i, CART_TOTAL: a, CART_ITEMS_QUANTITY: o, CART_SELECTED_SHIPMENT: n} = this;
            this.$analytics.sendCheckoutSetPaymentInfoEvent({
                CART_ITEMS: i,
                COUNTRY: s,
                CART_TOTAL: a,
                CART_ITEMS_QUANTITY: o,
                CART_PROMOCODE_CODE: t,
                CART_SELECTED_SHIPMENT: n,
                paymentType: e
            })
        },
        async redirectAfterCartSubmission(e, t) {
            var s;
            const {BASE_URL: i, CART_SELECTED_PAYMENT: a} = this
                , o = null == (s = t.paymentTool) ? void 0 : s.selected
                , n = We(i, e, o)
                , r = `${n}/#`;
            let l = n
                , c = null;
            try {
                Rt(a) ? Lt(o) ? (({url: c} = await ze(i, e)),
                    l = r) : (Ot(o) || Pt(o)) && Te.setItem(Qe, Ke.CART) : Dt(a) ? (({url: c} = await this.$api.web.getCreditPayment(e)),
                    l = r) : Nt(a) && (({url: c} = await this.$api.web.getBnplSovcombankPaymentData(e)),
                    l = r),
                c && Te.setItem(Ye, c)
            } catch (m) {
                console.error(m)
            } finally {
                l !== n && Xe(n),
                    window.location.assign(l)
            }
        }
    }
}
    , So = {
    class: "sm-cart-checkout"
}
    , _o = {
    class: "sm-cart-checkout__steps"
};
const Co = B(ho, [["render", function(o, r, l, c, m, u) {
    const p = e("SmCartStepShipment")
        , h = e("SmCartContactsAnonymous")
        , S = e("SmCartContactsUser")
        , _ = e("SmCartStep")
        , C = e("SmCartStepPayment");
    return t(),
        s("div", So, [n("div", _o, [l.steps.shipment ? (t(),
            i(p, {
                key: 0,
                ref: l.steps.shipment.name,
                name: l.steps.shipment.name,
                "is-valid": l.steps.shipment.isValid,
                error: !u.isValidStep(l.steps.shipment),
                onOnPreviewClick: u.sendCheckoutBeginEvent
            }, null, 8, ["name", "is-valid", "error", "onOnPreviewClick"])) : a("", !0), l.steps.contacts ? (t(),
            i(_, {
                key: 1,
                ref: l.steps.contacts.name,
                "data-selenium": "contacts",
                step: l.steps.contacts.value,
                name: l.steps.contacts.name,
                disabled: !o.CART_SELECTED_SHIPMENT
            }, {
                default: d((()=>[o.ANONYMOUS ? (t(),
                    i(h, {
                        key: 0,
                        ref: "contactsAnonymous",
                        modelValue: m.userContacts,
                        "onUpdate:modelValue": r[0] || (r[0] = e=>m.userContacts = e),
                        "code-error": m.codeError,
                        "phone-verification-required": o.CART_PHONE_VERIFICATION_REQUIRED
                    }, null, 8, ["modelValue", "code-error", "phone-verification-required"])) : (t(),
                    i(S, {
                        key: 1,
                        ref: "contactsUser",
                        modelValue: m.userContacts,
                        "onUpdate:modelValue": r[1] || (r[1] = e=>m.userContacts = e),
                        "user-type": o.CART_CONTACTS_USER_TYPE,
                        owner: o.CART_CONTACTS_USER_OWNER,
                        receiver: o.CART_CONTACTS_USER_RECEIVER
                    }, null, 8, ["modelValue", "user-type", "owner", "receiver"]))])),
                _: 1
            }, 8, ["step", "name", "disabled"])) : a("", !0), l.steps.payment ? (t(),
            i(C, {
                key: 2,
                ref: l.steps.payment.name,
                "data-selenium": "payment",
                "data-test-id": "payment-step",
                name: l.steps.payment.name,
                error: !u.isValidStep(l.steps.payment),
                disabled: !o.CART_SELECTED_SHIPMENT,
                onPaymentChanged: u.sendCheckoutSetPaymentInfoEvent
            }, null, 8, ["name", "error", "disabled", "onPaymentChanged"])) : a("", !0)])])
}
]])
    , yo = "TIME_LIMIT"
    , To = {
    name: "SmCartDiscountsPromo",
    components: {
        SmButton: F,
        SmFormField: le,
        SmFormVee: ce,
        SmAccordion: ns,
        SmMessage: J,
        SmTimer: Vt
    },
    consts: {
        crossIcon: Ze,
        spinnerIcon: ke
    },
    data: ()=>({
        inputModel: "",
        pending: !1,
        promocodeInputMessage: "",
        timeLimitTimer: 0,
        timeLimitErrorText: "Слишком много попыток ввода. Подождите и попробуйте еще раз"
    }),
    watch: {
        CART_PROMOCODE_CODE: {
            immediate: !0,
            handler(e) {
                this.inputModel = e
            }
        },
        inputModel() {
            this.promocodeInputMessage = ""
        }
    },
    computed: {
        ...p(["CART_PROMOCODE_CODE", "CART_PROMOCODE_AMOUNT", "CART_ITEMS_LAST_DELETED"]),
        promocodeApplied() {
            return this.CART_PROMOCODE_CODE && this.inputModel === this.CART_PROMOCODE_CODE
        },
        validationSchema() {
            return {
                promocode: {
                    promocodeError: {
                        errorMessage: !!this.promocodeInputMessage
                    }
                }
            }
        },
        isButtonDisabled() {
            return this.pending || !!this.promocodeInputMessage || this.CART_ITEMS_LAST_DELETED || !!this.timeLimitTimer
        }
    },
    methods: {
        ...h(["ADD_PROMOCODE", "DELETE_PROMOCODE"]),
        onAction() {
            this.promocodeApplied || this.CART_PROMOCODE_CODE ? this.deletePromocode() : this.inputModel = ""
        },
        async addPromocode() {
            const {ADD_PROMOCODE: e, inputModel: t} = this;
            try {
                this.pending = !0,
                    await e(t)
            } catch (s) {
                const {status: e, data: {errorMessage: i, reason: a, timer: o}={}} = s || {};
                t ? a === yo ? this.timeLimitTimer = o : this.promocodeInputMessage = i || "Промокод не может быть применен" : this.promocodeInputMessage = "Введите промокод";
                const n = this.timeLimitTimer > 0 ? this.timeLimitErrorText : this.promocodeInputMessage;
                this.$analytics.sendErrorAppear({
                    name: e,
                    text: n
                })
            } finally {
                this.pending = !1
            }
        },
        async deletePromocode() {
            const {DELETE_PROMOCODE: e} = this;
            try {
                this.pending = !0,
                    await e(this.CART_PROMOCODE_CODE)
            } catch {
                this.$notify({
                    text: "Не удалось отменить промокод"
                })
            } finally {
                this.pending = !1
            }
        },
        onTimeLimitTimerEnd() {
            this.timeLimitTimer = 0
        }
    },
    mounted() {
        E("promocodeError", (()=>this.promocodeInputMessage))
    }
}
    , vo = (e=>(P("data-v-dcb0e993"),
    e = e(),
    N(),
    e))((()=>n("p", {
    class: "sm-cart-discounts-promo__title"
}, "Применить промокод", -1)))
    , Eo = {
    class: "sm-cart-discounts-promo__input-wrapper"
}
    , Io = {
    key: 0,
    class: "sm-cart-discounts-promo__success-text"
};
const go = {
    name: "SmCartDiscounts",
    components: {
        SmImage: G,
        SmMessage: J,
        SmToggle: ae,
        SmCartDiscountsPromo: B(To, [["render", function(m, p, h, S, _, C) {
            const y = e("SmFormField")
                , T = e("SmMessage")
                , v = e("SmTimer")
                , E = e("SmButton")
                , I = e("SmFormVee")
                , g = e("SmAccordion");
            return t(),
                i(g, {
                    class: "sm-cart-discounts-promo"
                }, {
                    header: d((()=>[vo])),
                    default: d((()=>[o(I, {
                        class: c(["sm-cart-discounts-promo__form", {
                            "sm-cart-discounts-promo__form--has-timer": !!_.timeLimitTimer
                        }]),
                        "validation-schema": C.validationSchema,
                        onValid: C.addPromocode
                    }, {
                        default: d((({submit: e})=>[n("div", Eo, [o(y, {
                            modelValue: _.inputModel,
                            "onUpdate:modelValue": p[0] || (p[0] = e=>_.inputModel = e),
                            placeholder: "Введите промокод",
                            name: "promocode",
                            action: !!_.inputModel,
                            "action-icon": _.pending ? m.$options.consts.spinnerIcon : m.$options.consts.crossIcon,
                            disabled: !!_.timeLimitTimer || _.pending,
                            onAction: C.onAction
                        }, null, 8, ["modelValue", "action", "action-icon", "disabled", "onAction"]), C.promocodeApplied ? (t(),
                            s("p", Io, " Промокод применен ")) : a("", !0)]), _.timeLimitTimer ? (t(),
                            i(T, {
                                key: 0,
                                class: "sm-cart-discounts-promo__message",
                                type: "warning"
                            }, {
                                default: d((()=>[u(r(_.timeLimitErrorText), 1)])),
                                _: 1
                            })) : a("", !0), C.promocodeApplied ? a("", !0) : (t(),
                            i(E, {
                                key: 1,
                                class: "sm-cart-discounts-promo__button",
                                color: "white-blue",
                                size: "custom",
                                type: "button",
                                disabled: C.isButtonDisabled,
                                onClick: e
                            }, {
                                default: d((()=>[_.timeLimitTimer ? (t(),
                                    s(l, {
                                        key: 0
                                    }, [u(" Попробовать через  "), o(v, {
                                        start: _.timeLimitTimer,
                                        onEnd: C.onTimeLimitTimerEnd
                                    }, null, 8, ["start", "onEnd"])], 64)) : (t(),
                                    s(l, {
                                        key: 1
                                    }, [u("Применить")], 64))])),
                                _: 2
                            }, 1032, ["disabled", "onClick"]))])),
                        _: 1
                    }, 8, ["class", "validation-schema", "onValid"])])),
                    _: 1
                })
        }
        ], ["__scopeId", "data-v-dcb0e993"]]),
        SmTooltip: Je
    },
    consts: {
        cardImg: os,
        logoIcon: "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20146%20108'%3e%3cpath%20fill='%23B5CAFF'%20fill-rule='evenodd'%20d='M55.458%2058%20176%20121%2062.003%2096.023%201%20120.94%2055.458%2058zM0%2022l97.786%2021.126L150%2022.113%20103.294%2075%200%2022zM91.16.064c9.15-.802%2016.986%206.01%2017.801%2015.207.616%208.993-6.132%2017.003-15.26%2017.683-8.992.672-16.991-6.175-17.659-15.185C75.4%208.625%2082.192.749%2091.16.064z'%20opacity='.15'/%3e%3c/svg%3e"
    },
    data: ()=>({
        pending: !1,
        applied: !1
    }),
    computed: {
        ...p(["ANONYMOUS", "CART_IS_BONUSES_APPLY", "USER_BONUSES", "CART_BONUSES_TO_APPLY", "CART_ITEMS_LAST_DELETED"]),
        cartBonusesToApply() {
            return +this.CART_BONUSES_TO_APPLY
        },
        userBonuses() {
            return +this.USER_BONUSES
        },
        cartBonusesToApplyText() {
            return et(this.cartBonusesToApply)
        },
        noBonusesToApply() {
            return !this.CART_ITEMS_LAST_DELETED && 0 === this.userBonuses
        },
        hasBonusesToApply() {
            return !this.CART_ITEMS_LAST_DELETED && this.cartBonusesToApply > 0 && this.userBonuses > 0
        },
        toApplyText() {
            const e = this.cartBonusesToApplyText
                , t = $t("bonus", e)
                , s = Gt("available", e);
            return this.hasBonusesToApply ? ` Для оплаты заказа ${s} ${t}` : ""
        },
        balanceText() {
            const e = et(this.userBonuses);
            return `На вашем счете ${$t("bonus", e)}.${this.toApplyText}`
        }
    },
    watch: {
        CART_IS_BONUSES_APPLY: {
            handler(e) {
                this.CART_ITEMS_LAST_DELETED || (this.applied = e)
            },
            immediate: !0
        }
    },
    methods: {
        ...h(["TOGGLE_BONUSES", "SHOW_GLOBAL_DIALOG"]),
        showAuthDialog() {
            this.ANONYMOUS && this.SHOW_GLOBAL_DIALOG({
                template: "SmAuthDialog",
                mobileTitle: "Вход или регистрация",
                woMobileNav: !0
            })
        },
        async onToggle(e) {
            const t = this.applied;
            this.applied = e;
            try {
                this.pending = !0,
                    await this.TOGGLE_BONUSES(e)
            } catch (s) {
                this.applied = t
            } finally {
                this.pending = !1
            }
        }
    }
}
    , Ao = e=>(P("data-v-f511a448"),
    e = e(),
    N(),
    e)
    , fo = Ao((()=>n("span", {
    class: "sm-cart-discounts__auth-title"
}, " Больше выгоды со Спортмастер! ", -1)))
    , ko = Ao((()=>n("span", {
    class: "sm-cart-discounts__auth-text"
}, " Авторизуйтесь для получения, списания бонусов и использования промокода в этом заказе. ", -1)))
    , bo = Ao((()=>n("span", {
    class: "sm-cart-discounts__auth-button"
}, "Авторизоваться", -1)))
    , Ro = {
    class: "sm-cart-discounts__text"
}
    , Lo = {
    key: 1,
    class: "sm-cart-discounts__bonus"
}
    , Do = Ao((()=>n("div", {
    class: "sm-cart-discounts__tooltip"
}, [n("div", {
    class: "sm-cart-discounts__tooltip-title"
}, " Применение бонусов недоступно "), n("div", {
    class: "sm-cart-discounts__tooltip-text"
}, " Бонусами можно оплатить до 30% стоимости товара или не более 50% от полной стоимости товара с учётом скидки по другим промоакциям и/или Бонусной скидки. Бонусы не действуют для товаров с отметками «Лучшая цена» и «Финальная цена». ")], -1)));
const Oo = B(go, [["render", function(a, m, p, h, S, _) {
    const C = e("SmImage")
        , y = e("SmMessage")
        , T = e("SmToggle")
        , v = e("SmTooltip")
        , E = e("SmCartDiscountsPromo");
    return t(),
        s("div", {
            class: c(["sm-cart-discounts", {
                "sm-cart-discounts--anon": a.ANONYMOUS
            }]),
            onClick: m[0] || (m[0] = (...e)=>_.showAuthDialog && _.showAuthDialog(...e))
        }, [a.ANONYMOUS ? (t(),
            s(l, {
                key: 0
            }, [fo, ko, bo, o(C, {
                class: "sm-cart-discounts__auth-icon",
                src: a.$options.consts.logoIcon
            }, null, 8, ["src"])], 64)) : (t(),
            s(l, {
                key: 1
            }, [n("span", Ro, r(_.balanceText), 1), _.noBonusesToApply ? (t(),
                i(y, {
                    key: 0,
                    class: "sm-cart-discounts__message"
                }, {
                    default: d((()=>[u(" Копите бонусы и используйте их в последующих заказах ")])),
                    _: 1
                })) : _.hasBonusesToApply ? (t(),
                s("div", Lo, [o(C, {
                    class: "sm-cart-discounts__bonus-image",
                    src: a.$options.consts.cardImg
                }, null, 8, ["src"]), n("span", null, [u(" Списать бонусы: "), n("b", null, r(_.cartBonusesToApplyText), 1)]), o(T, {
                    class: "sm-cart-discounts__bonus-toggle",
                    disabled: S.pending,
                    "model-value": S.applied,
                    onChange: _.onToggle
                }, null, 8, ["disabled", "model-value", "onChange"])])) : (t(),
                i(v, {
                    key: 2,
                    color: "black",
                    placement: "bottom-end",
                    distance: "8"
                }, {
                    target: d((()=>[o(y, {
                        class: "sm-cart-discounts__message"
                    }, {
                        default: d((()=>[u(" Для текущего заказа применение бонусов недоступно ")])),
                        _: 1
                    })])),
                    popper: d((()=>[Do])),
                    _: 1
                })), o(E, {
                class: "sm-cart-discounts__promo"
            })], 64))], 2)
}
], ["__scopeId", "data-v-f511a448"]])
    , Po = {
    name: "SmCartSummaryLine",
    props: {
        mediumTitle: Boolean
    },
    computed: {
        family() {
            const {mediumTitle: e} = this;
            return e ? "medium" : "regular"
        }
    }
}
    , No = {
    class: "sm-cart-summary-line"
}
    , wo = {
    class: "sm-cart-summary-line__title"
};
const Mo = B(Po, [["render", function(e, i, a, o, r, l) {
    return t(),
        s("div", No, [n("span", wo, [I(e.$slots, "title")]), I(e.$slots, "value")])
}
]]);
const Vo = B({
    name: "SmCartSummaryBonusesLine",
    components: {
        SmAmount: tt,
        SmCartSummaryLine: Mo
    },
    props: {
        value: {
            type: Number,
            default: 0
        }
    }
}, [["render", function(s, a, n, r, l, c) {
    const m = e("SmAmount")
        , p = e("SmCartSummaryLine");
    return t(),
        i(p, {
            class: "sm-cart-summary-bonuses-line"
        }, {
            title: d((()=>[u("Бонусы")])),
            value: d((()=>[o(m, {
                class: "sm-cart-summary-bonuses-line__bonuses",
                value: -n.value,
                currency: "bonuses",
                size: "16"
            }, null, 8, ["value"])])),
            _: 1
        })
}
]]);
const Bo = B({
    name: "SmCartSummaryDiscountLine",
    components: {
        SmAmount: tt,
        SmCartSummaryLine: Mo
    },
    props: {
        value: {
            type: Number,
            default: 0
        }
    }
}, [["render", function(s, a, n, r, l, c) {
    const m = e("SmAmount")
        , p = e("SmCartSummaryLine");
    return t(),
        i(p, {
            class: "sm-cart-summary-discount-line"
        }, {
            title: d((()=>[u("Скидки и акции")])),
            value: d((()=>[o(m, {
                class: "sm-cart-summary-discount-line__discount",
                value: -n.value,
                size: "16"
            }, null, 8, ["value"])])),
            _: 1
        })
}
]]);
const xo = B({
    name: "SmCartSummaryGiftCardsLine",
    components: {
        SmAmount: tt,
        SmCartSummaryLine: Mo
    },
    props: {
        value: {
            type: Number,
            default: 0
        },
        amount: {
            type: Number,
            default: 0
        }
    },
    computed: {
        title() {
            return st(Gt("giftCard", this.amount))
        }
    }
}, [["render", function(s, a, n, l, c, m) {
    const p = e("SmAmount")
        , h = e("SmCartSummaryLine");
    return t(),
        i(h, {
            class: "sm-cart-summary-gift-cards-line"
        }, {
            title: d((()=>[u(r(m.title), 1)])),
            value: d((()=>[o(p, {
                class: "sm-cart-summary-gift-cards-line__amount",
                value: -n.value,
                size: "16"
            }, null, 8, ["value"])])),
            _: 1
        })
}
]]);
const Go = B({
    name: "SmCartSummaryQuantityLine",
    components: {
        SmAmount: tt,
        SmCartSummaryLine: Mo
    },
    props: {
        count: {
            type: Number,
            default: 0
        },
        value: {
            type: Number,
            default: 0
        }
    }
}, [["render", function(s, a, n, l, c, m) {
    const p = e("SmAmount")
        , h = e("SmCartSummaryLine");
    return t(),
        i(h, null, {
            title: d((()=>[u("Товары, " + r(n.count) + " шт.", 1)])),
            value: d((()=>[o(p, {
                value: n.value,
                size: "16"
            }, null, 8, ["value"])])),
            _: 1
        })
}
]]);
const $o = B({
    name: "SmCartSummaryServicesLine",
    components: {
        SmCost: Kt,
        SmCartSummaryLine: Mo
    },
    props: {
        count: {
            type: Number,
            default: 0
        },
        value: {
            type: Number,
            default: 0
        }
    }
}, [["render", function(s, a, n, l, m, p) {
    const h = e("SmCost")
        , S = e("SmCartSummaryLine");
    return t(),
        i(S, {
            class: "sm-cart-summary-services-line"
        }, {
            title: d((()=>[u("Услуги, " + r(n.count) + " шт.", 1)])),
            value: d((()=>[o(h, {
                class: c(["sm-cart-summary-services-line__cost", {
                    "sm-cart-summary-services-line__cost--free": !n.value
                }]),
                value: n.value,
                size: 16,
                exact: ""
            }, null, 8, ["class", "value"])])),
            _: 1
        })
}
]])
    , Uo = {
    PICKUP: "PICKUP",
    DELIVERY: "DELIVERY"
};
const Yo = B({
    name: "SmCartSummaryShipmentCostLine",
    components: {
        SmCost: Kt,
        SmCartSummaryLine: Mo
    },
    consts: {
        TITLES: {
            [Uo.PICKUP]: "Самовывоз",
            [Uo.DELIVERY]: "Доставка"
        }
    },
    props: {
        type: {
            type: String,
            required: !0,
            validator: e=>[Uo.PICKUP, Uo.DELIVERY].includes(e)
        },
        value: {
            type: Number,
            default: 0
        }
    }
}, [["render", function(s, a, n, l, m, p) {
    const h = e("SmCost")
        , S = e("SmCartSummaryLine");
    return t(),
        i(S, {
            class: "sm-cart-summary-shipment-cost-line"
        }, {
            title: d((()=>[u(r(s.$options.consts.TITLES[n.type]), 1)])),
            value: d((()=>[o(h, {
                class: c(["sm-cart-summary-shipment-cost-line__cost", {
                    "sm-cart-summary-shipment-cost-line__cost--free": !n.value
                }]),
                value: n.value,
                size: 16,
                exact: ""
            }, null, 8, ["class", "value"])])),
            _: 1
        })
}
]])
    , Fo = {
    name: "SmCartSummaryTotalLine",
    components: {
        SmAmount: tt,
        SmCartSummaryLine: Mo
    },
    props: {
        value: {
            type: Number,
            default: 0
        }
    }
}
    , Ho = n("span", {
    class: "sm-cart-summary-total-line__title"
}, "Итого", -1);
const jo = {
    name: "SmCartSummary",
    components: {
        SmText: U,
        SmCartSummaryTotalLine: B(Fo, [["render", function(s, a, n, r, l, c) {
            const m = e("SmAmount")
                , u = e("SmCartSummaryLine");
            return t(),
                i(u, {
                    class: "sm-cart-summary-total-line",
                    "medium-title": ""
                }, {
                    title: d((()=>[Ho])),
                    value: d((()=>[o(m, {
                        value: n.value,
                        size: "20"
                    }, null, 8, ["value"])])),
                    _: 1
                })
        }
        ]]),
        SmCartSummaryBonusesLine: Vo,
        SmCartSummaryDiscountLine: Bo,
        SmCartSummaryQuantityLine: Go,
        SmCartSummaryShipmentCostLine: Yo,
        SmCartSummaryGiftCardsLine: xo,
        SmCartSummaryServicesLine: $o
    },
    props: {
        shipmentType: {
            type: String,
            default: ""
        },
        total: {
            type: Object,
            default: ()=>({})
        },
        cartGiftCardsAmount: {
            type: Number
        }
    },
    computed: {
        ...p(["CART_ITEMS"]),
        ...p(q, ["IS_ACTIVE"]),
        isCheckboxesEnabled() {
            return this.IS_ACTIVE("FT9114")
        },
        cartItemsInStock() {
            return this.CART_ITEMS.filter((e=>{
                    var t;
                    return (null == (t = null == e ? void 0 : e.available) ? void 0 : t.state) === it
                }
            ))
        },
        showBlockSummary() {
            return !this.isCheckboxesEnabled || this.cartItemsInStock.some((e=>e.selected && !e.deleted))
        }
    }
}
    , qo = {
    class: "sm-cart-summary",
    "data-selenium": "summary-div"
}
    , Wo = (e=>(P("data-v-bd709c3c"),
    e = e(),
    N(),
    e))((()=>n("span", {
    class: "sm-cart-summary__title"
}, "Ваш заказ", -1)));
const zo = B(jo, [["render", function(n, r, c, m, p, h) {
    const S = e("SmCartSummaryQuantityLine")
        , _ = e("SmCartSummaryServicesLine")
        , C = e("SmCartSummaryShipmentCostLine")
        , y = e("SmCartSummaryDiscountLine")
        , T = e("SmCartSummaryBonusesLine")
        , v = e("SmCartSummaryGiftCardsLine")
        , E = e("SmCartSummaryTotalLine")
        , I = e("SmText");
    return t(),
        s("div", qo, [Wo, h.showBlockSummary ? (t(),
            s(l, {
                key: 0
            }, [o(S, {
                count: c.total.productsQuantity,
                value: c.total.productsCost,
                "data-selenium": "goods",
                class: "sm-cart-summary__item"
            }, null, 8, ["count", "value"]), c.total.servicesQuantity && c.total.servicesCost >= 0 ? (t(),
                i(_, {
                    key: 0,
                    count: c.total.servicesQuantity,
                    value: c.total.servicesCost,
                    "data-selenium": "services",
                    class: "sm-cart-summary__item"
                }, null, 8, ["count", "value"])) : a("", !0), c.shipmentType ? (t(),
                i(C, {
                    key: 1,
                    type: c.shipmentType,
                    value: c.total.deliveryCost,
                    "data-selenium": "shipment",
                    class: "sm-cart-summary__item"
                }, null, 8, ["type", "value"])) : a("", !0), c.total.discountAmount ? (t(),
                i(y, {
                    key: 2,
                    value: c.total.discountAmount,
                    "data-selenium": "discount",
                    class: "sm-cart-summary__item"
                }, null, 8, ["value"])) : a("", !0), c.total.bonusAmount ? (t(),
                i(T, {
                    key: 3,
                    value: c.total.bonusAmount,
                    "data-selenium": "bonuses",
                    class: "sm-cart-summary__item"
                }, null, 8, ["value"])) : a("", !0), c.total.giftCardsAmount ? (t(),
                i(v, {
                    key: 4,
                    value: c.total.giftCardsAmount,
                    amount: c.cartGiftCardsAmount,
                    class: "sm-cart-summary__item"
                }, null, 8, ["value", "amount"])) : a("", !0), o(E, {
                "data-selenium": "total",
                value: c.total.totalCost,
                class: "sm-cart-summary__item sm-cart-summary__item--total"
            }, null, 8, ["value"])], 64)) : (t(),
            i(I, {
                key: 1,
                class: "sm-cart-summary__empty",
                variant: "text-12"
            }, {
                default: d((()=>[u(" Выберите товары, чтобы перейти к оформлению заказа ")])),
                _: 1
            }))])
}
], ["__scopeId", "data-v-bd709c3c"]])
    , Qo = {
    name: "SmCartTitle",
    components: {
        SmSvgIcon: $,
        SmButton: F
    },
    consts: {
        icShare: rs
    },
    props: {
        productsQuantity: {
            type: Number,
            default: 0
        },
        isCheckout: {
            type: Boolean,
            default: !1
        }
    },
    computed: {
        title() {
            return this.isCheckout ? "Оформление заказа" : "Корзина"
        },
        productQuantityText() {
            return $t("product", this.productsQuantity)
        }
    },
    methods: {
        ...h(["SHOW_GLOBAL_DIALOG"]),
        onClickShareButton() {
            this.SHOW_GLOBAL_DIALOG({
                template: "SmShareCartDialog"
            })
        }
    }
}
    , Ko = {
    class: "sm-cart-title"
}
    , Xo = {
    class: "sm-cart-title__text"
}
    , Zo = {
    class: "sm-cart-title__products-quantity"
};
const Jo = B(Qo, [["render", function(i, c, m, u, p, h) {
    const S = e("SmSvgIcon")
        , _ = e("SmButton");
    return t(),
        s("div", Ko, [n("h1", Xo, r(h.title), 1), m.productsQuantity && !m.isCheckout ? (t(),
            s(l, {
                key: 0
            }, [n("span", Zo, r(h.productQuantityText), 1), o(_, {
                class: "sm-cart-title__share-button",
                color: "transparent-black",
                size: "xxs",
                "data-test-id": "share-button",
                title: "Поделиться товарами",
                onClick: h.onClickShareButton
            }, {
                default: d((()=>[o(S, {
                    icon: i.$options.consts.icShare,
                    height: "24",
                    width: "24"
                }, null, 8, ["icon"])])),
                _: 1
            }, 8, ["onClick"])], 64)) : a("", !0)])
}
]])
    , en = {
    name: "SmCheckoutPrivacyDescription",
    components: {
        SmLink: Z
    },
    props: {
        selectedType: {
            type: Object,
            required: !0
        }
    },
    computed: {
        ...p(["BASE_URL"]),
        privacyUrl() {
            return at(this.BASE_URL)
        },
        privacyPolicyUrl() {
            return ot(this.BASE_URL)
        },
        clubPageUrl() {
            return nt(this.BASE_URL)
        },
        privacyText() {
            const {text: e} = this.selectedType;
            return `Нажимая кнопку «${e}» вы соглашаетесь с`
        }
    }
}
    , tn = {
    class: "sm-checkout-privacy-description"
}
    , sn = n("span", null, ",", -1)
    , an = n("span", null, ",", -1);
const on = B(en, [["render", function(i, a, n, l, c, m) {
    const p = e("SmLink");
    return t(),
        s("div", tn, [u(r(m.privacyText) + " ", 1), o(p, {
            href: m.privacyUrl,
            target: "_blank"
        }, {
            default: d((()=>[u(" пользовательским соглашением"), sn])),
            _: 1
        }, 8, ["href"]), o(p, {
            href: m.privacyPolicyUrl,
            target: "_blank"
        }, {
            default: d((()=>[u(" политикой конфиденциальности"), an])),
            _: 1
        }, 8, ["href"]), u(" условиями "), o(p, {
            href: m.clubPageUrl,
            target: "_blank"
        }, {
            default: d((()=>[u("Клубной программы")])),
            _: 1
        }, 8, ["href"])])
}
]]);
const nn = B({
    name: "SmCheckoutSubmitButton",
    components: {
        SmSvgIcon: $
    },
    props: {
        selectedType: {
            type: Object,
            required: !0
        }
    },
    emits: ["click"],
    methods: {
        onClick() {
            this.$emit("click")
        }
    }
}, [["render", function(o, l, m, d, u, p) {
    const h = e("SmSvgIcon");
    return t(),
        s("button", {
            type: "button",
            class: c(["sm-checkout-submit-button", `sm-checkout-submit-button--${m.selectedType.color}`, {
                "sm-checkout-submit-button--reversed": m.selectedType.reversed
            }]),
            onClick: l[0] || (l[0] = (...e)=>p.onClick && p.onClick(...e))
        }, [n("span", null, r(m.selectedType.text), 1), m.selectedType.icon ? (t(),
            i(h, {
                key: 0,
                icon: m.selectedType.icon.src,
                width: m.selectedType.icon.width,
                height: m.selectedType.icon.height,
                class: "sm-checkout-submit-button__icon"
            }, null, 8, ["icon", "width", "height"])) : a("", !0)], 2)
}
]]);
m('<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 105 20" id="ic-payment-bnpl"><defs><linearGradient id="ic-payment-bnpl_a" x1="-6.029%" x2="105.289%" y1="15.799%" y2="85.358%"><stop offset="0%" stop-color="#5F49FD" /><stop offset="15%" stop-color="#A91DFD" /><stop offset="15.65%" stop-color="#AB24FD" /><stop offset="22.31%" stop-color="#BB6AFD" /><stop offset="28.31%" stop-color="#C8A1FD" /><stop offset="33.44%" stop-color="#D1C9FD" /><stop offset="37.51%" stop-color="#D7E1FD" /><stop offset="40%" stop-color="#D9EAFD" /><stop offset="42.06%" stop-color="#DDE9F6" /><stop offset="45.15%" stop-color="#E7E7E1" /><stop offset="48.86%" stop-color="#F7E4C0" /><stop offset="50%" stop-color="#FDE3B4" /><stop offset="53.32%" stop-color="#FDDFB1" /><stop offset="56.77%" stop-color="#FCD2A9" /><stop offset="60.26%" stop-color="#FBBE9B" /><stop offset="63.78%" stop-color="#F9A188" /><stop offset="65%" stop-color="#F89580" /><stop offset="100%" stop-color="#F24C4E" /></linearGradient></defs><g fill="currentColor" fill-rule="evenodd"><path fill="url(#ic-payment-bnpl_a)" fill-rule="nonzero" d="m18.11 5.32-7.486 3.76V1.52C10.624.68 9.956 0 9.146 0H1.477C.667 0 0 .68 0 1.52v11.8c0 1.12 1.133 1.86 2.125 1.36l7.487-3.76v7.56c0 .84.668 1.52 1.477 1.52h7.67c.808 0 1.476-.68 1.476-1.52V6.68c0-1.12-1.133-1.84-2.124-1.36z" /><path fill="#FFF" fill-rule="nonzero" d="M34.968 15.348h-1.923a.407.407 0 0 1-.407-.41v-3.035a5.7 5.7 0 0 1-1.74.265 5.5 5.5 0 0 1-1.876-.315 4.4 4.4 0 0 1-1.503-.918 4.2 4.2 0 0 1-.994-1.496 5.3 5.3 0 0 1-.365-2.028V5.666a.41.41 0 0 1 .407-.41h1.903a.407.407 0 0 1 .408.41v1.568q0 1.222.609 1.813a2.27 2.27 0 0 0 1.645.592q.369-.003.73-.073c.249-.047.522-.105.793-.172V5.653a.41.41 0 0 1 .408-.409h1.923a.407.407 0 0 1 .407.409v9.268a.41.41 0 0 1-.425.427M54.897 5.037a4.78 4.78 0 0 1 4.16 2.157.413.413 0 0 1-.087.556l-1.292.998a.404.404 0 0 1-.565-.065 4 4 0 0 0-.775-.748 2.38 2.38 0 0 0-1.421-.41 2.6 2.6 0 0 0-1.066.215 2.6 2.6 0 0 0-.823.581 2.7 2.7 0 0 0-.536.866 3 3 0 0 0-.194 1.09c-.004.375.062.748.194 1.1.12.324.302.621.536.875a2.55 2.55 0 0 0 1.889.796 2.38 2.38 0 0 0 1.421-.407 4 4 0 0 0 .758-.718.407.407 0 0 1 .564-.07l1.29.998a.41.41 0 0 1 .094.548 4.8 4.8 0 0 1-1.538 1.497 4.86 4.86 0 0 1-2.609.683 5.5 5.5 0 0 1-2.122-.409 5.3 5.3 0 0 1-1.715-1.12 5.36 5.36 0 0 1-1.148-5.829 5.1 5.1 0 0 1 1.148-1.66 5.5 5.5 0 0 1 3.837-1.52zm13.875 2.526h-2.778v7.375a.413.413 0 0 1-.407.409H63.68a.407.407 0 0 1-.408-.41V7.564h-2.758a.404.404 0 0 1-.407-.41V5.658a.41.41 0 0 1 .407-.409h8.257a.407.407 0 0 1 .408.41v1.496a.41.41 0 0 1-.251.378.4.4 0 0 1-.157.03zm10.23 7.784h-1.906a.407.407 0 0 1-.407-.41v-2.156H74.72l-2.175 2.566h-2.191a.41.41 0 0 1-.369-.232.41.41 0 0 1 .05-.434l2.066-2.574a3.4 3.4 0 0 1-1.188-1.247 3.7 3.7 0 0 1-.438-1.826 3.8 3.8 0 0 1 .326-1.598c.205-.454.506-.857.882-1.182a4 4 0 0 1 1.33-.734 5.4 5.4 0 0 1 1.684-.25h4.304a.407.407 0 0 1 .405.41v9.268a.41.41 0 0 1-.405.399zm-4.107-7.762a1.9 1.9 0 0 0-1.178.355 1.25 1.25 0 0 0-.467 1.05 1.33 1.33 0 0 0 .467 1.08c.332.27.75.41 1.178.396h1.766v-2.88h-1.766zm17.013-2.187L87.5 10.314l-4.386-4.916a.41.41 0 0 0-.305-.137h-.522a.407.407 0 0 0-.408.41v9.267a.41.41 0 0 0 .408.41h1.923a.407.407 0 0 0 .408-.41v-4.42l2.296 2.592a.4.4 0 0 0 .303.137h.547a.4.4 0 0 0 .305-.137l2.314-2.611v4.44a.41.41 0 0 0 .407.408h1.906a.41.41 0 0 0 .408-.409V5.67a.41.41 0 0 0-.408-.409h-.485a.4.4 0 0 0-.303.137m11.862-.022-5.467 5.265V5.67a.41.41 0 0 0-.407-.41H95.97a.407.407 0 0 0-.407.41v9.267a.41.41 0 0 0 .407.41h.594a.4.4 0 0 0 .283-.116l5.435-5.237v4.95a.41.41 0 0 0 .407.41h1.904a.407.407 0 0 0 .407-.41V5.67a.41.41 0 0 0-.407-.409h-.555a.4.4 0 0 0-.268.115" /><path fill="#FFF" d="M42.74 5a5.24 5.24 0 0 0-4.443 2.431 5.29 5.29 0 0 0 1.315 7.098 5.247 5.247 0 0 0 7.142-.86 3.93 3.93 0 0 1-1.43 1.536v.272h2.255a.406.406 0 0 0 .407-.41V10.25a5.29 5.29 0 0 0-1.544-3.71A5.25 5.25 0 0 0 42.741 5zm0 7.833a2.54 2.54 0 0 1-2.355-1.573 2.56 2.56 0 0 1 .545-2.787 2.54 2.54 0 0 1 2.774-.56 2.55 2.55 0 0 1 1.579 2.356 2.57 2.57 0 0 1-.742 1.81 2.54 2.54 0 0 1-1.8.754z" /></g></symbol>', "ic-payment-bnpl");
const rn = {
    name: "Cart",
    components: {
        SmCheckoutPrivacyDescription: on,
        SmButton: F,
        SmCartTitle: Jo,
        SmCartSummary: zo,
        SmMessage: J,
        CartEmpty: Us,
        SmLayoutLoader: ht,
        ClientOnly: ye,
        SmCartDiscounts: Oo,
        SmCartItemsList: Os,
        SmCartCheckout: Co,
        SmSvgIcon: $,
        SmLink: Z,
        SmLegalEntity: Bs,
        SmCheckoutSubmitButton: nn,
        SmPrivacy: rt
    },
    consts: {
        arrowLeftIcon: ls,
        subscription: {
            EMAIL: Ue
        },
        bnplIcon: "ic-payment-bnpl",
        sberIcon: cs,
        sberpayIcon: wt,
        sbpIcon: ms,
        directCreditIcon: Mt
    },
    data() {
        return {
            initLoading: !0,
            checkoutVisited: !1,
            subscriptionConsent: {
                emailSubscription: !0
            },
            buttonsMap: {
                ONLINE: {
                    color: "blue",
                    text: "Оплатить заказ"
                },
                CARD_ONLINE: {
                    color: "blue",
                    text: "Оплатить заказ"
                },
                FASTER_PAYMENT_SYSTEM: {
                    color: "purple",
                    icon: {
                        src: this.$options.consts.sbpIcon,
                        width: this.$root.isMediaLGPlus ? 64 : 56,
                        height: this.$root.isMediaLGPlus ? 34 : 30
                    },
                    text: "Оплатить"
                },
                SBER_PAY: {
                    color: "green",
                    icon: {
                        src: this.$options.consts.sberpayIcon,
                        width: this.$root.isMediaLGPlus ? 60 : 54,
                        height: this.$root.isMediaLGPlus ? 22 : 20
                    },
                    text: "Оплатить"
                },
                BNPL_SOVCOMBANK: {
                    color: "violet",
                    icon: {
                        src: this.$options.consts.bnplIcon,
                        width: this.$root.isMediaLGPlus ? 105 : 95,
                        height: this.$root.isMediaLGPlus ? 20 : 18
                    },
                    text: "Оплатить"
                },
                IN_STORE: {
                    color: "blue",
                    text: "Оформить заказ"
                },
                CREDIT: {
                    color: "green-2",
                    icon: {
                        src: this.$options.consts.sberIcon,
                        width: this.$root.isMediaLGPlus ? 24 : 22,
                        height: this.$root.isMediaLGPlus ? 24 : 22
                    },
                    reversed: !0,
                    text: "Оплатить в кредит"
                },
                CREDIT_DIRECT_CREDIT: {
                    color: "blue-2",
                    icon: {
                        src: this.$options.consts.directCreditIcon,
                        width: 24,
                        height: 24
                    },
                    reversed: !0,
                    text: "Оплатить в кредит"
                },
                INSTALLMENT_DIRECT_CREDIT: {
                    color: "blue-2",
                    icon: {
                        src: this.$options.consts.directCreditIcon,
                        width: 24,
                        height: 24
                    },
                    reversed: !0,
                    text: "Оплатить в рассрочку"
                },
                CASHLESS: {
                    color: "blue",
                    text: "Оплатить заказ"
                }
            }
        }
    },
    computed: {
        ...p(["BASE_URL", "CART_ITEMS", "CART_TOTAL", "CART_ITEMS_QUANTITY", "CART_SELECTED_SHIPMENT", "PRODUCTS", "CART_ITEMS_LAST_DELETED", "CART_PENDING", "CART_TOTAL_PENDING", "CART_IS_LEGAL_ENTITY", "USER_BONUSES", "CART_BONUSES_TO_APPLY", "CART_IS_BONUSES_APPLY", "CART_GIFTCARDS", "CART_SELECTED_PAYMENT", "CART_SELECTED_PAYMENT_TOOL", "ANONYMOUS", "CURRENT_URL", "IS_OPERATOR", "SHIPMENT_VARIANT_AVAILABLE_ITEMS"]),
        ...p(q, ["IS_ACTIVE"]),
        itemsInStockExist() {
            const {CART_ITEMS: e} = this
                , {itemsInStock: t} = se(e);
            return t.length > 0
        },
        isCheckout() {
            const {CART_ITEMS: e, itemsInStockExist: t} = this;
            return !!(null == e ? void 0 : e.length) && t && "checkout" === this.$route.query.step
        },
        cartItemsInStock() {
            return this.CART_ITEMS.filter((e=>{
                    var t;
                    return (null == (t = null == e ? void 0 : e.available) ? void 0 : t.state) === it
                }
            ))
        },
        selectedNotBlockedItemsInStock() {
            return this.cartItemsInStock.filter((e=>e.selected && !e.blocked))
        },
        hasDisclaimer() {
            const e = Number(this.USER_BONUSES) > 0
                , t = 0 === this.CART_BONUSES_TO_APPLY
                , s = this.selectedNotBlockedItemsInStock.some((e=>{
                    var t;
                    const s = (null == (t = null == e ? void 0 : e.price) ? void 0 : t.discounts) || [];
                    return !s.length || s.some((({discountType: e})=>e.toUpperCase() !== lt))
                }
            ));
            return !(!e || !(t && this.selectedNotBlockedItemsInStock.length || this.CART_IS_BONUSES_APPLY && s))
        },
        steps() {
            const {CART_SELECTED_SHIPMENT: e, CART_SELECTED_PAYMENT: t, ANONYMOUS: s, validateContacts: i} = this
                , {shipment: a, payment: o, contacts: n, subscription: r} = pt
                , l = {
                shipment: {
                    ...a,
                    isValid: !!e
                },
                payment: {
                    ...o,
                    isValid: !!t
                },
                contacts: {
                    ...n,
                    isValid: i
                }
            };
            return s && (l.subscription = {
                ...r,
                isValid: !0
            }),
                l
        },
        isPrivacyVisible() {
            return this.isCheckout && this.steps.subscription
        },
        selectedType() {
            return this.buttonsMap.IN_STORE
        },
        isGoToCheckoutDisabled() {
            return this.CART_PENDING || this.CART_ITEMS_LAST_DELETED || this.IS_ACTIVE("FT9114") && !this.cartItemsInStock.some((e=>e.selected && !e.deleted))
        },
        isCheckoutSubmitButtonDisabled() {
            return this.CART_PENDING || 0 === this.SHIPMENT_VARIANT_AVAILABLE_ITEMS.length
        },
        isDiscountsBlockShown() {
            return this.CART_PENDING || this.IS_ACTIVE("FT9114") && !this.cartItemsInStock.some((e=>e.selected && !e.deleted))
        }
    },
    watch: {
        CART_ITEMS: {
            handler() {
                !this.checkoutVisited && this.isCheckout && (this.checkoutVisited = !0)
            }
        }
    },
    async mounted() {
        try {
            await this.init()
        } finally {
            this.initLoading = !1
        }
    },
    methods: {
        ...h(["FETCH_CART_COMPLEX", "SHOW_GLOBAL_DIALOG"]),
        async init() {
            const {FETCH_CART_COMPLEX: e} = this;
            try {
                await this.checkCartSnapshotExists(),
                    await e()
            } catch (t) {
                console.error(t)
            }
        },
        goToCheckout() {
            const {BASE_URL: e, ANONYMOUS: t, IS_OPERATOR: s, CART_IS_LEGAL_ENTITY: i} = this
                , a = ct.getItem(mt);
            !t || a || s || i ? (this.$router.replace({
                query: {
                    step: "checkout"
                }
            }),
                Xe(Ge(e)),
            this.checkoutVisited || (this.$analytics.sendPageViewEvent("Checkout"),
                this.checkoutVisited = !0)) : (ct.setItem(mt, !0),
                this.SHOW_GLOBAL_DIALOG({
                    template: "SmAuthDialog",
                    data: {
                        authFirstStepHasSkipAuthBtn: !0,
                        skipAuth: this.goToCheckout
                    },
                    mobileTitle: "Вход или регистрация",
                    woMobileNav: !0
                }))
        },
        goToCart() {
            this.$router.replace({
                query: {}
            }),
                Xe($e(this.BASE_URL))
        },
        onSubmit() {
            this.$refs.SmCartCheckout.submit()
        },
        async validateContacts() {
            var e, t;
            const {ANONYMOUS: s, $refs: i} = this
                , a = s ? "contactsAnonymous" : "contactsUser"
                , o = null == (t = null == (e = i.SmCartCheckout) ? void 0 : e.$refs) ? void 0 : t[a];
            return await (null == o ? void 0 : o.validate()),
                !!(null == o ? void 0 : o.isValid)
        },
        async checkCartSnapshotExists() {
            const e = this.$route.query[ds]
                , t = dt(this.CURRENT_URL, [ds]);
            if (e) {
                let i = !1;
                try {
                    ({isSnapshotExists: i} = await this.$api.web.checkCartSnapshotExists(e))
                } catch (s) {
                    console.error(s)
                }
                i ? this.SHOW_GLOBAL_DIALOG({
                    template: "SmCartSnapshotDialog",
                    woMobileNav: !0,
                    data: {
                        cartSnapshotId: e
                    },
                    onClose: ()=>{
                        ut(t)
                    }
                }) : (this.$notify({
                    type: "error",
                    text: "К сожалению, подборки товаров не существует."
                }),
                    ut(t))
            }
        }
    }
}
    , ln = n("span", null, "Вернуться в корзину", -1)
    , cn = {
    key: 1,
    ref: "container",
    class: "sm-cart-new__content"
}
    , mn = {
    class: "sm-cart-new__content-details"
}
    , dn = {
    class: "sm-cart-new__total"
}
    , un = {
    key: 0,
    class: "sm-cart-new__total-summary"
}
    , pn = {
    class: "sm-cart-new__btn-wrapper"
};
const hn = B(rn, [["render", function(r, m, p, h, S, _) {
    const C = e("SmCartTitle")
        , y = e("SmSvgIcon")
        , T = e("SmLink")
        , v = e("SmMessage")
        , E = e("SmCartCheckout")
        , I = e("SmCartItemsList")
        , g = e("SmCartDiscounts")
        , A = e("SmCartSummary")
        , f = e("SmPrivacy")
        , k = e("SmCheckoutPrivacyDescription")
        , b = e("SmButton")
        , R = e("SmCheckoutSubmitButton")
        , L = e("SmLegalEntity")
        , D = e("SmLayoutLoader")
        , O = e("CartEmpty")
        , P = e("ClientOnly");
    return t(),
        s("div", {
            class: c(["sm-cart-new", {
                "sm-cart-new--checkout": _.isCheckout
            }])
        }, [o(C, {
            "data-selenium": "cartTitle",
            class: "sm-cart-new__title",
            "products-quantity": r.CART_ITEMS_QUANTITY,
            "is-checkout": _.isCheckout
        }, null, 8, ["products-quantity", "is-checkout"]), _.isCheckout ? (t(),
            i(T, {
                key: 0,
                class: "sm-cart-new__back-btn",
                tag: "button",
                onClick: _.goToCart
            }, {
                default: d((()=>[o(y, {
                    icon: r.$options.consts.arrowLeftIcon
                }, null, 8, ["icon"]), ln])),
                _: 1
            }, 8, ["onClick"])) : a("", !0), r.CART_ITEMS ? (t(),
            s("div", cn, [r.CART_ITEMS.length ? (t(),
                s(l, {
                    key: 0
                }, [n("div", mn, [_.hasDisclaimer && !r.CART_ITEMS_LAST_DELETED ? (t(),
                    i(v, {
                        key: 0,
                        class: "sm-cart-new__disclaimer",
                        type: "info",
                        variant: "text-14"
                    }, {
                        default: d((()=>[u(" Обратите внимание! В вашей корзине есть товары с максимально возможной скидкой. Скидки и бонусы на эти товары не применяются. ")])),
                        _: 1
                    })) : a("", !0), _.isCheckout ? (t(),
                    i(E, {
                        key: 1,
                        ref: "SmCartCheckout",
                        "init-loading": S.initLoading,
                        steps: _.steps,
                        "subscription-consent": S.subscriptionConsent
                    }, null, 8, ["init-loading", "steps", "subscription-consent"])) : a("", !0), M(o(I, {
                    items: r.CART_ITEMS
                }, null, 8, ["items"]), [[V, !_.isCheckout]])]), n("div", dn, [_.itemsInStockExist ? (t(),
                    s("div", un, [n("div", {
                        class: c(["sm-cart-new__total-info", {
                            "sm-cart-new__total-info--with-privacy": _.isPrivacyVisible
                        }])
                    }, [r.CART_IS_LEGAL_ENTITY ? (t(),
                        i(v, {
                            key: 0
                        }, {
                            default: d((()=>[u(" Списание бонусов, применение промокода и оплата подарочными картами недоступны при безналичном расчете ")])),
                            _: 1
                        })) : a("", !0), r.CART_IS_LEGAL_ENTITY || !r.ANONYMOUS && _.isDiscountsBlockShown ? a("", !0) : (t(),
                        i(g, {
                            key: 1
                        })), o(A, {
                        ref: "summary",
                        "data-selenium": "summary",
                        "shipment-type": r.CART_SELECTED_SHIPMENT,
                        total: r.CART_TOTAL,
                        "cart-gift-cards-amount": r.CART_GIFTCARDS.length
                    }, null, 8, ["shipment-type", "total", "cart-gift-cards-amount"])], 2), _.isPrivacyVisible ? (t(),
                        s(l, {
                            key: 0
                        }, [o(f, {
                            ref: _.steps.subscription.name,
                            modelValue: S.subscriptionConsent.emailSubscription,
                            "onUpdate:modelValue": m[0] || (m[0] = e=>S.subscriptionConsent.emailSubscription = e),
                            class: "sm-cart-new__subscription",
                            "subscription-type": r.$options.consts.subscription.EMAIL
                        }, null, 8, ["modelValue", "subscription-type"]), o(k, {
                            class: "sm-cart-new__privacy-description",
                            "selected-type": _.selectedType
                        }, null, 8, ["selected-type"])], 64)) : a("", !0), n("div", pn, [_.isCheckout ? a("", !0) : (t(),
                        i(b, {
                            key: 0,
                            "data-selenium": "checkoutButton",
                            "data-test-id": "checkout-button",
                            class: "sm-cart-new__btn",
                            size: "s",
                            disabled: _.isGoToCheckoutDisabled,
                            onClick: _.goToCheckout
                        }, {
                            default: d((()=>[u(" Перейти к оформлению ")])),
                            _: 1
                        }, 8, ["disabled", "onClick"])), _.isCheckout ? (t(),
                        i(R, {
                            key: 1,
                            "selected-type": _.selectedType,
                            disabled: _.isCheckoutSubmitButtonDisabled,
                            onClick: _.onSubmit
                        }, null, 8, ["selected-type", "disabled", "onClick"])) : a("", !0)]), _.isCheckout ? a("", !0) : (t(),
                        i(L, {
                            key: 1,
                            disabled: r.CART_ITEMS_LAST_DELETED,
                            class: "sm-cart-new__legal-entity"
                        }, null, 8, ["disabled"])), r.CART_TOTAL_PENDING ? (t(),
                        i(D, {
                            key: 2,
                            "data-test-id": "summary-loader"
                        })) : a("", !0)])) : a("", !0)])], 64)) : (t(),
                i(O, {
                    key: 1
                }))], 512)) : a("", !0), o(P, null, {
            default: d((()=>[M(o(D, {
                "is-fixed": "",
                "spinner-class": "sm-cart-new__layout-loader-spinner",
                "data-test-id": "layout-loader"
            }, null, 512), [[V, r.CART_PENDING]])])),
            _: 1
        })], 2)
}
]]);
export {hn as default};
